{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/consts.js"],"sourcesContent":["module.exports.KEYOBJECT = Symbol('KEYOBJECT')\nmodule.exports.PRIVATE_MEMBERS = Symbol('PRIVATE_MEMBERS')\nmodule.exports.PUBLIC_MEMBERS = Symbol('PUBLIC_MEMBERS')\nmodule.exports.THUMBPRINT_MATERIAL = Symbol('THUMBPRINT_MATERIAL')\nmodule.exports.JWK_MEMBERS = Symbol('JWK_MEMBERS')\nmodule.exports.KEY_MANAGEMENT_ENCRYPT = Symbol('KEY_MANAGEMENT_ENCRYPT')\nmodule.exports.KEY_MANAGEMENT_DECRYPT = Symbol('KEY_MANAGEMENT_DECRYPT')\n\nconst USES_MAPPING = {\n  sig: new Set(['sign', 'verify']),\n  enc: new Set(['encrypt', 'decrypt', 'wrapKey', 'unwrapKey', 'deriveKey'])\n}\nconst OPS = new Set([...USES_MAPPING.sig, ...USES_MAPPING.enc])\nconst USES = new Set(Object.keys(USES_MAPPING))\n\nmodule.exports.USES_MAPPING = USES_MAPPING\nmodule.exports.OPS = OPS\nmodule.exports.USES = USES\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,CAAC,SAAS,GAAG,OAAO;AAClC,OAAO,OAAO,CAAC,eAAe,GAAG,OAAO;AACxC,OAAO,OAAO,CAAC,cAAc,GAAG,OAAO;AACvC,OAAO,OAAO,CAAC,mBAAmB,GAAG,OAAO;AAC5C,OAAO,OAAO,CAAC,WAAW,GAAG,OAAO;AACpC,OAAO,OAAO,CAAC,sBAAsB,GAAG,OAAO;AAC/C,OAAO,OAAO,CAAC,sBAAsB,GAAG,OAAO;AAE/C,MAAM,eAAe;IACnB,KAAK,IAAI,IAAI;QAAC;QAAQ;KAAS;IAC/B,KAAK,IAAI,IAAI;QAAC;QAAW;QAAW;QAAW;QAAa;KAAY;AAC1E;AACA,MAAM,MAAM,IAAI,IAAI;OAAI,aAAa,GAAG;OAAK,aAAa,GAAG;CAAC;AAC9D,MAAM,OAAO,IAAI,IAAI,OAAO,IAAI,CAAC;AAEjC,OAAO,OAAO,CAAC,YAAY,GAAG;AAC9B,OAAO,OAAO,CAAC,GAAG,GAAG;AACrB,OAAO,OAAO,CAAC,IAAI,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 39, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/ec_curves.js"],"sourcesContent":["const { getCurves } = require('crypto')\n\nconst curves = new Set()\n\nif (getCurves().includes('prime256v1')) {\n  curves.add('P-256')\n}\n\nif (getCurves().includes('secp256k1')) {\n  curves.add('secp256k1')\n}\n\nif (getCurves().includes('secp384r1')) {\n  curves.add('P-384')\n}\n\nif (getCurves().includes('secp521r1')) {\n  curves.add('P-521')\n}\n\nmodule.exports = curves\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,SAAS,EAAE;AAEnB,MAAM,SAAS,IAAI;AAEnB,IAAI,YAAY,QAAQ,CAAC,eAAe;IACtC,OAAO,GAAG,CAAC;AACb;AAEA,IAAI,YAAY,QAAQ,CAAC,cAAc;IACrC,OAAO,GAAG,CAAC;AACb;AAEA,IAAI,YAAY,QAAQ,CAAC,cAAc;IACrC,OAAO,GAAG,CAAC;AACb;AAEA,IAAI,YAAY,QAAQ,CAAC,cAAc;IACrC,OAAO,GAAG,CAAC;AACb;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 59, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/iv_lengths.js"],"sourcesContent":["module.exports = new Map([\n  ['A128CBC-HS256', 128],\n  ['A128GCM', 96],\n  ['A128GCMKW', 96],\n  ['A192CBC-HS384', 128],\n  ['A192GCM', 96],\n  ['A192GCMKW', 96],\n  ['A256CBC-HS512', 128],\n  ['A256GCM', 96],\n  ['A256GCMKW', 96]\n])\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,IAAI,IAAI;IACvB;QAAC;QAAiB;KAAI;IACtB;QAAC;QAAW;KAAG;IACf;QAAC;QAAa;KAAG;IACjB;QAAC;QAAiB;KAAI;IACtB;QAAC;QAAW;KAAG;IACf;QAAC;QAAa;KAAG;IACjB;QAAC;QAAiB;KAAI;IACtB;QAAC;QAAW;KAAG;IACf;QAAC;QAAa;KAAG;CAClB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 102, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/jwa.js"],"sourcesContent":["module.exports = {\n  sign: new Map(),\n  verify: new Map(),\n  keyManagementEncrypt: new Map(),\n  keyManagementDecrypt: new Map(),\n  encrypt: new Map(),\n  decrypt: new Map()\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG;IACf,MAAM,IAAI;IACV,QAAQ,IAAI;IACZ,sBAAsB,IAAI;IAC1B,sBAAsB,IAAI;IAC1B,SAAS,IAAI;IACb,SAAS,IAAI;AACf","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 115, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/jwk.js"],"sourcesContent":["module.exports = {\n  oct: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  },\n  EC: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  },\n  RSA: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  },\n  OKP: {\n    decrypt: {},\n    deriveKey: {},\n    encrypt: {},\n    sign: {},\n    unwrapKey: {},\n    verify: {},\n    wrapKey: {}\n  }\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG;IACf,KAAK;QACH,SAAS,CAAC;QACV,WAAW,CAAC;QACZ,SAAS,CAAC;QACV,MAAM,CAAC;QACP,WAAW,CAAC;QACZ,QAAQ,CAAC;QACT,SAAS,CAAC;IACZ;IACA,IAAI;QACF,SAAS,CAAC;QACV,WAAW,CAAC;QACZ,SAAS,CAAC;QACV,MAAM,CAAC;QACP,WAAW,CAAC;QACZ,QAAQ,CAAC;QACT,SAAS,CAAC;IACZ;IACA,KAAK;QACH,SAAS,CAAC;QACV,WAAW,CAAC;QACZ,SAAS,CAAC;QACV,MAAM,CAAC;QACP,WAAW,CAAC;QACZ,QAAQ,CAAC;QACT,SAAS,CAAC;IACZ;IACA,KAAK;QACH,SAAS,CAAC;QACV,WAAW,CAAC;QACZ,SAAS,CAAC;QACV,MAAM,CAAC;QACP,WAAW,CAAC;QACZ,QAAQ,CAAC;QACT,SAAS,CAAC;IACZ;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 158, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/key_lengths.js"],"sourcesContent":["module.exports = new Map([\n  ['A128CBC-HS256', 256],\n  ['A128GCM', 128],\n  ['A192CBC-HS384', 384],\n  ['A192GCM', 192],\n  ['A256CBC-HS512', 512],\n  ['A256GCM', 256]\n])\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,IAAI,IAAI;IACvB;QAAC;QAAiB;KAAI;IACtB;QAAC;QAAW;KAAI;IAChB;QAAC;QAAiB;KAAI;IACtB;QAAC;QAAW;KAAI;IAChB;QAAC;QAAiB;KAAI;IACtB;QAAC;QAAW;KAAI;CACjB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 189, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/okp_curves.js"],"sourcesContent":["const curves = new Set(['Ed25519'])\n\nif (!('electron' in process.versions)) {\n  curves.add('Ed448')\n  curves.add('X25519')\n  curves.add('X448')\n}\n\nmodule.exports = curves\n"],"names":[],"mappings":"AAAA,MAAM,SAAS,IAAI,IAAI;IAAC;CAAU;AAElC,IAAI,CAAC,CAAC,cAAc,QAAQ,QAAQ,GAAG;IACrC,OAAO,GAAG,CAAC;IACX,OAAO,GAAG,CAAC;IACX,OAAO,GAAG,CAAC;AACb;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 203, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/ecdh_derive_lengths.js"],"sourcesContent":["module.exports = new Map()\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,IAAI","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 209, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/registry/index.js"],"sourcesContent":["const EC_CURVES = require('./ec_curves')\nconst IVLENGTHS = require('./iv_lengths')\nconst JWA = require('./jwa')\nconst JWK = require('./jwk')\nconst KEYLENGTHS = require('./key_lengths')\nconst OKP_CURVES = require('./okp_curves')\nconst ECDH_DERIVE_LENGTHS = require('./ecdh_derive_lengths')\n\nmodule.exports = {\n  EC_CURVES,\n  ECDH_DERIVE_LENGTHS,\n  IVLENGTHS,\n  JWA,\n  JWK,\n  KEYLENGTHS,\n  OKP_CURVES\n}\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AAEN,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;IACA;IACA;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 230, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/generate_iv.js"],"sourcesContent":["const { randomBytes } = require('crypto')\n\nconst { IVLENGTHS } = require('../registry')\n\nmodule.exports = alg => randomBytes(IVLENGTHS.get(alg) / 8)\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,WAAW,EAAE;AAErB,MAAM,EAAE,SAAS,EAAE;AAEnB,OAAO,OAAO,GAAG,CAAA,MAAO,YAAY,UAAU,GAAG,CAAC,OAAO","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 238, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/base64url.js"],"sourcesContent":["let encode\nlet encodeBuffer\nif (Buffer.isEncoding('base64url')) {\n  encode = (input, encoding = 'utf8') => Buffer.from(input, encoding).toString('base64url')\n  encodeBuffer = (buf) => buf.toString('base64url')\n} else {\n  const fromBase64 = (base64) => base64.replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_')\n  encode = (input, encoding = 'utf8') => fromBase64(Buffer.from(input, encoding).toString('base64'))\n  encodeBuffer = (buf) => fromBase64(buf.toString('base64'))\n}\n\nconst decodeToBuffer = (input) => {\n  return Buffer.from(input, 'base64')\n}\n\nconst decode = (input, encoding = 'utf8') => {\n  return decodeToBuffer(input).toString(encoding)\n}\n\nconst b64uJSON = {\n  encode: (input) => {\n    return encode(JSON.stringify(input))\n  },\n  decode: (input, encoding = 'utf8') => {\n    return JSON.parse(decode(input, encoding))\n  }\n}\n\nb64uJSON.decode.try = (input, encoding = 'utf8') => {\n  try {\n    return b64uJSON.decode(input, encoding)\n  } catch (err) {\n    return decode(input, encoding)\n  }\n}\n\nconst bnToBuf = (bn) => {\n  let hex = BigInt(bn).toString(16)\n  if (hex.length % 2) {\n    hex = `0${hex}`\n  }\n\n  const len = hex.length / 2\n  const u8 = new Uint8Array(len)\n\n  let i = 0\n  let j = 0\n  while (i < len) {\n    u8[i] = parseInt(hex.slice(j, j + 2), 16)\n    i += 1\n    j += 2\n  }\n\n  return u8\n}\n\nconst encodeBigInt = (bn) => encodeBuffer(Buffer.from(bnToBuf(bn)))\n\nmodule.exports.decode = decode\nmodule.exports.decodeToBuffer = decodeToBuffer\nmodule.exports.encode = encode\nmodule.exports.encodeBuffer = encodeBuffer\nmodule.exports.JSON = b64uJSON\nmodule.exports.encodeBigInt = encodeBigInt\n"],"names":[],"mappings":"AAAA,IAAI;AACJ,IAAI;AACJ,IAAI,OAAO,UAAU,CAAC,cAAc;IAClC,SAAS,CAAC,OAAO,WAAW,MAAM,GAAK,OAAO,IAAI,CAAC,OAAO,UAAU,QAAQ,CAAC;IAC7E,eAAe,CAAC,MAAQ,IAAI,QAAQ,CAAC;AACvC,OAAO;IACL,MAAM,aAAa,CAAC,SAAW,OAAO,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,OAAO,KAAK,OAAO,CAAC,OAAO;IAC3F,SAAS,CAAC,OAAO,WAAW,MAAM,GAAK,WAAW,OAAO,IAAI,CAAC,OAAO,UAAU,QAAQ,CAAC;IACxF,eAAe,CAAC,MAAQ,WAAW,IAAI,QAAQ,CAAC;AAClD;AAEA,MAAM,iBAAiB,CAAC;IACtB,OAAO,OAAO,IAAI,CAAC,OAAO;AAC5B;AAEA,MAAM,SAAS,CAAC,OAAO,WAAW,MAAM;IACtC,OAAO,eAAe,OAAO,QAAQ,CAAC;AACxC;AAEA,MAAM,WAAW;IACf,QAAQ,CAAC;QACP,OAAO,OAAO,KAAK,SAAS,CAAC;IAC/B;IACA,QAAQ,CAAC,OAAO,WAAW,MAAM;QAC/B,OAAO,KAAK,KAAK,CAAC,OAAO,OAAO;IAClC;AACF;AAEA,SAAS,MAAM,CAAC,GAAG,GAAG,CAAC,OAAO,WAAW,MAAM;IAC7C,IAAI;QACF,OAAO,SAAS,MAAM,CAAC,OAAO;IAChC,EAAE,OAAO,KAAK;QACZ,OAAO,OAAO,OAAO;IACvB;AACF;AAEA,MAAM,UAAU,CAAC;IACf,IAAI,MAAM,OAAO,IAAI,QAAQ,CAAC;IAC9B,IAAI,IAAI,MAAM,GAAG,GAAG;QAClB,MAAM,CAAC,CAAC,EAAE,KAAK;IACjB;IAEA,MAAM,MAAM,IAAI,MAAM,GAAG;IACzB,MAAM,KAAK,IAAI,WAAW;IAE1B,IAAI,IAAI;IACR,IAAI,IAAI;IACR,MAAO,IAAI,IAAK;QACd,EAAE,CAAC,EAAE,GAAG,SAAS,IAAI,KAAK,CAAC,GAAG,IAAI,IAAI;QACtC,KAAK;QACL,KAAK;IACP;IAEA,OAAO;AACT;AAEA,MAAM,eAAe,CAAC,KAAO,aAAa,OAAO,IAAI,CAAC,QAAQ;AAE9D,OAAO,OAAO,CAAC,MAAM,GAAG;AACxB,OAAO,OAAO,CAAC,cAAc,GAAG;AAChC,OAAO,OAAO,CAAC,MAAM,GAAG;AACxB,OAAO,OAAO,CAAC,YAAY,GAAG;AAC9B,OAAO,OAAO,CAAC,IAAI,GAAG;AACtB,OAAO,OAAO,CAAC,YAAY,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 297, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/errors.js"],"sourcesContent":["const CODES = {\n  JOSEAlgNotWhitelisted: 'ERR_JOSE_ALG_NOT_WHITELISTED',\n  JOSECritNotUnderstood: 'ERR_JOSE_CRIT_NOT_UNDERSTOOD',\n  JOSEInvalidEncoding: 'ERR_JOSE_INVALID_ENCODING',\n  JOSEMultiError: 'ERR_JOSE_MULTIPLE_ERRORS',\n  JOSENotSupported: 'ERR_JOSE_NOT_SUPPORTED',\n  JWEDecryptionFailed: 'ERR_JWE_DECRYPTION_FAILED',\n  JWEInvalid: 'ERR_JWE_INVALID',\n  JWKImportFailed: 'ERR_JWK_IMPORT_FAILED',\n  JWKInvalid: 'ERR_JWK_INVALID',\n  JWKKeySupport: 'ERR_JWK_KEY_SUPPORT',\n  JWKSNoMatchingKey: 'ERR_JWKS_NO_MATCHING_KEY',\n  JWSInvalid: 'ERR_JWS_INVALID',\n  JWSVerificationFailed: 'ERR_JWS_VERIFICATION_FAILED',\n  JWTClaimInvalid: 'ERR_JWT_CLAIM_INVALID',\n  JWTExpired: 'ERR_JWT_EXPIRED',\n  JWTMalformed: 'ERR_JWT_MALFORMED'\n}\n\nconst DEFAULT_MESSAGES = {\n  JWEDecryptionFailed: 'decryption operation failed',\n  JWEInvalid: 'JWE invalid',\n  JWKSNoMatchingKey: 'no matching key found in the KeyStore',\n  JWSInvalid: 'JWS invalid',\n  JWSVerificationFailed: 'signature verification failed'\n}\n\nclass JOSEError extends Error {\n  constructor (message) {\n    super(message)\n    if (message === undefined) {\n      this.message = DEFAULT_MESSAGES[this.constructor.name]\n    }\n    this.name = this.constructor.name\n    this.code = CODES[this.constructor.name]\n    Error.captureStackTrace(this, this.constructor)\n  }\n}\n\nconst isMulti = e => e instanceof JOSEMultiError\nclass JOSEMultiError extends JOSEError {\n  constructor (errors) {\n    super()\n    let i\n    while ((i = errors.findIndex(isMulti)) && i !== -1) {\n      errors.splice(i, 1, ...errors[i])\n    }\n    Object.defineProperty(this, 'errors', { value: errors })\n  }\n\n  * [Symbol.iterator] () {\n    for (const error of this.errors) {\n      yield error\n    }\n  }\n}\nmodule.exports.JOSEError = JOSEError\n\nmodule.exports.JOSEAlgNotWhitelisted = class JOSEAlgNotWhitelisted extends JOSEError {}\nmodule.exports.JOSECritNotUnderstood = class JOSECritNotUnderstood extends JOSEError {}\nmodule.exports.JOSEInvalidEncoding = class JOSEInvalidEncoding extends JOSEError {}\nmodule.exports.JOSEMultiError = JOSEMultiError\nmodule.exports.JOSENotSupported = class JOSENotSupported extends JOSEError {}\n\nmodule.exports.JWEDecryptionFailed = class JWEDecryptionFailed extends JOSEError {}\nmodule.exports.JWEInvalid = class JWEInvalid extends JOSEError {}\n\nmodule.exports.JWKImportFailed = class JWKImportFailed extends JOSEError {}\nmodule.exports.JWKInvalid = class JWKInvalid extends JOSEError {}\nmodule.exports.JWKKeySupport = class JWKKeySupport extends JOSEError {}\n\nmodule.exports.JWKSNoMatchingKey = class JWKSNoMatchingKey extends JOSEError {}\n\nmodule.exports.JWSInvalid = class JWSInvalid extends JOSEError {}\nmodule.exports.JWSVerificationFailed = class JWSVerificationFailed extends JOSEError {}\n\nclass JWTClaimInvalid extends JOSEError {\n  constructor (message, claim = 'unspecified', reason = 'unspecified') {\n    super(message)\n    this.claim = claim\n    this.reason = reason\n  }\n}\nmodule.exports.JWTClaimInvalid = JWTClaimInvalid\nmodule.exports.JWTExpired = class JWTExpired extends JWTClaimInvalid {}\nmodule.exports.JWTMalformed = class JWTMalformed extends JOSEError {}\n"],"names":[],"mappings":"AAAA,MAAM,QAAQ;IACZ,uBAAuB;IACvB,uBAAuB;IACvB,qBAAqB;IACrB,gBAAgB;IAChB,kBAAkB;IAClB,qBAAqB;IACrB,YAAY;IACZ,iBAAiB;IACjB,YAAY;IACZ,eAAe;IACf,mBAAmB;IACnB,YAAY;IACZ,uBAAuB;IACvB,iBAAiB;IACjB,YAAY;IACZ,cAAc;AAChB;AAEA,MAAM,mBAAmB;IACvB,qBAAqB;IACrB,YAAY;IACZ,mBAAmB;IACnB,YAAY;IACZ,uBAAuB;AACzB;AAEA,MAAM,kBAAkB;IACtB,YAAa,OAAO,CAAE;QACpB,KAAK,CAAC;QACN,IAAI,YAAY,WAAW;YACzB,IAAI,CAAC,OAAO,GAAG,gBAAgB,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;QACxD;QACA,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC,WAAW,CAAC,IAAI;QACjC,IAAI,CAAC,IAAI,GAAG,KAAK,CAAC,IAAI,CAAC,WAAW,CAAC,IAAI,CAAC;QACxC,MAAM,iBAAiB,CAAC,IAAI,EAAE,IAAI,CAAC,WAAW;IAChD;AACF;AAEA,MAAM,UAAU,CAAA,IAAK,aAAa;AAClC,MAAM,uBAAuB;IAC3B,YAAa,MAAM,CAAE;QACnB,KAAK;QACL,IAAI;QACJ,MAAO,CAAC,IAAI,OAAO,SAAS,CAAC,QAAQ,KAAK,MAAM,CAAC,EAAG;YAClD,OAAO,MAAM,CAAC,GAAG,MAAM,MAAM,CAAC,EAAE;QAClC;QACA,OAAO,cAAc,CAAC,IAAI,EAAE,UAAU;YAAE,OAAO;QAAO;IACxD;IAEA,CAAE,CAAC,OAAO,QAAQ,CAAC,GAAI;QACrB,KAAK,MAAM,SAAS,IAAI,CAAC,MAAM,CAAE;YAC/B,MAAM;QACR;IACF;AACF;AACA,OAAO,OAAO,CAAC,SAAS,GAAG;AAE3B,OAAO,OAAO,CAAC,qBAAqB,GAAG,MAAM,8BAA8B;AAAW;AACtF,OAAO,OAAO,CAAC,qBAAqB,GAAG,MAAM,8BAA8B;AAAW;AACtF,OAAO,OAAO,CAAC,mBAAmB,GAAG,MAAM,4BAA4B;AAAW;AAClF,OAAO,OAAO,CAAC,cAAc,GAAG;AAChC,OAAO,OAAO,CAAC,gBAAgB,GAAG,MAAM,yBAAyB;AAAW;AAE5E,OAAO,OAAO,CAAC,mBAAmB,GAAG,MAAM,4BAA4B;AAAW;AAClF,OAAO,OAAO,CAAC,UAAU,GAAG,MAAM,mBAAmB;AAAW;AAEhE,OAAO,OAAO,CAAC,eAAe,GAAG,MAAM,wBAAwB;AAAW;AAC1E,OAAO,OAAO,CAAC,UAAU,GAAG,MAAM,mBAAmB;AAAW;AAChE,OAAO,OAAO,CAAC,aAAa,GAAG,MAAM,sBAAsB;AAAW;AAEtE,OAAO,OAAO,CAAC,iBAAiB,GAAG,MAAM,0BAA0B;AAAW;AAE9E,OAAO,OAAO,CAAC,UAAU,GAAG,MAAM,mBAAmB;AAAW;AAChE,OAAO,OAAO,CAAC,qBAAqB,GAAG,MAAM,8BAA8B;AAAW;AAEtF,MAAM,wBAAwB;IAC5B,YAAa,OAAO,EAAE,QAAQ,aAAa,EAAE,SAAS,aAAa,CAAE;QACnE,KAAK,CAAC;QACN,IAAI,CAAC,KAAK,GAAG;QACb,IAAI,CAAC,MAAM,GAAG;IAChB;AACF;AACA,OAAO,OAAO,CAAC,eAAe,GAAG;AACjC,OAAO,OAAO,CAAC,UAAU,GAAG,MAAM,mBAAmB;AAAiB;AACtE,OAAO,OAAO,CAAC,YAAY,GAAG,MAAM,qBAAqB;AAAW","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 394, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/runtime_support.js"],"sourcesContent":["const { diffieHellman, KeyObject, sign, verify } = require('crypto')\n\nconst [major, minor] = process.version.substr(1).split('.').map(x => parseInt(x, 10))\n\nmodule.exports = {\n  oaepHashSupported: major > 12 || (major === 12 && minor >= 9),\n  keyObjectSupported: !!KeyObject && major >= 12,\n  edDSASupported: !!sign && !!verify,\n  dsaEncodingSupported: major > 13 || (major === 13 && minor >= 2) || (major === 12 && minor >= 16),\n  improvedDH: !!diffieHellman\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,aAAa,EAAE,SAAS,EAAE,IAAI,EAAE,MAAM,EAAE;AAEhD,MAAM,CAAC,OAAO,MAAM,GAAG,QAAQ,OAAO,CAAC,MAAM,CAAC,GAAG,KAAK,CAAC,KAAK,GAAG,CAAC,CAAA,IAAK,SAAS,GAAG;AAEjF,OAAO,OAAO,GAAG;IACf,mBAAmB,QAAQ,MAAO,UAAU,MAAM,SAAS;IAC3D,oBAAoB,CAAC,CAAC,aAAa,SAAS;IAC5C,gBAAgB,CAAC,CAAC,QAAQ,CAAC,CAAC;IAC5B,sBAAsB,QAAQ,MAAO,UAAU,MAAM,SAAS,KAAO,UAAU,MAAM,SAAS;IAC9F,YAAY,CAAC,CAAC;AAChB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 408, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/is_object.js"],"sourcesContent":["module.exports = a => !!a && a.constructor === Object\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAA,IAAK,CAAC,CAAC,KAAK,EAAE,WAAW,KAAK","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 414, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/oids.js"],"sourcesContent":["const oids = {\n  '1 2 840 10045 3 1 7': 'P-256',\n  '1 3 132 0 10': 'secp256k1',\n  '1 3 132 0 34': 'P-384',\n  '1 3 132 0 35': 'P-521',\n  '1 2 840 10045 2 1': 'ecPublicKey',\n  '1 2 840 113549 1 1 1': 'rsaEncryption',\n  '1 3 101 110': 'X25519',\n  '1 3 101 111': 'X448',\n  '1 3 101 112': 'Ed25519',\n  '1 3 101 113': 'Ed448'\n}\n\nmodule.exports = oids\n"],"names":[],"mappings":"AAAA,MAAM,OAAO;IACX,uBAAuB;IACvB,gBAAgB;IAChB,gBAAgB;IAChB,gBAAgB;IAChB,qBAAqB;IACrB,wBAAwB;IACxB,eAAe;IACf,eAAe;IACf,eAAe;IACf,eAAe;AACjB;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 432, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/algorithm_identifier.js"],"sourcesContent":["const oids = require('./oids')\n\nmodule.exports = function () {\n  this.seq().obj(\n    this.key('algorithm').objid(oids),\n    this.key('parameters').optional().choice({ namedCurve: this.objid(oids), null: this.null_() })\n  )\n}\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,OAAO,OAAO,GAAG;IACf,IAAI,CAAC,GAAG,GAAG,GAAG,CACZ,IAAI,CAAC,GAAG,CAAC,aAAa,KAAK,CAAC,OAC5B,IAAI,CAAC,GAAG,CAAC,cAAc,QAAQ,GAAG,MAAM,CAAC;QAAE,YAAY,IAAI,CAAC,KAAK,CAAC;QAAO,MAAM,IAAI,CAAC,KAAK;IAAG;AAEhG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 444, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/ec_private_key.js"],"sourcesContent":["const oids = require('./oids')\n\nmodule.exports = function () {\n  this.seq().obj(\n    this.key('version').int(),\n    this.key('privateKey').octstr(),\n    this.key('parameters').explicit(0).optional().choice({ namedCurve: this.objid(oids) }),\n    this.key('publicKey').explicit(1).optional().bitstr()\n  )\n}\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,OAAO,OAAO,GAAG;IACf,IAAI,CAAC,GAAG,GAAG,GAAG,CACZ,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,IACvB,IAAI,CAAC,GAAG,CAAC,cAAc,MAAM,IAC7B,IAAI,CAAC,GAAG,CAAC,cAAc,QAAQ,CAAC,GAAG,QAAQ,GAAG,MAAM,CAAC;QAAE,YAAY,IAAI,CAAC,KAAK,CAAC;IAAM,IACpF,IAAI,CAAC,GAAG,CAAC,aAAa,QAAQ,CAAC,GAAG,QAAQ,GAAG,MAAM;AAEvD","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 455, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/private_key_info.js"],"sourcesContent":["module.exports = (AlgorithmIdentifier) => function () {\n  this.seq().obj(\n    this.key('version').int(),\n    this.key('algorithm').use(AlgorithmIdentifier),\n    this.key('privateKey').octstr()\n  )\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAC,sBAAwB;QACxC,IAAI,CAAC,GAAG,GAAG,GAAG,CACZ,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,IACvB,IAAI,CAAC,GAAG,CAAC,aAAa,GAAG,CAAC,sBAC1B,IAAI,CAAC,GAAG,CAAC,cAAc,MAAM;IAEjC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 463, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/public_key_info.js"],"sourcesContent":["module.exports = AlgorithmIdentifier => function () {\n  this.seq().obj(\n    this.key('algorithm').use(AlgorithmIdentifier),\n    this.key('publicKey').bitstr()\n  )\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAA,sBAAuB;QACtC,IAAI,CAAC,GAAG,GAAG,GAAG,CACZ,IAAI,CAAC,GAAG,CAAC,aAAa,GAAG,CAAC,sBAC1B,IAAI,CAAC,GAAG,CAAC,aAAa,MAAM;IAEhC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 471, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/private_key.js"],"sourcesContent":["module.exports = function () {\n  this.octstr().contains().obj(\n    this.key('privateKey').octstr()\n  )\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG;IACf,IAAI,CAAC,MAAM,GAAG,QAAQ,GAAG,GAAG,CAC1B,IAAI,CAAC,GAAG,CAAC,cAAc,MAAM;AAEjC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 479, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/one_asymmetric_key.js"],"sourcesContent":["module.exports = (AlgorithmIdentifier, PrivateKey) => function () {\n  this.seq().obj(\n    this.key('version').int(),\n    this.key('algorithm').use(AlgorithmIdentifier),\n    this.key('privateKey').use(PrivateKey)\n  )\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAC,qBAAqB,aAAe;QACpD,IAAI,CAAC,GAAG,GAAG,GAAG,CACZ,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,IACvB,IAAI,CAAC,GAAG,CAAC,aAAa,GAAG,CAAC,sBAC1B,IAAI,CAAC,GAAG,CAAC,cAAc,GAAG,CAAC;IAE/B","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 487, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/rsa_private_key.js"],"sourcesContent":["module.exports = function () {\n  this.seq().obj(\n    this.key('version').int({ 0: 'two-prime', 1: 'multi' }),\n    this.key('n').int(),\n    this.key('e').int(),\n    this.key('d').int(),\n    this.key('p').int(),\n    this.key('q').int(),\n    this.key('dp').int(),\n    this.key('dq').int(),\n    this.key('qi').int()\n  )\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG;IACf,IAAI,CAAC,GAAG,GAAG,GAAG,CACZ,IAAI,CAAC,GAAG,CAAC,WAAW,GAAG,CAAC;QAAE,GAAG;QAAa,GAAG;IAAQ,IACrD,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IACjB,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IACjB,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IACjB,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IACjB,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IACjB,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,IAClB,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG,IAClB,IAAI,CAAC,GAAG,CAAC,MAAM,GAAG;AAEtB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 498, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/rsa_public_key.js"],"sourcesContent":["module.exports = function () {\n  this.seq().obj(\n    this.key('n').int(),\n    this.key('e').int()\n  )\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG;IACf,IAAI,CAAC,GAAG,GAAG,GAAG,CACZ,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG,IACjB,IAAI,CAAC,GAAG,CAAC,KAAK,GAAG;AAErB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 506, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/asn1/index.js"],"sourcesContent":["const asn1 = require('@panva/asn1.js')\n\nconst types = new Map()\n\nconst AlgorithmIdentifier = asn1.define('AlgorithmIdentifier', require('./algorithm_identifier'))\ntypes.set('AlgorithmIdentifier', AlgorithmIdentifier)\n\nconst ECPrivateKey = asn1.define('ECPrivateKey', require('./ec_private_key'))\ntypes.set('ECPrivateKey', ECPrivateKey)\n\nconst PrivateKeyInfo = asn1.define('PrivateKeyInfo', require('./private_key_info')(AlgorithmIdentifier))\ntypes.set('PrivateKeyInfo', PrivateKeyInfo)\n\nconst PublicKeyInfo = asn1.define('PublicKeyInfo', require('./public_key_info')(AlgorithmIdentifier))\ntypes.set('PublicKeyInfo', PublicKeyInfo)\n\nconst PrivateKey = asn1.define('PrivateKey', require('./private_key'))\ntypes.set('PrivateKey', PrivateKey)\n\nconst OneAsymmetricKey = asn1.define('OneAsymmetricKey', require('./one_asymmetric_key')(AlgorithmIdentifier, PrivateKey))\ntypes.set('OneAsymmetricKey', OneAsymmetricKey)\n\nconst RSAPrivateKey = asn1.define('RSAPrivateKey', require('./rsa_private_key'))\ntypes.set('RSAPrivateKey', RSAPrivateKey)\n\nconst RSAPublicKey = asn1.define('RSAPublicKey', require('./rsa_public_key'))\ntypes.set('RSAPublicKey', RSAPublicKey)\n\nmodule.exports = types\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,MAAM,QAAQ,IAAI;AAElB,MAAM,sBAAsB,KAAK,MAAM,CAAC;AACxC,MAAM,GAAG,CAAC,uBAAuB;AAEjC,MAAM,eAAe,KAAK,MAAM,CAAC;AACjC,MAAM,GAAG,CAAC,gBAAgB;AAE1B,MAAM,iBAAiB,KAAK,MAAM,CAAC,kBAAkB,yIAA8B;AACnF,MAAM,GAAG,CAAC,kBAAkB;AAE5B,MAAM,gBAAgB,KAAK,MAAM,CAAC,iBAAiB,wIAA6B;AAChF,MAAM,GAAG,CAAC,iBAAiB;AAE3B,MAAM,aAAa,KAAK,MAAM,CAAC;AAC/B,MAAM,GAAG,CAAC,cAAc;AAExB,MAAM,mBAAmB,KAAK,MAAM,CAAC,oBAAoB,2IAAgC,qBAAqB;AAC9G,MAAM,GAAG,CAAC,oBAAoB;AAE9B,MAAM,gBAAgB,KAAK,MAAM,CAAC;AAClC,MAAM,GAAG,CAAC,iBAAiB;AAE3B,MAAM,eAAe,KAAK,MAAM,CAAC;AACjC,MAAM,GAAG,CAAC,gBAAgB;AAE1B,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 530, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/key_object.js"],"sourcesContent":["const { keyObjectSupported } = require('./runtime_support')\n\nlet createPublicKey\nlet createPrivateKey\nlet createSecretKey\nlet KeyObject\nlet asInput\n\nif (keyObjectSupported) {\n  ({ createPublicKey, createPrivateKey, createSecretKey, KeyObject } = require('crypto'))\n  asInput = (input) => input\n} else {\n  const { EOL } = require('os')\n\n  const errors = require('../errors')\n  const isObject = require('./is_object')\n  const asn1 = require('./asn1')\n  const toInput = Symbol('toInput')\n\n  const namedCurve = Symbol('namedCurve')\n\n  asInput = (keyObject, needsPublic) => {\n    if (keyObject instanceof KeyObject) {\n      return keyObject[toInput](needsPublic)\n    }\n\n    return createSecretKey(keyObject)[toInput](needsPublic)\n  }\n\n  const pemToDer = pem => Buffer.from(pem.replace(/(?:-----(?:BEGIN|END)(?: (?:RSA|EC))? (?:PRIVATE|PUBLIC) KEY-----|\\s)/g, ''), 'base64')\n  const derToPem = (der, label) => `-----BEGIN ${label}-----${EOL}${(der.toString('base64').match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END ${label}-----`\n  const unsupported = (input) => {\n    const label = typeof input === 'string' ? input : `OID ${input.join('.')}`\n    throw new errors.JOSENotSupported(`${label} is not supported in your Node.js runtime version`)\n  }\n\n  KeyObject = class KeyObject {\n    export ({ cipher, passphrase, type, format } = {}) {\n      if (this._type === 'secret') {\n        return this._buffer\n      }\n\n      if (this._type === 'public') {\n        if (this.asymmetricKeyType === 'rsa') {\n          switch (type) {\n            case 'pkcs1':\n              if (format === 'pem') {\n                return this._pem\n              }\n\n              return pemToDer(this._pem)\n            case 'spki': {\n              const PublicKeyInfo = asn1.get('PublicKeyInfo')\n              const pem = PublicKeyInfo.encode({\n                algorithm: {\n                  algorithm: 'rsaEncryption',\n                  parameters: { type: 'null' }\n                },\n                publicKey: {\n                  unused: 0,\n                  data: pemToDer(this._pem)\n                }\n              }, 'pem', { label: 'PUBLIC KEY' })\n\n              return format === 'pem' ? pem : pemToDer(pem)\n            }\n            default:\n              throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n          }\n        }\n\n        if (this.asymmetricKeyType === 'ec') {\n          if (type !== 'spki') {\n            throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n          }\n\n          if (format === 'pem') {\n            return this._pem\n          }\n\n          return pemToDer(this._pem)\n        }\n      }\n\n      if (this._type === 'private') {\n        if (passphrase !== undefined || cipher !== undefined) {\n          throw new errors.JOSENotSupported('encrypted private keys are not supported in your Node.js runtime version')\n        }\n\n        if (type === 'pkcs8') {\n          if (this._pkcs8) {\n            if (format === 'der' && typeof this._pkcs8 === 'string') {\n              return pemToDer(this._pkcs8)\n            }\n\n            if (format === 'pem' && Buffer.isBuffer(this._pkcs8)) {\n              return derToPem(this._pkcs8, 'PRIVATE KEY')\n            }\n\n            return this._pkcs8\n          }\n\n          if (this.asymmetricKeyType === 'rsa') {\n            const parsed = this._asn1\n            const RSAPrivateKey = asn1.get('RSAPrivateKey')\n            const privateKey = RSAPrivateKey.encode(parsed)\n            const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n            const pkcs8 = PrivateKeyInfo.encode({\n              version: 0,\n              privateKey,\n              algorithm: {\n                algorithm: 'rsaEncryption',\n                parameters: { type: 'null' }\n              }\n            })\n\n            this._pkcs8 = pkcs8\n\n            return this.export({ type, format })\n          }\n\n          if (this.asymmetricKeyType === 'ec') {\n            const parsed = this._asn1\n            const ECPrivateKey = asn1.get('ECPrivateKey')\n            const privateKey = ECPrivateKey.encode({\n              version: parsed.version,\n              privateKey: parsed.privateKey,\n              publicKey: parsed.publicKey\n            })\n            const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n            const pkcs8 = PrivateKeyInfo.encode({\n              version: 0,\n              privateKey,\n              algorithm: {\n                algorithm: 'ecPublicKey',\n                parameters: this._asn1.parameters\n              }\n            })\n\n            this._pkcs8 = pkcs8\n\n            return this.export({ type, format })\n          }\n        }\n\n        if (this.asymmetricKeyType === 'rsa' && type === 'pkcs1') {\n          if (format === 'pem') {\n            return this._pem\n          }\n\n          return pemToDer(this._pem)\n        } else if (this.asymmetricKeyType === 'ec' && type === 'sec1') {\n          if (format === 'pem') {\n            return this._pem\n          }\n\n          return pemToDer(this._pem)\n        } else {\n          throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n        }\n      }\n    }\n\n    get type () {\n      return this._type\n    }\n\n    get asymmetricKeyType () {\n      return this._asymmetricKeyType\n    }\n\n    get symmetricKeySize () {\n      return this._symmetricKeySize\n    }\n\n    [toInput] (needsPublic) {\n      switch (this._type) {\n        case 'secret':\n          return this._buffer\n        case 'public':\n          return this._pem\n        default:\n          if (needsPublic) {\n            if (!('_pub' in this)) {\n              this._pub = createPublicKey(this)\n            }\n\n            return this._pub[toInput](false)\n          }\n\n          return this._pem\n      }\n    }\n  }\n\n  createSecretKey = (buffer) => {\n    if (!Buffer.isBuffer(buffer) || !buffer.length) {\n      throw new TypeError('input must be a non-empty Buffer instance')\n    }\n\n    const keyObject = new KeyObject()\n    keyObject._buffer = Buffer.from(buffer)\n    keyObject._symmetricKeySize = buffer.length\n    keyObject._type = 'secret'\n\n    return keyObject\n  }\n\n  createPublicKey = (input) => {\n    if (input instanceof KeyObject) {\n      if (input.type !== 'private') {\n        throw new TypeError(`Invalid key object type ${input.type}, expected private.`)\n      }\n\n      switch (input.asymmetricKeyType) {\n        case 'ec': {\n          const PublicKeyInfo = asn1.get('PublicKeyInfo')\n          const key = PublicKeyInfo.encode({\n            algorithm: {\n              algorithm: 'ecPublicKey',\n              parameters: input._asn1.parameters\n            },\n            publicKey: input._asn1.publicKey\n          })\n\n          return createPublicKey({ key, format: 'der', type: 'spki' })\n        }\n        case 'rsa': {\n          const RSAPublicKey = asn1.get('RSAPublicKey')\n          const key = RSAPublicKey.encode(input._asn1)\n          return createPublicKey({ key, format: 'der', type: 'pkcs1' })\n        }\n      }\n    }\n\n    if (typeof input === 'string' || Buffer.isBuffer(input)) {\n      input = { key: input, format: 'pem' }\n    }\n\n    if (!isObject(input)) {\n      throw new TypeError('input must be a string, Buffer or an object')\n    }\n\n    const { format, passphrase } = input\n    let { key, type } = input\n\n    if (typeof key !== 'string' && !Buffer.isBuffer(key)) {\n      throw new TypeError('key must be a string or Buffer')\n    }\n\n    if (format !== 'pem' && format !== 'der') {\n      throw new TypeError('format must be one of \"pem\" or \"der\"')\n    }\n\n    let label\n    if (format === 'pem') {\n      key = key.toString()\n      switch (key.split(/\\r?\\n/g)[0].toString()) {\n        case '-----BEGIN PUBLIC KEY-----':\n          type = 'spki'\n          label = 'PUBLIC KEY'\n          break\n        case '-----BEGIN RSA PUBLIC KEY-----':\n          type = 'pkcs1'\n          label = 'RSA PUBLIC KEY'\n          break\n        case '-----BEGIN CERTIFICATE-----':\n          throw new errors.JOSENotSupported('X.509 certificates are not supported in your Node.js runtime version')\n        case '-----BEGIN PRIVATE KEY-----':\n        case '-----BEGIN EC PRIVATE KEY-----':\n        case '-----BEGIN RSA PRIVATE KEY-----':\n          return createPublicKey(createPrivateKey(key))\n        default:\n          throw new TypeError('unknown/unsupported PEM type')\n      }\n    }\n\n    switch (type) {\n      case 'spki': {\n        const PublicKeyInfo = asn1.get('PublicKeyInfo')\n        const parsed = PublicKeyInfo.decode(key, format, { label })\n\n        let type, keyObject\n        switch (parsed.algorithm.algorithm) {\n          case 'ecPublicKey': {\n            keyObject = new KeyObject()\n            keyObject._asn1 = parsed\n            keyObject._asymmetricKeyType = 'ec'\n            keyObject._type = 'public'\n            keyObject._pem = PublicKeyInfo.encode(parsed, 'pem', { label: 'PUBLIC KEY' })\n\n            break\n          }\n          case 'rsaEncryption': {\n            type = 'pkcs1'\n            keyObject = createPublicKey({ type, key: parsed.publicKey.data, format: 'der' })\n            break\n          }\n          default:\n            unsupported(parsed.algorithm.algorithm)\n        }\n\n        return keyObject\n      }\n      case 'pkcs1': {\n        const RSAPublicKey = asn1.get('RSAPublicKey')\n        const parsed = RSAPublicKey.decode(key, format, { label })\n\n        // special case when private pkcs1 PEM / DER is used with createPublicKey\n        if (parsed.n === BigInt(0)) {\n          return createPublicKey(createPrivateKey({ key, format, type, passphrase }))\n        }\n\n        const keyObject = new KeyObject()\n        keyObject._asn1 = parsed\n        keyObject._asymmetricKeyType = 'rsa'\n        keyObject._type = 'public'\n        keyObject._pem = RSAPublicKey.encode(parsed, 'pem', { label: 'RSA PUBLIC KEY' })\n\n        return keyObject\n      }\n      case 'pkcs8':\n      case 'sec1':\n        return createPublicKey(createPrivateKey({ format, key, type, passphrase }))\n      default:\n        throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n    }\n  }\n\n  createPrivateKey = (input, hints) => {\n    if (typeof input === 'string' || Buffer.isBuffer(input)) {\n      input = { key: input, format: 'pem' }\n    }\n\n    if (!isObject(input)) {\n      throw new TypeError('input must be a string, Buffer or an object')\n    }\n\n    const { format, passphrase } = input\n    let { key, type } = input\n\n    if (typeof key !== 'string' && !Buffer.isBuffer(key)) {\n      throw new TypeError('key must be a string or Buffer')\n    }\n\n    if (passphrase !== undefined) {\n      throw new errors.JOSENotSupported('encrypted private keys are not supported in your Node.js runtime version')\n    }\n\n    if (format !== 'pem' && format !== 'der') {\n      throw new TypeError('format must be one of \"pem\" or \"der\"')\n    }\n\n    let label\n    if (format === 'pem') {\n      key = key.toString()\n      switch (key.split(/\\r?\\n/g)[0].toString()) {\n        case '-----BEGIN PRIVATE KEY-----':\n          type = 'pkcs8'\n          label = 'PRIVATE KEY'\n          break\n        case '-----BEGIN EC PRIVATE KEY-----':\n          type = 'sec1'\n          label = 'EC PRIVATE KEY'\n          break\n        case '-----BEGIN RSA PRIVATE KEY-----':\n          type = 'pkcs1'\n          label = 'RSA PRIVATE KEY'\n          break\n        default:\n          throw new TypeError('unknown/unsupported PEM type')\n      }\n    }\n\n    switch (type) {\n      case 'pkcs8': {\n        const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n        const parsed = PrivateKeyInfo.decode(key, format, { label })\n\n        let type, keyObject\n        switch (parsed.algorithm.algorithm) {\n          case 'ecPublicKey': {\n            type = 'sec1'\n            keyObject = createPrivateKey({ type, key: parsed.privateKey, format: 'der' }, { [namedCurve]: parsed.algorithm.parameters.value })\n            break\n          }\n          case 'rsaEncryption': {\n            type = 'pkcs1'\n            keyObject = createPrivateKey({ type, key: parsed.privateKey, format: 'der' })\n            break\n          }\n          default:\n            unsupported(parsed.algorithm.algorithm)\n        }\n\n        keyObject._pkcs8 = key\n        return keyObject\n      }\n      case 'pkcs1': {\n        const RSAPrivateKey = asn1.get('RSAPrivateKey')\n        const parsed = RSAPrivateKey.decode(key, format, { label })\n\n        const keyObject = new KeyObject()\n        keyObject._asn1 = parsed\n        keyObject._asymmetricKeyType = 'rsa'\n        keyObject._type = 'private'\n        keyObject._pem = RSAPrivateKey.encode(parsed, 'pem', { label: 'RSA PRIVATE KEY' })\n\n        return keyObject\n      }\n      case 'sec1': {\n        const ECPrivateKey = asn1.get('ECPrivateKey')\n        let parsed = ECPrivateKey.decode(key, format, { label })\n\n        if (!('parameters' in parsed) && !hints[namedCurve]) {\n          throw new Error('invalid sec1')\n        } else if (!('parameters' in parsed)) {\n          parsed = { ...parsed, parameters: { type: 'namedCurve', value: hints[namedCurve] } }\n        }\n\n        const keyObject = new KeyObject()\n        keyObject._asn1 = parsed\n        keyObject._asymmetricKeyType = 'ec'\n        keyObject._type = 'private'\n        keyObject._pem = ECPrivateKey.encode(parsed, 'pem', { label: 'EC PRIVATE KEY' })\n\n        return keyObject\n      }\n      default:\n        throw new TypeError(`The value ${type} is invalid for option \"type\"`)\n    }\n  }\n}\n\nmodule.exports = { createPublicKey, createPrivateKey, createSecretKey, KeyObject, asInput }\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,kBAAkB,EAAE;AAE5B,IAAI;AACJ,IAAI;AACJ,IAAI;AACJ,IAAI;AACJ,IAAI;AAEJ,IAAI,oBAAoB;IACtB,CAAC,EAAE,eAAe,EAAE,gBAAgB,EAAE,eAAe,EAAE,SAAS,EAAE,yEAAoB;IACtF,UAAU,CAAC,QAAU;AACvB,OAAO;IACL,MAAM,EAAE,GAAG,EAAE;IAEb,MAAM;IACN,MAAM;IACN,MAAM;IACN,MAAM,UAAU,OAAO;IAEvB,MAAM,aAAa,OAAO;IAE1B,UAAU,CAAC,WAAW;QACpB,IAAI,qBAAqB,WAAW;YAClC,OAAO,SAAS,CAAC,QAAQ,CAAC;QAC5B;QAEA,OAAO,gBAAgB,UAAU,CAAC,QAAQ,CAAC;IAC7C;IAEA,MAAM,WAAW,CAAA,MAAO,OAAO,IAAI,CAAC,IAAI,OAAO,CAAC,0EAA0E,KAAK;IAC/H,MAAM,WAAW,CAAC,KAAK,QAAU,CAAC,WAAW,EAAE,MAAM,KAAK,EAAE,MAAM,CAAC,IAAI,QAAQ,CAAC,UAAU,KAAK,CAAC,eAAe,EAAE,EAAE,IAAI,CAAC,OAAO,IAAI,SAAS,EAAE,MAAM,KAAK,CAAC;IAC1J,MAAM,cAAc,CAAC;QACnB,MAAM,QAAQ,OAAO,UAAU,WAAW,QAAQ,CAAC,IAAI,EAAE,MAAM,IAAI,CAAC,MAAM;QAC1E,MAAM,IAAI,OAAO,gBAAgB,CAAC,GAAG,MAAM,iDAAiD,CAAC;IAC/F;IAEA,YAAY,MAAM;QAChB,OAAQ,EAAE,MAAM,EAAE,UAAU,EAAE,IAAI,EAAE,MAAM,EAAE,GAAG,CAAC,CAAC,EAAE;YACjD,IAAI,IAAI,CAAC,KAAK,KAAK,UAAU;gBAC3B,OAAO,IAAI,CAAC,OAAO;YACrB;YAEA,IAAI,IAAI,CAAC,KAAK,KAAK,UAAU;gBAC3B,IAAI,IAAI,CAAC,iBAAiB,KAAK,OAAO;oBACpC,OAAQ;wBACN,KAAK;4BACH,IAAI,WAAW,OAAO;gCACpB,OAAO,IAAI,CAAC,IAAI;4BAClB;4BAEA,OAAO,SAAS,IAAI,CAAC,IAAI;wBAC3B,KAAK;4BAAQ;gCACX,MAAM,gBAAgB,KAAK,GAAG,CAAC;gCAC/B,MAAM,MAAM,cAAc,MAAM,CAAC;oCAC/B,WAAW;wCACT,WAAW;wCACX,YAAY;4CAAE,MAAM;wCAAO;oCAC7B;oCACA,WAAW;wCACT,QAAQ;wCACR,MAAM,SAAS,IAAI,CAAC,IAAI;oCAC1B;gCACF,GAAG,OAAO;oCAAE,OAAO;gCAAa;gCAEhC,OAAO,WAAW,QAAQ,MAAM,SAAS;4BAC3C;wBACA;4BACE,MAAM,IAAI,UAAU,CAAC,UAAU,EAAE,KAAK,6BAA6B,CAAC;oBACxE;gBACF;gBAEA,IAAI,IAAI,CAAC,iBAAiB,KAAK,MAAM;oBACnC,IAAI,SAAS,QAAQ;wBACnB,MAAM,IAAI,UAAU,CAAC,UAAU,EAAE,KAAK,6BAA6B,CAAC;oBACtE;oBAEA,IAAI,WAAW,OAAO;wBACpB,OAAO,IAAI,CAAC,IAAI;oBAClB;oBAEA,OAAO,SAAS,IAAI,CAAC,IAAI;gBAC3B;YACF;YAEA,IAAI,IAAI,CAAC,KAAK,KAAK,WAAW;gBAC5B,IAAI,eAAe,aAAa,WAAW,WAAW;oBACpD,MAAM,IAAI,OAAO,gBAAgB,CAAC;gBACpC;gBAEA,IAAI,SAAS,SAAS;oBACpB,IAAI,IAAI,CAAC,MAAM,EAAE;wBACf,IAAI,WAAW,SAAS,OAAO,IAAI,CAAC,MAAM,KAAK,UAAU;4BACvD,OAAO,SAAS,IAAI,CAAC,MAAM;wBAC7B;wBAEA,IAAI,WAAW,SAAS,OAAO,QAAQ,CAAC,IAAI,CAAC,MAAM,GAAG;4BACpD,OAAO,SAAS,IAAI,CAAC,MAAM,EAAE;wBAC/B;wBAEA,OAAO,IAAI,CAAC,MAAM;oBACpB;oBAEA,IAAI,IAAI,CAAC,iBAAiB,KAAK,OAAO;wBACpC,MAAM,SAAS,IAAI,CAAC,KAAK;wBACzB,MAAM,gBAAgB,KAAK,GAAG,CAAC;wBAC/B,MAAM,aAAa,cAAc,MAAM,CAAC;wBACxC,MAAM,iBAAiB,KAAK,GAAG,CAAC;wBAChC,MAAM,QAAQ,eAAe,MAAM,CAAC;4BAClC,SAAS;4BACT;4BACA,WAAW;gCACT,WAAW;gCACX,YAAY;oCAAE,MAAM;gCAAO;4BAC7B;wBACF;wBAEA,IAAI,CAAC,MAAM,GAAG;wBAEd,OAAO,IAAI,CAAC,MAAM,CAAC;4BAAE;4BAAM;wBAAO;oBACpC;oBAEA,IAAI,IAAI,CAAC,iBAAiB,KAAK,MAAM;wBACnC,MAAM,SAAS,IAAI,CAAC,KAAK;wBACzB,MAAM,eAAe,KAAK,GAAG,CAAC;wBAC9B,MAAM,aAAa,aAAa,MAAM,CAAC;4BACrC,SAAS,OAAO,OAAO;4BACvB,YAAY,OAAO,UAAU;4BAC7B,WAAW,OAAO,SAAS;wBAC7B;wBACA,MAAM,iBAAiB,KAAK,GAAG,CAAC;wBAChC,MAAM,QAAQ,eAAe,MAAM,CAAC;4BAClC,SAAS;4BACT;4BACA,WAAW;gCACT,WAAW;gCACX,YAAY,IAAI,CAAC,KAAK,CAAC,UAAU;4BACnC;wBACF;wBAEA,IAAI,CAAC,MAAM,GAAG;wBAEd,OAAO,IAAI,CAAC,MAAM,CAAC;4BAAE;4BAAM;wBAAO;oBACpC;gBACF;gBAEA,IAAI,IAAI,CAAC,iBAAiB,KAAK,SAAS,SAAS,SAAS;oBACxD,IAAI,WAAW,OAAO;wBACpB,OAAO,IAAI,CAAC,IAAI;oBAClB;oBAEA,OAAO,SAAS,IAAI,CAAC,IAAI;gBAC3B,OAAO,IAAI,IAAI,CAAC,iBAAiB,KAAK,QAAQ,SAAS,QAAQ;oBAC7D,IAAI,WAAW,OAAO;wBACpB,OAAO,IAAI,CAAC,IAAI;oBAClB;oBAEA,OAAO,SAAS,IAAI,CAAC,IAAI;gBAC3B,OAAO;oBACL,MAAM,IAAI,UAAU,CAAC,UAAU,EAAE,KAAK,6BAA6B,CAAC;gBACtE;YACF;QACF;QAEA,IAAI,OAAQ;YACV,OAAO,IAAI,CAAC,KAAK;QACnB;QAEA,IAAI,oBAAqB;YACvB,OAAO,IAAI,CAAC,kBAAkB;QAChC;QAEA,IAAI,mBAAoB;YACtB,OAAO,IAAI,CAAC,iBAAiB;QAC/B;QAEA,CAAC,QAAQ,CAAE,WAAW,EAAE;YACtB,OAAQ,IAAI,CAAC,KAAK;gBAChB,KAAK;oBACH,OAAO,IAAI,CAAC,OAAO;gBACrB,KAAK;oBACH,OAAO,IAAI,CAAC,IAAI;gBAClB;oBACE,IAAI,aAAa;wBACf,IAAI,CAAC,CAAC,UAAU,IAAI,GAAG;4BACrB,IAAI,CAAC,IAAI,GAAG,gBAAgB,IAAI;wBAClC;wBAEA,OAAO,IAAI,CAAC,IAAI,CAAC,QAAQ,CAAC;oBAC5B;oBAEA,OAAO,IAAI,CAAC,IAAI;YACpB;QACF;IACF;IAEA,kBAAkB,CAAC;QACjB,IAAI,CAAC,OAAO,QAAQ,CAAC,WAAW,CAAC,OAAO,MAAM,EAAE;YAC9C,MAAM,IAAI,UAAU;QACtB;QAEA,MAAM,YAAY,IAAI;QACtB,UAAU,OAAO,GAAG,OAAO,IAAI,CAAC;QAChC,UAAU,iBAAiB,GAAG,OAAO,MAAM;QAC3C,UAAU,KAAK,GAAG;QAElB,OAAO;IACT;IAEA,kBAAkB,CAAC;QACjB,IAAI,iBAAiB,WAAW;YAC9B,IAAI,MAAM,IAAI,KAAK,WAAW;gBAC5B,MAAM,IAAI,UAAU,CAAC,wBAAwB,EAAE,MAAM,IAAI,CAAC,mBAAmB,CAAC;YAChF;YAEA,OAAQ,MAAM,iBAAiB;gBAC7B,KAAK;oBAAM;wBACT,MAAM,gBAAgB,KAAK,GAAG,CAAC;wBAC/B,MAAM,MAAM,cAAc,MAAM,CAAC;4BAC/B,WAAW;gCACT,WAAW;gCACX,YAAY,MAAM,KAAK,CAAC,UAAU;4BACpC;4BACA,WAAW,MAAM,KAAK,CAAC,SAAS;wBAClC;wBAEA,OAAO,gBAAgB;4BAAE;4BAAK,QAAQ;4BAAO,MAAM;wBAAO;oBAC5D;gBACA,KAAK;oBAAO;wBACV,MAAM,eAAe,KAAK,GAAG,CAAC;wBAC9B,MAAM,MAAM,aAAa,MAAM,CAAC,MAAM,KAAK;wBAC3C,OAAO,gBAAgB;4BAAE;4BAAK,QAAQ;4BAAO,MAAM;wBAAQ;oBAC7D;YACF;QACF;QAEA,IAAI,OAAO,UAAU,YAAY,OAAO,QAAQ,CAAC,QAAQ;YACvD,QAAQ;gBAAE,KAAK;gBAAO,QAAQ;YAAM;QACtC;QAEA,IAAI,CAAC,SAAS,QAAQ;YACpB,MAAM,IAAI,UAAU;QACtB;QAEA,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,GAAG;QAC/B,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG;QAEpB,IAAI,OAAO,QAAQ,YAAY,CAAC,OAAO,QAAQ,CAAC,MAAM;YACpD,MAAM,IAAI,UAAU;QACtB;QAEA,IAAI,WAAW,SAAS,WAAW,OAAO;YACxC,MAAM,IAAI,UAAU;QACtB;QAEA,IAAI;QACJ,IAAI,WAAW,OAAO;YACpB,MAAM,IAAI,QAAQ;YAClB,OAAQ,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ;gBACrC,KAAK;oBACH,OAAO;oBACP,QAAQ;oBACR;gBACF,KAAK;oBACH,OAAO;oBACP,QAAQ;oBACR;gBACF,KAAK;oBACH,MAAM,IAAI,OAAO,gBAAgB,CAAC;gBACpC,KAAK;gBACL,KAAK;gBACL,KAAK;oBACH,OAAO,gBAAgB,iBAAiB;gBAC1C;oBACE,MAAM,IAAI,UAAU;YACxB;QACF;QAEA,OAAQ;YACN,KAAK;gBAAQ;oBACX,MAAM,gBAAgB,KAAK,GAAG,CAAC;oBAC/B,MAAM,SAAS,cAAc,MAAM,CAAC,KAAK,QAAQ;wBAAE;oBAAM;oBAEzD,IAAI,MAAM;oBACV,OAAQ,OAAO,SAAS,CAAC,SAAS;wBAChC,KAAK;4BAAe;gCAClB,YAAY,IAAI;gCAChB,UAAU,KAAK,GAAG;gCAClB,UAAU,kBAAkB,GAAG;gCAC/B,UAAU,KAAK,GAAG;gCAClB,UAAU,IAAI,GAAG,cAAc,MAAM,CAAC,QAAQ,OAAO;oCAAE,OAAO;gCAAa;gCAE3E;4BACF;wBACA,KAAK;4BAAiB;gCACpB,OAAO;gCACP,YAAY,gBAAgB;oCAAE;oCAAM,KAAK,OAAO,SAAS,CAAC,IAAI;oCAAE,QAAQ;gCAAM;gCAC9E;4BACF;wBACA;4BACE,YAAY,OAAO,SAAS,CAAC,SAAS;oBAC1C;oBAEA,OAAO;gBACT;YACA,KAAK;gBAAS;oBACZ,MAAM,eAAe,KAAK,GAAG,CAAC;oBAC9B,MAAM,SAAS,aAAa,MAAM,CAAC,KAAK,QAAQ;wBAAE;oBAAM;oBAExD,yEAAyE;oBACzE,IAAI,OAAO,CAAC,KAAK,OAAO,IAAI;wBAC1B,OAAO,gBAAgB,iBAAiB;4BAAE;4BAAK;4BAAQ;4BAAM;wBAAW;oBAC1E;oBAEA,MAAM,YAAY,IAAI;oBACtB,UAAU,KAAK,GAAG;oBAClB,UAAU,kBAAkB,GAAG;oBAC/B,UAAU,KAAK,GAAG;oBAClB,UAAU,IAAI,GAAG,aAAa,MAAM,CAAC,QAAQ,OAAO;wBAAE,OAAO;oBAAiB;oBAE9E,OAAO;gBACT;YACA,KAAK;YACL,KAAK;gBACH,OAAO,gBAAgB,iBAAiB;oBAAE;oBAAQ;oBAAK;oBAAM;gBAAW;YAC1E;gBACE,MAAM,IAAI,UAAU,CAAC,UAAU,EAAE,KAAK,6BAA6B,CAAC;QACxE;IACF;IAEA,mBAAmB,CAAC,OAAO;QACzB,IAAI,OAAO,UAAU,YAAY,OAAO,QAAQ,CAAC,QAAQ;YACvD,QAAQ;gBAAE,KAAK;gBAAO,QAAQ;YAAM;QACtC;QAEA,IAAI,CAAC,SAAS,QAAQ;YACpB,MAAM,IAAI,UAAU;QACtB;QAEA,MAAM,EAAE,MAAM,EAAE,UAAU,EAAE,GAAG;QAC/B,IAAI,EAAE,GAAG,EAAE,IAAI,EAAE,GAAG;QAEpB,IAAI,OAAO,QAAQ,YAAY,CAAC,OAAO,QAAQ,CAAC,MAAM;YACpD,MAAM,IAAI,UAAU;QACtB;QAEA,IAAI,eAAe,WAAW;YAC5B,MAAM,IAAI,OAAO,gBAAgB,CAAC;QACpC;QAEA,IAAI,WAAW,SAAS,WAAW,OAAO;YACxC,MAAM,IAAI,UAAU;QACtB;QAEA,IAAI;QACJ,IAAI,WAAW,OAAO;YACpB,MAAM,IAAI,QAAQ;YAClB,OAAQ,IAAI,KAAK,CAAC,SAAS,CAAC,EAAE,CAAC,QAAQ;gBACrC,KAAK;oBACH,OAAO;oBACP,QAAQ;oBACR;gBACF,KAAK;oBACH,OAAO;oBACP,QAAQ;oBACR;gBACF,KAAK;oBACH,OAAO;oBACP,QAAQ;oBACR;gBACF;oBACE,MAAM,IAAI,UAAU;YACxB;QACF;QAEA,OAAQ;YACN,KAAK;gBAAS;oBACZ,MAAM,iBAAiB,KAAK,GAAG,CAAC;oBAChC,MAAM,SAAS,eAAe,MAAM,CAAC,KAAK,QAAQ;wBAAE;oBAAM;oBAE1D,IAAI,MAAM;oBACV,OAAQ,OAAO,SAAS,CAAC,SAAS;wBAChC,KAAK;4BAAe;gCAClB,OAAO;gCACP,YAAY,iBAAiB;oCAAE;oCAAM,KAAK,OAAO,UAAU;oCAAE,QAAQ;gCAAM,GAAG;oCAAE,CAAC,WAAW,EAAE,OAAO,SAAS,CAAC,UAAU,CAAC,KAAK;gCAAC;gCAChI;4BACF;wBACA,KAAK;4BAAiB;gCACpB,OAAO;gCACP,YAAY,iBAAiB;oCAAE;oCAAM,KAAK,OAAO,UAAU;oCAAE,QAAQ;gCAAM;gCAC3E;4BACF;wBACA;4BACE,YAAY,OAAO,SAAS,CAAC,SAAS;oBAC1C;oBAEA,UAAU,MAAM,GAAG;oBACnB,OAAO;gBACT;YACA,KAAK;gBAAS;oBACZ,MAAM,gBAAgB,KAAK,GAAG,CAAC;oBAC/B,MAAM,SAAS,cAAc,MAAM,CAAC,KAAK,QAAQ;wBAAE;oBAAM;oBAEzD,MAAM,YAAY,IAAI;oBACtB,UAAU,KAAK,GAAG;oBAClB,UAAU,kBAAkB,GAAG;oBAC/B,UAAU,KAAK,GAAG;oBAClB,UAAU,IAAI,GAAG,cAAc,MAAM,CAAC,QAAQ,OAAO;wBAAE,OAAO;oBAAkB;oBAEhF,OAAO;gBACT;YACA,KAAK;gBAAQ;oBACX,MAAM,eAAe,KAAK,GAAG,CAAC;oBAC9B,IAAI,SAAS,aAAa,MAAM,CAAC,KAAK,QAAQ;wBAAE;oBAAM;oBAEtD,IAAI,CAAC,CAAC,gBAAgB,MAAM,KAAK,CAAC,KAAK,CAAC,WAAW,EAAE;wBACnD,MAAM,IAAI,MAAM;oBAClB,OAAO,IAAI,CAAC,CAAC,gBAAgB,MAAM,GAAG;wBACpC,SAAS;4BAAE,GAAG,MAAM;4BAAE,YAAY;gCAAE,MAAM;gCAAc,OAAO,KAAK,CAAC,WAAW;4BAAC;wBAAE;oBACrF;oBAEA,MAAM,YAAY,IAAI;oBACtB,UAAU,KAAK,GAAG;oBAClB,UAAU,kBAAkB,GAAG;oBAC/B,UAAU,KAAK,GAAG;oBAClB,UAAU,IAAI,GAAG,aAAa,MAAM,CAAC,QAAQ,OAAO;wBAAE,OAAO;oBAAiB;oBAE9E,OAAO;gBACT;YACA;gBACE,MAAM,IAAI,UAAU,CAAC,UAAU,EAAE,KAAK,6BAA6B,CAAC;QACxE;IACF;AACF;AAEA,OAAO,OAAO,GAAG;IAAE;IAAiB;IAAkB;IAAiB;IAAW;AAAQ","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 994, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/rsa_primes.js"],"sourcesContent":["const { randomBytes } = require('crypto')\n\nconst base64url = require('./base64url')\nconst errors = require('../errors')\n\nconst ZERO = BigInt(0)\nconst ONE = BigInt(1)\nconst TWO = BigInt(2)\n\nconst toJWKParameter = (n) => {\n  const hex = n.toString(16)\n  return base64url.encodeBuffer(Buffer.from(hex.length % 2 ? `0${hex}` : hex, 'hex'))\n}\nconst fromBuffer = buf => BigInt(`0x${buf.toString('hex')}`)\nconst bitLength = n => n.toString(2).length\n\nconst eGcdX = (a, b) => {\n  let x = ZERO\n  let y = ONE\n  let u = ONE\n  let v = ZERO\n\n  while (a !== ZERO) {\n    const q = b / a\n    const r = b % a\n    const m = x - (u * q)\n    const n = y - (v * q)\n    b = a\n    a = r\n    x = u\n    y = v\n    u = m\n    v = n\n  }\n  return x\n}\n\nconst gcd = (a, b) => {\n  let shift = ZERO\n  while (!((a | b) & ONE)) {\n    a >>= ONE\n    b >>= ONE\n    shift++\n  }\n  while (!(a & ONE)) {\n    a >>= ONE\n  }\n  do {\n    while (!(b & ONE)) {\n      b >>= ONE\n    }\n    if (a > b) {\n      const x = a\n      a = b\n      b = x\n    }\n    b -= a\n  } while (b)\n\n  return a << shift\n}\n\nconst modPow = (a, b, n) => {\n  a = toZn(a, n)\n  let result = ONE\n  let x = a\n  while (b > 0) {\n    const leastSignificantBit = b % TWO\n    b = b / TWO\n    if (leastSignificantBit === ONE) {\n      result = result * x\n      result = result % n\n    }\n    x = x * x\n    x = x % n\n  }\n  return result\n}\n\nconst randBetween = (min, max) => {\n  const interval = max - min\n  const bitLen = bitLength(interval)\n  let rnd\n  do {\n    rnd = fromBuffer(randBits(bitLen))\n  } while (rnd > interval)\n  return rnd + min\n}\n\nconst randBits = (bitLength) => {\n  const byteLength = Math.ceil(bitLength / 8)\n  const rndBytes = randomBytes(byteLength)\n  // Fill with 0's the extra bits\n  rndBytes[0] = rndBytes[0] & (2 ** (bitLength % 8) - 1)\n  return rndBytes\n}\n\nconst toZn = (a, n) => {\n  a = a % n\n  return (a < 0) ? a + n : a\n}\n\nconst odd = (n) => {\n  let r = n\n  while (r % TWO === ZERO) {\n    r = r / TWO\n  }\n  return r\n}\n\n// not sold on these values\nconst maxCountWhileNoY = 30\nconst maxCountWhileInot0 = 22\n\nconst getPrimeFactors = (e, d, n) => {\n  const r = odd(e * d - ONE)\n\n  let countWhileNoY = 0\n  let y\n  do {\n    countWhileNoY++\n    if (countWhileNoY === maxCountWhileNoY) {\n      throw new errors.JWKImportFailed('failed to calculate missing primes')\n    }\n\n    let countWhileInot0 = 0\n    let i = modPow(randBetween(TWO, n), r, n)\n    let o = ZERO\n    while (i !== ONE) {\n      countWhileInot0++\n      if (countWhileInot0 === maxCountWhileInot0) {\n        throw new errors.JWKImportFailed('failed to calculate missing primes')\n      }\n      o = i\n      i = (i * i) % n\n    }\n    if (o !== (n - ONE)) {\n      y = o\n    }\n  } while (!y)\n\n  const p = gcd(y - ONE, n)\n  const q = n / p\n\n  return p > q ? { p, q } : { p: q, q: p }\n}\n\nmodule.exports = (jwk) => {\n  const e = fromBuffer(base64url.decodeToBuffer(jwk.e))\n  const d = fromBuffer(base64url.decodeToBuffer(jwk.d))\n  const n = fromBuffer(base64url.decodeToBuffer(jwk.n))\n\n  if (d >= n) {\n    throw new errors.JWKInvalid('invalid RSA private exponent')\n  }\n\n  const { p, q } = getPrimeFactors(e, d, n)\n  const dp = d % (p - ONE)\n  const dq = d % (q - ONE)\n  const qi = toZn(eGcdX(toZn(q, p), p), p)\n\n  return {\n    ...jwk,\n    p: toJWKParameter(p),\n    q: toJWKParameter(q),\n    dp: toJWKParameter(dp),\n    dq: toJWKParameter(dq),\n    qi: toJWKParameter(qi)\n  }\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1153, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/key_utils.js"],"sourcesContent":["const { EOL } = require('os')\n\nconst errors = require('../errors')\n\nconst { keyObjectSupported } = require('./runtime_support')\nconst { createPublicKey } = require('./key_object')\nconst base64url = require('./base64url')\nconst asn1 = require('./asn1')\nconst computePrimes = require('./rsa_primes')\nconst { OKP_CURVES, EC_CURVES } = require('../registry')\n\nconst formatPem = (base64pem, descriptor) => `-----BEGIN ${descriptor} KEY-----${EOL}${(base64pem.match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END ${descriptor} KEY-----`\n\nconst okpToJWK = {\n  private (crv, keyObject) {\n    const der = keyObject.export({ type: 'pkcs8', format: 'der' })\n    const OneAsymmetricKey = asn1.get('OneAsymmetricKey')\n    const { privateKey: { privateKey: d } } = OneAsymmetricKey.decode(der)\n\n    return {\n      ...okpToJWK.public(crv, createPublicKey(keyObject)),\n      d: base64url.encodeBuffer(d)\n    }\n  },\n  public (crv, keyObject) {\n    const der = keyObject.export({ type: 'spki', format: 'der' })\n\n    const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n    const { publicKey: { data: x } } = PublicKeyInfo.decode(der)\n\n    return {\n      kty: 'OKP',\n      crv,\n      x: base64url.encodeBuffer(x)\n    }\n  }\n}\n\nconst keyObjectToJWK = {\n  rsa: {\n    private (keyObject) {\n      const der = keyObject.export({ type: 'pkcs8', format: 'der' })\n\n      const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n      const RSAPrivateKey = asn1.get('RSAPrivateKey')\n\n      const { privateKey } = PrivateKeyInfo.decode(der)\n      const { version, n, e, d, p, q, dp, dq, qi } = RSAPrivateKey.decode(privateKey)\n\n      if (version !== 'two-prime') {\n        throw new errors.JOSENotSupported('Private RSA keys with more than two primes are not supported')\n      }\n\n      return {\n        kty: 'RSA',\n        n: base64url.encodeBigInt(n),\n        e: base64url.encodeBigInt(e),\n        d: base64url.encodeBigInt(d),\n        p: base64url.encodeBigInt(p),\n        q: base64url.encodeBigInt(q),\n        dp: base64url.encodeBigInt(dp),\n        dq: base64url.encodeBigInt(dq),\n        qi: base64url.encodeBigInt(qi)\n      }\n    },\n    public (keyObject) {\n      const der = keyObject.export({ type: 'spki', format: 'der' })\n\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n      const RSAPublicKey = asn1.get('RSAPublicKey')\n\n      const { publicKey: { data: publicKey } } = PublicKeyInfo.decode(der)\n      const { n, e } = RSAPublicKey.decode(publicKey)\n\n      return {\n        kty: 'RSA',\n        n: base64url.encodeBigInt(n),\n        e: base64url.encodeBigInt(e)\n      }\n    }\n  },\n  ec: {\n    private (keyObject) {\n      const der = keyObject.export({ type: 'pkcs8', format: 'der' })\n\n      const PrivateKeyInfo = asn1.get('PrivateKeyInfo')\n      const ECPrivateKey = asn1.get('ECPrivateKey')\n\n      const { privateKey, algorithm: { parameters: { value: crv } } } = PrivateKeyInfo.decode(der)\n      const { privateKey: d, publicKey } = ECPrivateKey.decode(privateKey)\n\n      if (typeof publicKey === 'undefined') {\n        if (keyObjectSupported) {\n          return {\n            ...keyObjectToJWK.ec.public(createPublicKey(keyObject)),\n            d: base64url.encodeBuffer(d)\n          }\n        }\n\n        throw new errors.JOSENotSupported('Private EC keys without the public key embedded are not supported in your Node.js runtime version')\n      }\n\n      const x = publicKey.data.slice(1, ((publicKey.data.length - 1) / 2) + 1)\n      const y = publicKey.data.slice(((publicKey.data.length - 1) / 2) + 1)\n\n      return {\n        kty: 'EC',\n        crv,\n        d: base64url.encodeBuffer(d),\n        x: base64url.encodeBuffer(x),\n        y: base64url.encodeBuffer(y)\n      }\n    },\n    public (keyObject) {\n      const der = keyObject.export({ type: 'spki', format: 'der' })\n\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n      const { publicKey: { data: publicKey }, algorithm: { parameters: { value: crv } } } = PublicKeyInfo.decode(der)\n\n      const x = publicKey.slice(1, ((publicKey.length - 1) / 2) + 1)\n      const y = publicKey.slice(((publicKey.length - 1) / 2) + 1)\n\n      return {\n        kty: 'EC',\n        crv,\n        x: base64url.encodeBuffer(x),\n        y: base64url.encodeBuffer(y)\n      }\n    }\n  },\n  ed25519: {\n    private (keyObject) {\n      return okpToJWK.private('Ed25519', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('Ed25519', keyObject)\n    }\n  },\n  ed448: {\n    private (keyObject) {\n      return okpToJWK.private('Ed448', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('Ed448', keyObject)\n    }\n  },\n  x25519: {\n    private (keyObject) {\n      return okpToJWK.private('X25519', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('X25519', keyObject)\n    }\n  },\n  x448: {\n    private (keyObject) {\n      return okpToJWK.private('X448', keyObject)\n    },\n    public (keyObject) {\n      return okpToJWK.public('X448', keyObject)\n    }\n  }\n}\n\nmodule.exports.keyObjectToJWK = (keyObject) => {\n  if (keyObject.type === 'private') {\n    return keyObjectToJWK[keyObject.asymmetricKeyType].private(keyObject)\n  }\n\n  return keyObjectToJWK[keyObject.asymmetricKeyType].public(keyObject)\n}\n\nconst concatEcPublicKey = (x, y) => ({\n  unused: 0,\n  data: Buffer.concat([\n    Buffer.alloc(1, 4),\n    base64url.decodeToBuffer(x),\n    base64url.decodeToBuffer(y)\n  ])\n})\n\nconst jwkToPem = {\n  RSA: {\n    private (jwk, { calculateMissingRSAPrimes }) {\n      const RSAPrivateKey = asn1.get('RSAPrivateKey')\n\n      if ('oth' in jwk) {\n        throw new errors.JOSENotSupported('Private RSA keys with more than two primes are not supported')\n      }\n\n      if (jwk.p || jwk.q || jwk.dp || jwk.dq || jwk.qi) {\n        if (!(jwk.p && jwk.q && jwk.dp && jwk.dq && jwk.qi)) {\n          throw new errors.JWKInvalid('all other private key parameters must be present when any one of them is present')\n        }\n      } else if (calculateMissingRSAPrimes) {\n        jwk = computePrimes(jwk)\n      } else if (!calculateMissingRSAPrimes) {\n        throw new errors.JOSENotSupported('importing private RSA keys without all other private key parameters is not enabled, see documentation and its advisory on how and when its ok to enable it')\n      }\n\n      return RSAPrivateKey.encode({\n        version: 0,\n        n: BigInt(`0x${base64url.decodeToBuffer(jwk.n).toString('hex')}`),\n        e: BigInt(`0x${base64url.decodeToBuffer(jwk.e).toString('hex')}`),\n        d: BigInt(`0x${base64url.decodeToBuffer(jwk.d).toString('hex')}`),\n        p: BigInt(`0x${base64url.decodeToBuffer(jwk.p).toString('hex')}`),\n        q: BigInt(`0x${base64url.decodeToBuffer(jwk.q).toString('hex')}`),\n        dp: BigInt(`0x${base64url.decodeToBuffer(jwk.dp).toString('hex')}`),\n        dq: BigInt(`0x${base64url.decodeToBuffer(jwk.dq).toString('hex')}`),\n        qi: BigInt(`0x${base64url.decodeToBuffer(jwk.qi).toString('hex')}`)\n      }, 'pem', { label: 'RSA PRIVATE KEY' })\n    },\n    public (jwk) {\n      const RSAPublicKey = asn1.get('RSAPublicKey')\n\n      return RSAPublicKey.encode({\n        version: 0,\n        n: BigInt(`0x${base64url.decodeToBuffer(jwk.n).toString('hex')}`),\n        e: BigInt(`0x${base64url.decodeToBuffer(jwk.e).toString('hex')}`)\n      }, 'pem', { label: 'RSA PUBLIC KEY' })\n    }\n  },\n  EC: {\n    private (jwk) {\n      const ECPrivateKey = asn1.get('ECPrivateKey')\n\n      return ECPrivateKey.encode({\n        version: 1,\n        privateKey: base64url.decodeToBuffer(jwk.d),\n        parameters: { type: 'namedCurve', value: jwk.crv },\n        publicKey: concatEcPublicKey(jwk.x, jwk.y)\n      }, 'pem', { label: 'EC PRIVATE KEY' })\n    },\n    public (jwk) {\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n      return PublicKeyInfo.encode({\n        algorithm: {\n          algorithm: 'ecPublicKey',\n          parameters: { type: 'namedCurve', value: jwk.crv }\n        },\n        publicKey: concatEcPublicKey(jwk.x, jwk.y)\n      }, 'pem', { label: 'PUBLIC KEY' })\n    }\n  },\n  OKP: {\n    private (jwk) {\n      const OneAsymmetricKey = asn1.get('OneAsymmetricKey')\n\n      const b64 = OneAsymmetricKey.encode({\n        version: 0,\n        privateKey: { privateKey: base64url.decodeToBuffer(jwk.d) },\n        algorithm: { algorithm: jwk.crv }\n      }, 'der')\n\n      // TODO: WHYYY? https://github.com/indutny/asn1.js/issues/110\n      b64.write('04', 12, 1, 'hex')\n\n      return formatPem(b64.toString('base64'), 'PRIVATE')\n    },\n    public (jwk) {\n      const PublicKeyInfo = asn1.get('PublicKeyInfo')\n\n      return PublicKeyInfo.encode({\n        algorithm: { algorithm: jwk.crv },\n        publicKey: {\n          unused: 0,\n          data: base64url.decodeToBuffer(jwk.x)\n        }\n      }, 'pem', { label: 'PUBLIC KEY' })\n    }\n  }\n}\n\nmodule.exports.jwkToPem = (jwk, { calculateMissingRSAPrimes = false } = {}) => {\n  switch (jwk.kty) {\n    case 'EC':\n      if (!EC_CURVES.has(jwk.crv)) {\n        throw new errors.JOSENotSupported(`unsupported EC key curve: ${jwk.crv}`)\n      }\n      break\n    case 'OKP':\n      if (!OKP_CURVES.has(jwk.crv)) {\n        throw new errors.JOSENotSupported(`unsupported OKP key curve: ${jwk.crv}`)\n      }\n      break\n    case 'RSA':\n      break\n    default:\n      throw new errors.JOSENotSupported(`unsupported key type: ${jwk.kty}`)\n  }\n\n  if (jwk.d) {\n    return jwkToPem[jwk.kty].private(jwk, { calculateMissingRSAPrimes })\n  }\n\n  return jwkToPem[jwk.kty].public(jwk)\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1457, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/thumbprint.js"],"sourcesContent":["const { createHash } = require('crypto')\n\nconst base64url = require('../help/base64url')\n\nconst x5t = (hash, cert) => base64url.encodeBuffer(createHash(hash).update(Buffer.from(cert, 'base64')).digest())\n\nmodule.exports.kid = components => base64url.encodeBuffer(createHash('sha256').update(JSON.stringify(components)).digest())\nmodule.exports.x5t = x5t.bind(undefined, 'sha1')\nmodule.exports['x5t#S256'] = x5t.bind(undefined, 'sha256')\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE;AAEpB,MAAM;AAEN,MAAM,MAAM,CAAC,MAAM,OAAS,UAAU,YAAY,CAAC,WAAW,MAAM,MAAM,CAAC,OAAO,IAAI,CAAC,MAAM,WAAW,MAAM;AAE9G,OAAO,OAAO,CAAC,GAAG,GAAG,CAAA,aAAc,UAAU,YAAY,CAAC,WAAW,UAAU,MAAM,CAAC,KAAK,SAAS,CAAC,aAAa,MAAM;AACxH,OAAO,OAAO,CAAC,GAAG,GAAG,IAAI,IAAI,CAAC,WAAW;AACzC,OAAO,OAAO,CAAC,WAAW,GAAG,IAAI,IAAI,CAAC,WAAW","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1468, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/base.js"],"sourcesContent":["const { strict: assert } = require('assert')\nconst { inspect } = require('util')\nconst { EOL } = require('os')\n\nconst { keyObjectSupported } = require('../../help/runtime_support')\nconst { createPublicKey } = require('../../help/key_object')\nconst { keyObjectToJWK } = require('../../help/key_utils')\nconst {\n  THUMBPRINT_MATERIAL, PUBLIC_MEMBERS, PRIVATE_MEMBERS, JWK_MEMBERS, KEYOBJECT,\n  USES_MAPPING, OPS, USES\n} = require('../../help/consts')\nconst isObject = require('../../help/is_object')\nconst thumbprint = require('../thumbprint')\nconst errors = require('../../errors')\n\nconst privateApi = Symbol('privateApi')\nconst { JWK } = require('../../registry')\n\nclass Key {\n  constructor (keyObject, { alg, use, kid, key_ops: ops, x5c, x5t, 'x5t#S256': x5t256 } = {}) {\n    if (use !== undefined) {\n      if (typeof use !== 'string' || !USES.has(use)) {\n        throw new TypeError('`use` must be either \"sig\" or \"enc\" string when provided')\n      }\n    }\n\n    if (alg !== undefined) {\n      if (typeof alg !== 'string' || !alg) {\n        throw new TypeError('`alg` must be a non-empty string when provided')\n      }\n    }\n\n    if (kid !== undefined) {\n      if (typeof kid !== 'string' || !kid) {\n        throw new TypeError('`kid` must be a non-empty string when provided')\n      }\n    }\n\n    if (ops !== undefined) {\n      if (!Array.isArray(ops) || !ops.length || ops.some(o => typeof o !== 'string')) {\n        throw new TypeError('`key_ops` must be a non-empty array of strings when provided')\n      }\n      ops = Array.from(new Set(ops)).filter(x => OPS.has(x))\n    }\n\n    if (ops && use) {\n      if (\n        (use === 'enc' && ops.some(x => USES_MAPPING.sig.has(x))) ||\n        (use === 'sig' && ops.some(x => USES_MAPPING.enc.has(x)))\n      ) {\n        throw new errors.JWKInvalid('inconsistent JWK \"use\" and \"key_ops\"')\n      }\n    }\n\n    if (keyObjectSupported && x5c !== undefined) {\n      if (!Array.isArray(x5c) || !x5c.length || x5c.some(c => typeof c !== 'string')) {\n        throw new TypeError('`x5c` must be an array of one or more PKIX certificates when provided')\n      }\n\n      x5c.forEach((cert, i) => {\n        let publicKey\n        try {\n          publicKey = createPublicKey({\n            key: `-----BEGIN CERTIFICATE-----${EOL}${(cert.match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END CERTIFICATE-----`, format: 'pem'\n          })\n        } catch (err) {\n          throw new errors.JWKInvalid(`\\`x5c\\` member at index ${i} is not a valid base64-encoded DER PKIX certificate`)\n        }\n        if (i === 0) {\n          try {\n            assert.deepEqual(\n              publicKey.export({ type: 'spki', format: 'der' }),\n              (keyObject.type === 'public' ? keyObject : createPublicKey(keyObject)).export({ type: 'spki', format: 'der' })\n            )\n          } catch (err) {\n            throw new errors.JWKInvalid('The key in the first `x5c` certificate MUST match the public key represented by the JWK')\n          }\n        }\n      })\n    }\n\n    Object.defineProperties(this, {\n      [KEYOBJECT]: { value: isObject(keyObject) ? undefined : keyObject },\n      keyObject: {\n        get () {\n          if (!keyObjectSupported) {\n            throw new errors.JOSENotSupported('KeyObject class is not supported in your Node.js runtime version')\n          }\n\n          return this[KEYOBJECT]\n        }\n      },\n      type: { value: keyObject.type },\n      private: { value: keyObject.type === 'private' },\n      public: { value: keyObject.type === 'public' },\n      secret: { value: keyObject.type === 'secret' },\n      alg: { value: alg, enumerable: alg !== undefined },\n      use: { value: use, enumerable: use !== undefined },\n      x5c: {\n        enumerable: x5c !== undefined,\n        ...(x5c ? { get () { return [...x5c] } } : { value: undefined })\n      },\n      key_ops: {\n        enumerable: ops !== undefined,\n        ...(ops ? { get () { return [...ops] } } : { value: undefined })\n      },\n      kid: {\n        enumerable: true,\n        ...(kid\n          ? { value: kid }\n          : {\n              get () {\n                Object.defineProperty(this, 'kid', { value: this.thumbprint, configurable: false })\n                return this.kid\n              },\n              configurable: true\n            })\n      },\n      ...(x5c\n        ? {\n            x5t: {\n              enumerable: true,\n              ...(x5t\n                ? { value: x5t }\n                : {\n                    get () {\n                      Object.defineProperty(this, 'x5t', { value: thumbprint.x5t(this.x5c[0]), configurable: false })\n                      return this.x5t\n                    },\n                    configurable: true\n                  })\n            }\n          }\n        : undefined),\n      ...(x5c\n        ? {\n            'x5t#S256': {\n              enumerable: true,\n              ...(x5t256\n                ? { value: x5t256 }\n                : {\n                    get () {\n                      Object.defineProperty(this, 'x5t#S256', { value: thumbprint['x5t#S256'](this.x5c[0]), configurable: false })\n                      return this['x5t#S256']\n                    },\n                    configurable: true\n                  })\n            }\n          }\n        : undefined),\n      thumbprint: {\n        get () {\n          Object.defineProperty(this, 'thumbprint', { value: thumbprint.kid(this[THUMBPRINT_MATERIAL]()), configurable: false })\n          return this.thumbprint\n        },\n        configurable: true\n      }\n    })\n  }\n\n  toPEM (priv = false, encoding = {}) {\n    if (this.secret) {\n      throw new TypeError('symmetric keys cannot be exported as PEM')\n    }\n\n    if (priv && this.public === true) {\n      throw new TypeError('public key cannot be exported as private')\n    }\n\n    const { type = priv ? 'pkcs8' : 'spki', cipher, passphrase } = encoding\n\n    let keyObject = this[KEYOBJECT]\n\n    if (!priv) {\n      if (this.private) {\n        keyObject = createPublicKey(keyObject)\n      }\n      if (cipher || passphrase) {\n        throw new TypeError('cipher and passphrase can only be applied when exporting private keys')\n      }\n    }\n\n    if (priv) {\n      return keyObject.export({ format: 'pem', type, cipher, passphrase })\n    }\n\n    return keyObject.export({ format: 'pem', type })\n  }\n\n  toJWK (priv = false) {\n    if (priv && this.public === true) {\n      throw new TypeError('public key cannot be exported as private')\n    }\n\n    const components = [...this.constructor[priv ? PRIVATE_MEMBERS : PUBLIC_MEMBERS]]\n      .map(k => [k, this[k]])\n\n    const result = {}\n\n    Object.keys(components).forEach((key) => {\n      const [k, v] = components[key]\n\n      result[k] = v\n    })\n\n    result.kty = this.kty\n    result.kid = this.kid\n\n    if (this.alg) {\n      result.alg = this.alg\n    }\n\n    if (this.key_ops && this.key_ops.length) {\n      result.key_ops = this.key_ops\n    }\n\n    if (this.use) {\n      result.use = this.use\n    }\n\n    if (this.x5c) {\n      result.x5c = this.x5c\n    }\n\n    if (this.x5t) {\n      result.x5t = this.x5t\n    }\n\n    if (this['x5t#S256']) {\n      result['x5t#S256'] = this['x5t#S256']\n    }\n\n    return result\n  }\n\n  [JWK_MEMBERS] () {\n    const props = this[KEYOBJECT].type === 'private' ? this.constructor[PRIVATE_MEMBERS] : this.constructor[PUBLIC_MEMBERS]\n    Object.defineProperties(this, [...props].reduce((acc, component) => {\n      acc[component] = {\n        get () {\n          const jwk = keyObjectToJWK(this[KEYOBJECT])\n          Object.defineProperties(\n            this,\n            Object.entries(jwk)\n              .filter(([key]) => props.has(key))\n              .reduce((acc, [key, value]) => {\n                acc[key] = { value, enumerable: this.constructor[PUBLIC_MEMBERS].has(key), configurable: false }\n                return acc\n              }, {})\n          )\n\n          return this[component]\n        },\n        enumerable: this.constructor[PUBLIC_MEMBERS].has(component),\n        configurable: true\n      }\n      return acc\n    }, {}))\n  }\n\n  /* c8 ignore next 8 */\n  [inspect.custom] () {\n    return `${this.constructor.name} ${inspect(this.toJWK(false), {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true\n    })}`\n  }\n\n  /* c8 ignore next 3 */\n  [THUMBPRINT_MATERIAL] () {\n    throw new Error(`\"[THUMBPRINT_MATERIAL]()\" is not implemented on ${this.constructor.name}`)\n  }\n\n  algorithms (operation, /* the rest is private API */ int, opts) {\n    const { use = this.use, alg = this.alg, key_ops: ops = this.key_ops } = int === privateApi ? opts : {}\n    if (alg) {\n      return new Set(this.algorithms(operation, privateApi, { alg: null, use, key_ops: ops }).has(alg) ? [alg] : undefined)\n    }\n\n    if (typeof operation === 'symbol') {\n      try {\n        return this[operation]()\n      } catch (err) {\n        return new Set()\n      }\n    }\n\n    if (operation && ops && !ops.includes(operation)) {\n      return new Set()\n    }\n\n    switch (operation) {\n      case 'decrypt':\n      case 'deriveKey':\n      case 'encrypt':\n      case 'sign':\n      case 'unwrapKey':\n      case 'verify':\n      case 'wrapKey':\n        return new Set(Object.entries(JWK[this.kty][operation]).map(([alg, fn]) => fn(this) ? alg : undefined).filter(Boolean))\n      case undefined:\n        return new Set([\n          ...this.algorithms('sign'),\n          ...this.algorithms('verify'),\n          ...this.algorithms('decrypt'),\n          ...this.algorithms('encrypt'),\n          ...this.algorithms('unwrapKey'),\n          ...this.algorithms('wrapKey'),\n          ...this.algorithms('deriveKey')\n        ])\n      default:\n        throw new TypeError('invalid key operation')\n    }\n  }\n\n  /* c8 ignore next 3 */\n  static async generate () {\n    throw new Error(`\"static async generate()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static generateSync () {\n    throw new Error(`\"static generateSync()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static get [PUBLIC_MEMBERS] () {\n    throw new Error(`\"static get [PUBLIC_MEMBERS]()\" is not implemented on ${this.name}`)\n  }\n\n  /* c8 ignore next 3 */\n  static get [PRIVATE_MEMBERS] () {\n    throw new Error(`\"static get [PRIVATE_MEMBERS]()\" is not implemented on ${this.name}`)\n  }\n}\n\nmodule.exports = Key\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1819, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/rsa.js"],"sourcesContent":["const { generateKeyPairSync, generateKeyPair: async } = require('crypto')\nconst { promisify } = require('util')\n\nconst {\n  THUMBPRINT_MATERIAL, JWK_MEMBERS, PUBLIC_MEMBERS,\n  PRIVATE_MEMBERS, KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT\n} = require('../../help/consts')\nconst { keyObjectSupported } = require('../../help/runtime_support')\nconst { createPublicKey, createPrivateKey } = require('../../help/key_object')\n\nconst Key = require('./base')\n\nconst generateKeyPair = promisify(async)\n\nconst RSA_PUBLIC = new Set(['e', 'n'])\nObject.freeze(RSA_PUBLIC)\nconst RSA_PRIVATE = new Set([...RSA_PUBLIC, 'd', 'p', 'q', 'dp', 'dq', 'qi'])\nObject.freeze(RSA_PRIVATE)\n\n// RSA Key Type\nclass RSAKey extends Key {\n  constructor (...args) {\n    super(...args)\n    this[JWK_MEMBERS]()\n    Object.defineProperties(this, {\n      kty: {\n        value: 'RSA',\n        enumerable: true\n      },\n      length: {\n        get () {\n          Object.defineProperty(this, 'length', {\n            value: Buffer.byteLength(this.n, 'base64') * 8,\n            configurable: false\n          })\n\n          return this.length\n        },\n        configurable: true\n      }\n    })\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return RSA_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return RSA_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    return { e: this.e, kty: 'RSA', n: this.n }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return this.algorithms('wrapKey')\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    return this.algorithms('unwrapKey')\n  }\n\n  static async generate (len = 2048, privat = true) {\n    if (!Number.isSafeInteger(len) || len < 512 || len % 8 !== 0 || (('electron' in process.versions) && len % 128 !== 0)) {\n      throw new TypeError('invalid bit length')\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = await generateKeyPair('rsa', { modulusLength: len }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = await generateKeyPair('rsa', {\n      modulusLength: len,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n\n  static generateSync (len = 2048, privat = true) {\n    if (!Number.isSafeInteger(len) || len < 512 || len % 8 !== 0 || (('electron' in process.versions) && len % 128 !== 0)) {\n      throw new TypeError('invalid bit length')\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = generateKeyPairSync('rsa', { modulusLength: len }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = generateKeyPairSync('rsa', {\n      modulusLength: len,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n}\n\nmodule.exports = RSAKey\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 1947, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/ec.js"],"sourcesContent":["const { generateKeyPairSync, generateKeyPair: async } = require('crypto')\nconst { promisify } = require('util')\n\nconst {\n  THUMBPRINT_MATERIAL, JWK_MEMBERS, PUBLIC_MEMBERS,\n  PRIVATE_MEMBERS, KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT\n} = require('../../help/consts')\nconst { EC_CURVES } = require('../../registry')\nconst { keyObjectSupported } = require('../../help/runtime_support')\nconst { createPublicKey, createPrivateKey } = require('../../help/key_object')\n\nconst errors = require('../../errors')\n\nconst Key = require('./base')\n\nconst generateKeyPair = promisify(async)\n\nconst EC_PUBLIC = new Set(['crv', 'x', 'y'])\nObject.freeze(EC_PUBLIC)\nconst EC_PRIVATE = new Set([...EC_PUBLIC, 'd'])\nObject.freeze(EC_PRIVATE)\n\n// Elliptic Curve Key Type\nclass ECKey extends Key {\n  constructor (...args) {\n    super(...args)\n    this[JWK_MEMBERS]()\n    Object.defineProperty(this, 'kty', { value: 'EC', enumerable: true })\n    if (!EC_CURVES.has(this.crv)) {\n      throw new errors.JOSENotSupported('unsupported EC key curve')\n    }\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return EC_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return EC_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    return { crv: this.crv, kty: 'EC', x: this.x, y: this.y }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return this.algorithms('deriveKey')\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    if (this.public) {\n      return new Set()\n    }\n    return this.algorithms('deriveKey')\n  }\n\n  static async generate (crv = 'P-256', privat = true) {\n    if (!EC_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported EC key curve: ${crv}`)\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = await generateKeyPair('ec', { namedCurve: crv }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = await generateKeyPair('ec', {\n      namedCurve: crv,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n\n  static generateSync (crv = 'P-256', privat = true) {\n    if (!EC_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported EC key curve: ${crv}`)\n    }\n\n    let privateKey, publicKey\n\n    if (keyObjectSupported) {\n      ({ privateKey, publicKey } = generateKeyPairSync('ec', { namedCurve: crv }))\n      return privat ? privateKey : publicKey\n    }\n\n    ({ privateKey, publicKey } = generateKeyPairSync('ec', {\n      namedCurve: crv,\n      publicKeyEncoding: { type: 'spki', format: 'pem' },\n      privateKeyEncoding: { type: 'pkcs8', format: 'pem' }\n    }))\n\n    if (privat) {\n      return createPrivateKey(privateKey)\n    } else {\n      return createPublicKey(publicKey)\n    }\n  }\n}\n\nmodule.exports = ECKey\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2068, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/okp.js"],"sourcesContent":["const { generateKeyPairSync, generateKeyPair: async } = require('crypto')\nconst { promisify } = require('util')\n\nconst {\n  THUMBPRINT_MATERIAL, JWK_MEMBERS, PUBLIC_MEMBERS,\n  PRIVATE_MEMBERS, KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT\n} = require('../../help/consts')\nconst { OKP_CURVES } = require('../../registry')\nconst { edDSASupported } = require('../../help/runtime_support')\nconst errors = require('../../errors')\n\nconst Key = require('./base')\n\nconst generateKeyPair = promisify(async)\n\nconst OKP_PUBLIC = new Set(['crv', 'x'])\nObject.freeze(OKP_PUBLIC)\nconst OKP_PRIVATE = new Set([...OKP_PUBLIC, 'd'])\nObject.freeze(OKP_PRIVATE)\n\n// Octet string key pairs Key Type\nclass OKPKey extends Key {\n  constructor (...args) {\n    super(...args)\n    this[JWK_MEMBERS]()\n    Object.defineProperty(this, 'kty', { value: 'OKP', enumerable: true })\n    if (!OKP_CURVES.has(this.crv)) {\n      throw new errors.JOSENotSupported('unsupported OKP key curve')\n    }\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return OKP_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return OKP_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    return { crv: this.crv, kty: 'OKP', x: this.x }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return this.algorithms('deriveKey')\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    if (this.public) {\n      return new Set()\n    }\n    return this.algorithms('deriveKey')\n  }\n\n  static async generate (crv = 'Ed25519', privat = true) {\n    if (!edDSASupported) {\n      throw new errors.JOSENotSupported('OKP keys are not supported in your Node.js runtime version')\n    }\n\n    if (!OKP_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported OKP key curve: ${crv}`)\n    }\n\n    const { privateKey, publicKey } = await generateKeyPair(crv.toLowerCase())\n\n    return privat ? privateKey : publicKey\n  }\n\n  static generateSync (crv = 'Ed25519', privat = true) {\n    if (!edDSASupported) {\n      throw new errors.JOSENotSupported('OKP keys are not supported in your Node.js runtime version')\n    }\n\n    if (!OKP_CURVES.has(crv)) {\n      throw new errors.JOSENotSupported(`unsupported OKP key curve: ${crv}`)\n    }\n\n    const { privateKey, publicKey } = generateKeyPairSync(crv.toLowerCase())\n\n    return privat ? privateKey : publicKey\n  }\n}\n\nmodule.exports = OKPKey\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,mBAAmB,EAAE,iBAAiB,KAAK,EAAE;AACrD,MAAM,EAAE,SAAS,EAAE;AAEnB,MAAM,EACJ,mBAAmB,EAAE,WAAW,EAAE,cAAc,EAChD,eAAe,EAAE,sBAAsB,EAAE,sBAAsB,EAChE;AACD,MAAM,EAAE,UAAU,EAAE;AACpB,MAAM,EAAE,cAAc,EAAE;AACxB,MAAM;AAEN,MAAM;AAEN,MAAM,kBAAkB,UAAU;AAElC,MAAM,aAAa,IAAI,IAAI;IAAC;IAAO;CAAI;AACvC,OAAO,MAAM,CAAC;AACd,MAAM,cAAc,IAAI,IAAI;OAAI;IAAY;CAAI;AAChD,OAAO,MAAM,CAAC;AAEd,kCAAkC;AAClC,MAAM,eAAe;IACnB,YAAa,GAAG,IAAI,CAAE;QACpB,KAAK,IAAI;QACT,IAAI,CAAC,YAAY;QACjB,OAAO,cAAc,CAAC,IAAI,EAAE,OAAO;YAAE,OAAO;YAAO,YAAY;QAAK;QACpE,IAAI,CAAC,WAAW,GAAG,CAAC,IAAI,CAAC,GAAG,GAAG;YAC7B,MAAM,IAAI,OAAO,gBAAgB,CAAC;QACpC;IACF;IAEA,WAAW,CAAC,eAAe,GAAI;QAC7B,OAAO;IACT;IAEA,WAAW,CAAC,gBAAgB,GAAI;QAC9B,OAAO;IACT;IAEA,sFAAsF;IACtF,gCAAgC;IAChC,CAAC,oBAAoB,GAAI;QACvB,OAAO;YAAE,KAAK,IAAI,CAAC,GAAG;YAAE,KAAK;YAAO,GAAG,IAAI,CAAC,CAAC;QAAC;IAChD;IAEA,CAAC,uBAAuB,GAAI;QAC1B,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB;IAEA,CAAC,uBAAuB,GAAI;QAC1B,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,OAAO,IAAI;QACb;QACA,OAAO,IAAI,CAAC,UAAU,CAAC;IACzB;IAEA,aAAa,SAAU,MAAM,SAAS,EAAE,SAAS,IAAI,EAAE;QACrD,IAAI,CAAC,gBAAgB;YACnB,MAAM,IAAI,OAAO,gBAAgB,CAAC;QACpC;QAEA,IAAI,CAAC,WAAW,GAAG,CAAC,MAAM;YACxB,MAAM,IAAI,OAAO,gBAAgB,CAAC,CAAC,2BAA2B,EAAE,KAAK;QACvE;QAEA,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,MAAM,gBAAgB,IAAI,WAAW;QAEvE,OAAO,SAAS,aAAa;IAC/B;IAEA,OAAO,aAAc,MAAM,SAAS,EAAE,SAAS,IAAI,EAAE;QACnD,IAAI,CAAC,gBAAgB;YACnB,MAAM,IAAI,OAAO,gBAAgB,CAAC;QACpC;QAEA,IAAI,CAAC,WAAW,GAAG,CAAC,MAAM;YACxB,MAAM,IAAI,OAAO,gBAAgB,CAAC,CAAC,2BAA2B,EAAE,KAAK;QACvE;QAEA,MAAM,EAAE,UAAU,EAAE,SAAS,EAAE,GAAG,oBAAoB,IAAI,WAAW;QAErE,OAAO,SAAS,aAAa;IAC/B;AACF;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2150, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/oct.js"],"sourcesContent":["const { randomBytes } = require('crypto')\n\nconst { createSecretKey } = require('../../help/key_object')\nconst base64url = require('../../help/base64url')\nconst {\n  THUMBPRINT_MATERIAL, PUBLIC_MEMBERS, PRIVATE_MEMBERS,\n  KEY_MANAGEMENT_DECRYPT, KEY_MANAGEMENT_ENCRYPT, KEYOBJECT\n} = require('../../help/consts')\n\nconst Key = require('./base')\n\nconst OCT_PUBLIC = new Set()\nObject.freeze(OCT_PUBLIC)\nconst OCT_PRIVATE = new Set(['k'])\nObject.freeze(OCT_PRIVATE)\n\n// Octet sequence Key Type\nclass OctKey extends Key {\n  constructor (...args) {\n    super(...args)\n    Object.defineProperties(this, {\n      kty: {\n        value: 'oct',\n        enumerable: true\n      },\n      length: {\n        value: this[KEYOBJECT] ? this[KEYOBJECT].symmetricKeySize * 8 : undefined\n      },\n      k: {\n        enumerable: false,\n        get () {\n          if (this[KEYOBJECT]) {\n            Object.defineProperty(this, 'k', {\n              value: base64url.encodeBuffer(this[KEYOBJECT].export()),\n              configurable: false\n            })\n          } else {\n            Object.defineProperty(this, 'k', {\n              value: undefined,\n              configurable: false\n            })\n          }\n\n          return this.k\n        },\n        configurable: true\n      }\n    })\n  }\n\n  static get [PUBLIC_MEMBERS] () {\n    return OCT_PUBLIC\n  }\n\n  static get [PRIVATE_MEMBERS] () {\n    return OCT_PRIVATE\n  }\n\n  // https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys no need for any special\n  // JSON.stringify handling in V8\n  [THUMBPRINT_MATERIAL] () {\n    if (!this[KEYOBJECT]) {\n      throw new TypeError('reference \"oct\" keys without \"k\" cannot have their thumbprint calculated')\n    }\n    return { k: this.k, kty: 'oct' }\n  }\n\n  [KEY_MANAGEMENT_ENCRYPT] () {\n    return new Set([\n      ...this.algorithms('wrapKey'),\n      ...this.algorithms('deriveKey')\n    ])\n  }\n\n  [KEY_MANAGEMENT_DECRYPT] () {\n    return this[KEY_MANAGEMENT_ENCRYPT]()\n  }\n\n  algorithms (...args) {\n    if (!this[KEYOBJECT]) {\n      return new Set()\n    }\n\n    return Key.prototype.algorithms.call(this, ...args)\n  }\n\n  static async generate (...args) {\n    return this.generateSync(...args)\n  }\n\n  static generateSync (len = 256, privat = true) {\n    if (!privat) {\n      throw new TypeError('\"oct\" keys cannot be generated as public')\n    }\n    if (!Number.isSafeInteger(len) || !len || len % 8 !== 0) {\n      throw new TypeError('invalid bit length')\n    }\n\n    return createSecretKey(randomBytes(len / 8))\n  }\n}\n\nmodule.exports = OctKey\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,WAAW,EAAE;AAErB,MAAM,EAAE,eAAe,EAAE;AACzB,MAAM;AACN,MAAM,EACJ,mBAAmB,EAAE,cAAc,EAAE,eAAe,EACpD,sBAAsB,EAAE,sBAAsB,EAAE,SAAS,EAC1D;AAED,MAAM;AAEN,MAAM,aAAa,IAAI;AACvB,OAAO,MAAM,CAAC;AACd,MAAM,cAAc,IAAI,IAAI;IAAC;CAAI;AACjC,OAAO,MAAM,CAAC;AAEd,0BAA0B;AAC1B,MAAM,eAAe;IACnB,YAAa,GAAG,IAAI,CAAE;QACpB,KAAK,IAAI;QACT,OAAO,gBAAgB,CAAC,IAAI,EAAE;YAC5B,KAAK;gBACH,OAAO;gBACP,YAAY;YACd;YACA,QAAQ;gBACN,OAAO,IAAI,CAAC,UAAU,GAAG,IAAI,CAAC,UAAU,CAAC,gBAAgB,GAAG,IAAI;YAClE;YACA,GAAG;gBACD,YAAY;gBACZ;oBACE,IAAI,IAAI,CAAC,UAAU,EAAE;wBACnB,OAAO,cAAc,CAAC,IAAI,EAAE,KAAK;4BAC/B,OAAO,UAAU,YAAY,CAAC,IAAI,CAAC,UAAU,CAAC,MAAM;4BACpD,cAAc;wBAChB;oBACF,OAAO;wBACL,OAAO,cAAc,CAAC,IAAI,EAAE,KAAK;4BAC/B,OAAO;4BACP,cAAc;wBAChB;oBACF;oBAEA,OAAO,IAAI,CAAC,CAAC;gBACf;gBACA,cAAc;YAChB;QACF;IACF;IAEA,WAAW,CAAC,eAAe,GAAI;QAC7B,OAAO;IACT;IAEA,WAAW,CAAC,gBAAgB,GAAI;QAC9B,OAAO;IACT;IAEA,sFAAsF;IACtF,gCAAgC;IAChC,CAAC,oBAAoB,GAAI;QACvB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,MAAM,IAAI,UAAU;QACtB;QACA,OAAO;YAAE,GAAG,IAAI,CAAC,CAAC;YAAE,KAAK;QAAM;IACjC;IAEA,CAAC,uBAAuB,GAAI;QAC1B,OAAO,IAAI,IAAI;eACV,IAAI,CAAC,UAAU,CAAC;eAChB,IAAI,CAAC,UAAU,CAAC;SACpB;IACH;IAEA,CAAC,uBAAuB,GAAI;QAC1B,OAAO,IAAI,CAAC,uBAAuB;IACrC;IAEA,WAAY,GAAG,IAAI,EAAE;QACnB,IAAI,CAAC,IAAI,CAAC,UAAU,EAAE;YACpB,OAAO,IAAI;QACb;QAEA,OAAO,IAAI,SAAS,CAAC,UAAU,CAAC,IAAI,CAAC,IAAI,KAAK;IAChD;IAEA,aAAa,SAAU,GAAG,IAAI,EAAE;QAC9B,OAAO,IAAI,CAAC,YAAY,IAAI;IAC9B;IAEA,OAAO,aAAc,MAAM,GAAG,EAAE,SAAS,IAAI,EAAE;QAC7C,IAAI,CAAC,QAAQ;YACX,MAAM,IAAI,UAAU;QACtB;QACA,IAAI,CAAC,OAAO,aAAa,CAAC,QAAQ,CAAC,OAAO,MAAM,MAAM,GAAG;YACvD,MAAM,IAAI,UAAU;QACtB;QAEA,OAAO,gBAAgB,YAAY,MAAM;IAC3C;AACF;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2244, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/import.js"],"sourcesContent":["const { createPublicKey, createPrivateKey, createSecretKey, KeyObject } = require('../help/key_object')\nconst base64url = require('../help/base64url')\nconst isObject = require('../help/is_object')\nconst { jwkToPem } = require('../help/key_utils')\nconst errors = require('../errors')\n\nconst RSAKey = require('./key/rsa')\nconst ECKey = require('./key/ec')\nconst OKPKey = require('./key/okp')\nconst OctKey = require('./key/oct')\n\nconst importable = new Set(['string', 'buffer', 'object'])\n\nconst mergedParameters = (target = {}, source = {}) => {\n  return {\n    alg: source.alg,\n    key_ops: source.key_ops,\n    kid: source.kid,\n    use: source.use,\n    x5c: source.x5c,\n    x5t: source.x5t,\n    'x5t#S256': source['x5t#S256'],\n    ...target\n  }\n}\n\nconst openSSHpublicKey = /^[a-zA-Z0-9-]+ AAAA(?:[0-9A-Za-z+/])+(?:==|=)?(?: .*)?$/\n\nconst asKey = (key, parameters, { calculateMissingRSAPrimes = false } = {}) => {\n  let privateKey, publicKey, secret\n\n  if (!importable.has(typeof key)) {\n    throw new TypeError('key argument must be a string, buffer or an object')\n  }\n\n  if (parameters !== undefined && !isObject(parameters)) {\n    throw new TypeError('parameters argument must be a plain object when provided')\n  }\n\n  if (key instanceof KeyObject) {\n    switch (key.type) {\n      case 'private':\n        privateKey = key\n        break\n      case 'public':\n        publicKey = key\n        break\n      case 'secret':\n        secret = key\n        break\n    }\n  } else if (typeof key === 'object' && key && 'kty' in key && key.kty === 'oct') { // symmetric key <Object>\n    try {\n      secret = createSecretKey(base64url.decodeToBuffer(key.k))\n    } catch (err) {\n      if (!('k' in key)) {\n        secret = { type: 'secret' }\n      }\n    }\n    parameters = mergedParameters(parameters, key)\n  } else if (typeof key === 'object' && key && 'kty' in key) { // assume JWK formatted asymmetric key <Object>\n    ({ calculateMissingRSAPrimes = false } = parameters || { calculateMissingRSAPrimes })\n    let pem\n\n    try {\n      pem = jwkToPem(key, { calculateMissingRSAPrimes })\n    } catch (err) {\n      if (err instanceof errors.JOSEError) {\n        throw err\n      }\n    }\n\n    if (pem && key.d) {\n      privateKey = createPrivateKey(pem)\n    } else if (pem) {\n      publicKey = createPublicKey(pem)\n    }\n\n    parameters = mergedParameters({}, key)\n  } else if (key && (typeof key === 'object' || typeof key === 'string')) { // <Object> | <string> | <Buffer> passed to crypto.createPrivateKey or crypto.createPublicKey or <Buffer> passed to crypto.createSecretKey\n    try {\n      privateKey = createPrivateKey(key)\n    } catch (err) {\n      if (err instanceof errors.JOSEError) {\n        throw err\n      }\n    }\n\n    try {\n      publicKey = createPublicKey(key)\n      if (key.startsWith('-----BEGIN CERTIFICATE-----') && (!parameters || !('x5c' in parameters))) {\n        parameters = mergedParameters(parameters, {\n          x5c: [key.replace(/(?:-----(?:BEGIN|END) CERTIFICATE-----|\\s)/g, '')]\n        })\n      }\n    } catch (err) {\n      if (err instanceof errors.JOSEError) {\n        throw err\n      }\n    }\n\n    try {\n      // this is to filter out invalid PEM keys and certs, i'll rather have them fail import then\n      // have them imported as symmetric \"oct\" keys\n      if (!key.includes('-----BEGIN') && !openSSHpublicKey.test(key.toString('ascii').replace(/[\\r\\n]/g, ''))) {\n        secret = createSecretKey(Buffer.isBuffer(key) ? key : Buffer.from(key))\n      }\n    } catch (err) {}\n  }\n\n  const keyObject = privateKey || publicKey || secret\n\n  if (privateKey || publicKey) {\n    switch (keyObject.asymmetricKeyType) {\n      case 'rsa':\n        return new RSAKey(keyObject, parameters)\n      case 'ec':\n        return new ECKey(keyObject, parameters)\n      case 'ed25519':\n      case 'ed448':\n      case 'x25519':\n      case 'x448':\n        return new OKPKey(keyObject, parameters)\n      default:\n        throw new errors.JOSENotSupported('only RSA, EC and OKP asymmetric keys are supported')\n    }\n  } else if (secret) {\n    return new OctKey(keyObject, parameters)\n  }\n\n  throw new errors.JWKImportFailed('key import failed')\n}\n\nmodule.exports = asKey\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,eAAe,EAAE,gBAAgB,EAAE,eAAe,EAAE,SAAS,EAAE;AACvE,MAAM;AACN,MAAM;AACN,MAAM,EAAE,QAAQ,EAAE;AAClB,MAAM;AAEN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AAEN,MAAM,aAAa,IAAI,IAAI;IAAC;IAAU;IAAU;CAAS;AAEzD,MAAM,mBAAmB,CAAC,SAAS,CAAC,CAAC,EAAE,SAAS,CAAC,CAAC;IAChD,OAAO;QACL,KAAK,OAAO,GAAG;QACf,SAAS,OAAO,OAAO;QACvB,KAAK,OAAO,GAAG;QACf,KAAK,OAAO,GAAG;QACf,KAAK,OAAO,GAAG;QACf,KAAK,OAAO,GAAG;QACf,YAAY,MAAM,CAAC,WAAW;QAC9B,GAAG,MAAM;IACX;AACF;AAEA,MAAM,mBAAmB;AAEzB,MAAM,QAAQ,CAAC,KAAK,YAAY,EAAE,4BAA4B,KAAK,EAAE,GAAG,CAAC,CAAC;IACxE,IAAI,YAAY,WAAW;IAE3B,IAAI,CAAC,WAAW,GAAG,CAAC,OAAO,MAAM;QAC/B,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI,eAAe,aAAa,CAAC,SAAS,aAAa;QACrD,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI,eAAe,WAAW;QAC5B,OAAQ,IAAI,IAAI;YACd,KAAK;gBACH,aAAa;gBACb;YACF,KAAK;gBACH,YAAY;gBACZ;YACF,KAAK;gBACH,SAAS;gBACT;QACJ;IACF,OAAO,IAAI,OAAO,QAAQ,YAAY,OAAO,SAAS,OAAO,IAAI,GAAG,KAAK,OAAO;QAC9E,IAAI;YACF,SAAS,gBAAgB,UAAU,cAAc,CAAC,IAAI,CAAC;QACzD,EAAE,OAAO,KAAK;YACZ,IAAI,CAAC,CAAC,OAAO,GAAG,GAAG;gBACjB,SAAS;oBAAE,MAAM;gBAAS;YAC5B;QACF;QACA,aAAa,iBAAiB,YAAY;IAC5C,OAAO,IAAI,OAAO,QAAQ,YAAY,OAAO,SAAS,KAAK;QACzD,CAAC,EAAE,4BAA4B,KAAK,EAAE,GAAG,cAAc;YAAE;QAA0B,CAAC;QACpF,IAAI;QAEJ,IAAI;YACF,MAAM,SAAS,KAAK;gBAAE;YAA0B;QAClD,EAAE,OAAO,KAAK;YACZ,IAAI,eAAe,OAAO,SAAS,EAAE;gBACnC,MAAM;YACR;QACF;QAEA,IAAI,OAAO,IAAI,CAAC,EAAE;YAChB,aAAa,iBAAiB;QAChC,OAAO,IAAI,KAAK;YACd,YAAY,gBAAgB;QAC9B;QAEA,aAAa,iBAAiB,CAAC,GAAG;IACpC,OAAO,IAAI,OAAO,CAAC,OAAO,QAAQ,YAAY,OAAO,QAAQ,QAAQ,GAAG;QACtE,IAAI;YACF,aAAa,iBAAiB;QAChC,EAAE,OAAO,KAAK;YACZ,IAAI,eAAe,OAAO,SAAS,EAAE;gBACnC,MAAM;YACR;QACF;QAEA,IAAI;YACF,YAAY,gBAAgB;YAC5B,IAAI,IAAI,UAAU,CAAC,kCAAkC,CAAC,CAAC,cAAc,CAAC,CAAC,SAAS,UAAU,CAAC,GAAG;gBAC5F,aAAa,iBAAiB,YAAY;oBACxC,KAAK;wBAAC,IAAI,OAAO,CAAC,+CAA+C;qBAAI;gBACvE;YACF;QACF,EAAE,OAAO,KAAK;YACZ,IAAI,eAAe,OAAO,SAAS,EAAE;gBACnC,MAAM;YACR;QACF;QAEA,IAAI;YACF,2FAA2F;YAC3F,6CAA6C;YAC7C,IAAI,CAAC,IAAI,QAAQ,CAAC,iBAAiB,CAAC,iBAAiB,IAAI,CAAC,IAAI,QAAQ,CAAC,SAAS,OAAO,CAAC,WAAW,MAAM;gBACvG,SAAS,gBAAgB,OAAO,QAAQ,CAAC,OAAO,MAAM,OAAO,IAAI,CAAC;YACpE;QACF,EAAE,OAAO,KAAK,CAAC;IACjB;IAEA,MAAM,YAAY,cAAc,aAAa;IAE7C,IAAI,cAAc,WAAW;QAC3B,OAAQ,UAAU,iBAAiB;YACjC,KAAK;gBACH,OAAO,IAAI,OAAO,WAAW;YAC/B,KAAK;gBACH,OAAO,IAAI,MAAM,WAAW;YAC9B,KAAK;YACL,KAAK;YACL,KAAK;YACL,KAAK;gBACH,OAAO,IAAI,OAAO,WAAW;YAC/B;gBACE,MAAM,IAAI,OAAO,gBAAgB,CAAC;QACtC;IACF,OAAO,IAAI,QAAQ;QACjB,OAAO,IAAI,OAAO,WAAW;IAC/B;IAEA,MAAM,IAAI,OAAO,eAAe,CAAC;AACnC;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2378, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/generate.js"],"sourcesContent":["const errors = require('../errors')\n\nconst importKey = require('./import')\n\nconst RSAKey = require('./key/rsa')\nconst ECKey = require('./key/ec')\nconst OKPKey = require('./key/okp')\nconst OctKey = require('./key/oct')\n\nconst generate = async (kty, crvOrSize, params, generatePrivate = true) => {\n  switch (kty) {\n    case 'RSA':\n      return importKey(\n        await RSAKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    case 'EC':\n      return importKey(\n        await ECKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    case 'OKP':\n      return importKey(\n        await OKPKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    case 'oct':\n      return importKey(\n        await OctKey.generate(crvOrSize, generatePrivate),\n        params\n      )\n    default:\n      throw new errors.JOSENotSupported(`unsupported key type: ${kty}`)\n  }\n}\n\nconst generateSync = (kty, crvOrSize, params, generatePrivate = true) => {\n  switch (kty) {\n    case 'RSA':\n      return importKey(RSAKey.generateSync(crvOrSize, generatePrivate), params)\n    case 'EC':\n      return importKey(ECKey.generateSync(crvOrSize, generatePrivate), params)\n    case 'OKP':\n      return importKey(OKPKey.generateSync(crvOrSize, generatePrivate), params)\n    case 'oct':\n      return importKey(OctKey.generateSync(crvOrSize, generatePrivate), params)\n    default:\n      throw new errors.JOSENotSupported(`unsupported key type: ${kty}`)\n  }\n}\n\nmodule.exports.generate = generate\nmodule.exports.generateSync = generateSync\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,MAAM;AAEN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AAEN,MAAM,WAAW,OAAO,KAAK,WAAW,QAAQ,kBAAkB,IAAI;IACpE,OAAQ;QACN,KAAK;YACH,OAAO,UACL,MAAM,OAAO,QAAQ,CAAC,WAAW,kBACjC;QAEJ,KAAK;YACH,OAAO,UACL,MAAM,MAAM,QAAQ,CAAC,WAAW,kBAChC;QAEJ,KAAK;YACH,OAAO,UACL,MAAM,OAAO,QAAQ,CAAC,WAAW,kBACjC;QAEJ,KAAK;YACH,OAAO,UACL,MAAM,OAAO,QAAQ,CAAC,WAAW,kBACjC;QAEJ;YACE,MAAM,IAAI,OAAO,gBAAgB,CAAC,CAAC,sBAAsB,EAAE,KAAK;IACpE;AACF;AAEA,MAAM,eAAe,CAAC,KAAK,WAAW,QAAQ,kBAAkB,IAAI;IAClE,OAAQ;QACN,KAAK;YACH,OAAO,UAAU,OAAO,YAAY,CAAC,WAAW,kBAAkB;QACpE,KAAK;YACH,OAAO,UAAU,MAAM,YAAY,CAAC,WAAW,kBAAkB;QACnE,KAAK;YACH,OAAO,UAAU,OAAO,YAAY,CAAC,WAAW,kBAAkB;QACpE,KAAK;YACH,OAAO,UAAU,OAAO,YAAY,CAAC,WAAW,kBAAkB;QACpE;YACE,MAAM,IAAI,OAAO,gBAAgB,CAAC,CAAC,sBAAsB,EAAE,KAAK;IACpE;AACF;AAEA,OAAO,OAAO,CAAC,QAAQ,GAAG;AAC1B,OAAO,OAAO,CAAC,YAAY,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2419, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/none.js"],"sourcesContent":["const { inspect } = require('util')\n\nconst Key = require('./base')\n\nclass NoneKey extends Key {\n  constructor () {\n    super({ type: 'unsecured' }, { alg: 'none' })\n    Object.defineProperties(this, {\n      kid: { value: undefined },\n      kty: { value: undefined },\n      thumbprint: { value: undefined },\n      toJWK: { value: undefined },\n      toPEM: { value: undefined }\n    })\n  }\n\n  /* c8 ignore next 3 */\n  [inspect.custom] () {\n    return 'None {}'\n  }\n\n  algorithms (operation) {\n    switch (operation) {\n      case 'sign':\n      case 'verify':\n      case undefined:\n        return new Set(['none'])\n      default:\n        return new Set()\n    }\n  }\n}\n\nmodule.exports = new NoneKey()\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM;AAEN,MAAM,gBAAgB;IACpB,aAAe;QACb,KAAK,CAAC;YAAE,MAAM;QAAY,GAAG;YAAE,KAAK;QAAO;QAC3C,OAAO,gBAAgB,CAAC,IAAI,EAAE;YAC5B,KAAK;gBAAE,OAAO;YAAU;YACxB,KAAK;gBAAE,OAAO;YAAU;YACxB,YAAY;gBAAE,OAAO;YAAU;YAC/B,OAAO;gBAAE,OAAO;YAAU;YAC1B,OAAO;gBAAE,OAAO;YAAU;QAC5B;IACF;IAEA,oBAAoB,GACpB,CAAC,QAAQ,MAAM,CAAC,GAAI;QAClB,OAAO;IACT;IAEA,WAAY,SAAS,EAAE;QACrB,OAAQ;YACN,KAAK;YACL,KAAK;YACL,KAAK;gBACH,OAAO,IAAI,IAAI;oBAAC;iBAAO;YACzB;gBACE,OAAO,IAAI;QACf;IACF;AACF;AAEA,OAAO,OAAO,GAAG,IAAI","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2468, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/embedded.jwk.js"],"sourcesContent":["const { inspect } = require('util')\n\nconst Key = require('./base')\n\nclass EmbeddedJWK extends Key {\n  constructor () {\n    super({ type: 'embedded' })\n    Object.defineProperties(this, {\n      kid: { value: undefined },\n      kty: { value: undefined },\n      thumbprint: { value: undefined },\n      toJWK: { value: undefined },\n      toPEM: { value: undefined }\n    })\n  }\n\n  /* c8 ignore next 3 */\n  [inspect.custom] () {\n    return 'Embedded.JWK {}'\n  }\n\n  algorithms () {\n    return new Set()\n  }\n}\n\nmodule.exports = new EmbeddedJWK()\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM;AAEN,MAAM,oBAAoB;IACxB,aAAe;QACb,KAAK,CAAC;YAAE,MAAM;QAAW;QACzB,OAAO,gBAAgB,CAAC,IAAI,EAAE;YAC5B,KAAK;gBAAE,OAAO;YAAU;YACxB,KAAK;gBAAE,OAAO;YAAU;YACxB,YAAY;gBAAE,OAAO;YAAU;YAC/B,OAAO;gBAAE,OAAO;YAAU;YAC1B,OAAO;gBAAE,OAAO;YAAU;QAC5B;IACF;IAEA,oBAAoB,GACpB,CAAC,QAAQ,MAAM,CAAC,GAAI;QAClB,OAAO;IACT;IAEA,aAAc;QACZ,OAAO,IAAI;IACb;AACF;AAEA,OAAO,OAAO,GAAG,IAAI","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2506, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/key/embedded.x5c.js"],"sourcesContent":["const { inspect } = require('util')\n\nconst Key = require('./base')\n\nclass EmbeddedX5C extends Key {\n  constructor () {\n    super({ type: 'embedded' })\n    Object.defineProperties(this, {\n      kid: { value: undefined },\n      kty: { value: undefined },\n      thumbprint: { value: undefined },\n      toJWK: { value: undefined },\n      toPEM: { value: undefined }\n    })\n  }\n\n  /* c8 ignore next 3 */\n  [inspect.custom] () {\n    return 'Embedded.X5C {}'\n  }\n\n  algorithms () {\n    return new Set()\n  }\n}\n\nmodule.exports = new EmbeddedX5C()\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM;AAEN,MAAM,oBAAoB;IACxB,aAAe;QACb,KAAK,CAAC;YAAE,MAAM;QAAW;QACzB,OAAO,gBAAgB,CAAC,IAAI,EAAE;YAC5B,KAAK;gBAAE,OAAO;YAAU;YACxB,KAAK;gBAAE,OAAO;YAAU;YACxB,YAAY;gBAAE,OAAO;YAAU;YAC/B,OAAO;gBAAE,OAAO;YAAU;YAC1B,OAAO;gBAAE,OAAO;YAAU;QAC5B;IACF;IAEA,oBAAoB,GACpB,CAAC,QAAQ,MAAM,CAAC,GAAI;QAClB,OAAO;IACT;IAEA,aAAc;QACZ,OAAO,IAAI;IACb;AACF;AAEA,OAAO,OAAO,GAAG,IAAI","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2544, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwk/index.js"],"sourcesContent":["const Key = require('./key/base')\nconst None = require('./key/none')\nconst EmbeddedJWK = require('./key/embedded.jwk')\nconst EmbeddedX5C = require('./key/embedded.x5c')\nconst importKey = require('./import')\nconst generate = require('./generate')\n\nmodule.exports = {\n  ...generate,\n  asKey: importKey,\n  isKey: input => input instanceof Key,\n  None,\n  EmbeddedJWK,\n  EmbeddedX5C\n}\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AAEN,OAAO,OAAO,GAAG;IACf,GAAG,QAAQ;IACX,OAAO;IACP,OAAO,CAAA,QAAS,iBAAiB;IACjC;IACA;IACA;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2563, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwks/keystore.js"],"sourcesContent":["const { inspect } = require('util')\n\nconst isObject = require('../help/is_object')\nconst { generate, generateSync } = require('../jwk/generate')\nconst { USES_MAPPING } = require('../help/consts')\nconst { isKey, asKey: importKey } = require('../jwk')\n\nconst keyscore = (key, { alg, use, ops }) => {\n  let score = 0\n\n  if (alg && key.alg) {\n    score++\n  }\n\n  if (use && key.use) {\n    score++\n  }\n\n  if (ops && key.key_ops) {\n    score++\n  }\n\n  return score\n}\n\nclass KeyStore {\n  constructor (...keys) {\n    while (keys.some(Array.isArray)) {\n      keys = keys.flat\n        ? keys.flat()\n        : keys.reduce((acc, val) => {\n          if (Array.isArray(val)) {\n            return [...acc, ...val]\n          }\n\n          acc.push(val)\n          return acc\n        }, [])\n    }\n    if (keys.some(k => !isKey(k) || !k.kty)) {\n      throw new TypeError('all keys must be instances of a key instantiated by JWK.asKey')\n    }\n\n    this._keys = new Set(keys)\n  }\n\n  all ({ alg, kid, thumbprint, use, kty, key_ops: ops, x5t, 'x5t#S256': x5t256, crv } = {}) {\n    if (ops !== undefined && (!Array.isArray(ops) || !ops.length || ops.some(x => typeof x !== 'string'))) {\n      throw new TypeError('`key_ops` must be a non-empty array of strings')\n    }\n\n    const search = { alg, use, ops }\n    return [...this._keys]\n      .filter((key) => {\n        let candidate = true\n\n        if (candidate && kid !== undefined && key.kid !== kid) {\n          candidate = false\n        }\n\n        if (candidate && thumbprint !== undefined && key.thumbprint !== thumbprint) {\n          candidate = false\n        }\n\n        if (candidate && x5t !== undefined && key.x5t !== x5t) {\n          candidate = false\n        }\n\n        if (candidate && x5t256 !== undefined && key['x5t#S256'] !== x5t256) {\n          candidate = false\n        }\n\n        if (candidate && kty !== undefined && key.kty !== kty) {\n          candidate = false\n        }\n\n        if (candidate && crv !== undefined && (key.crv !== crv)) {\n          candidate = false\n        }\n\n        if (alg !== undefined && !key.algorithms().has(alg)) {\n          candidate = false\n        }\n\n        if (candidate && use !== undefined && (key.use !== undefined && key.use !== use)) {\n          candidate = false\n        }\n\n        // TODO:\n        if (candidate && ops !== undefined && (key.key_ops !== undefined || key.use !== undefined)) {\n          let keyOps\n          if (key.key_ops) {\n            keyOps = new Set(key.key_ops)\n          } else {\n            keyOps = USES_MAPPING[key.use]\n          }\n          if (ops.some(x => !keyOps.has(x))) {\n            candidate = false\n          }\n        }\n\n        return candidate\n      })\n      .sort((first, second) => keyscore(second, search) - keyscore(first, search))\n  }\n\n  get (...args) {\n    return this.all(...args)[0]\n  }\n\n  add (key) {\n    if (!isKey(key) || !key.kty) {\n      throw new TypeError('key must be an instance of a key instantiated by JWK.asKey')\n    }\n\n    this._keys.add(key)\n  }\n\n  remove (key) {\n    if (!isKey(key)) {\n      throw new TypeError('key must be an instance of a key instantiated by JWK.asKey')\n    }\n\n    this._keys.delete(key)\n  }\n\n  toJWKS (priv = false) {\n    return {\n      keys: [...this._keys.values()].map(\n        key => key.toJWK(priv && (key.private || (key.secret && key.k)))\n      )\n    }\n  }\n\n  async generate (...args) {\n    this._keys.add(await generate(...args))\n  }\n\n  generateSync (...args) {\n    this._keys.add(generateSync(...args))\n  }\n\n  get size () {\n    return this._keys.size\n  }\n\n  /* c8 ignore next 8 */\n  [inspect.custom] () {\n    return `${this.constructor.name} ${inspect(this.toJWKS(false), {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true\n    })}`\n  }\n\n  * [Symbol.iterator] () {\n    for (const key of this._keys) {\n      yield key\n    }\n  }\n}\n\nfunction asKeyStore (jwks, { ignoreErrors = false, calculateMissingRSAPrimes = false } = {}) {\n  if (!isObject(jwks) || !Array.isArray(jwks.keys) || jwks.keys.some(k => !isObject(k) || !('kty' in k))) {\n    throw new TypeError('jwks must be a JSON Web Key Set formatted object')\n  }\n\n  const keys = jwks.keys.map((jwk) => {\n    try {\n      return importKey(jwk, { calculateMissingRSAPrimes })\n    } catch (err) {\n      if (!ignoreErrors) {\n        throw err\n      }\n      return undefined\n    }\n  }).filter(Boolean)\n\n  return new KeyStore(...keys)\n}\n\nmodule.exports = { KeyStore, asKeyStore }\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2724, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/get_key.js"],"sourcesContent":["const errors = require('../errors')\nconst Key = require('../jwk/key/base')\nconst importKey = require('../jwk/import')\nconst { KeyStore } = require('../jwks/keystore')\n\nmodule.exports = (input, keyStoreAllowed = false) => {\n  if (input instanceof Key) {\n    return input\n  }\n\n  if (input instanceof KeyStore) {\n    if (!keyStoreAllowed) {\n      throw new TypeError('key argument for this operation must not be a JWKS.KeyStore instance')\n    }\n\n    return input\n  }\n\n  try {\n    return importKey(input)\n  } catch (err) {\n    if (err instanceof errors.JOSEError && !(err instanceof errors.JWKImportFailed)) {\n      throw err\n    }\n\n    let msg\n    if (keyStoreAllowed) {\n      msg = 'key must be an instance of a key instantiated by JWK.asKey, a valid JWK.asKey input, or a JWKS.KeyStore instance'\n    } else {\n      msg = 'key must be an instance of a key instantiated by JWK.asKey, or a valid JWK.asKey input'\n    }\n\n    throw new TypeError(msg)\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,EAAE,QAAQ,EAAE;AAElB,OAAO,OAAO,GAAG,CAAC,OAAO,kBAAkB,KAAK;IAC9C,IAAI,iBAAiB,KAAK;QACxB,OAAO;IACT;IAEA,IAAI,iBAAiB,UAAU;QAC7B,IAAI,CAAC,iBAAiB;YACpB,MAAM,IAAI,UAAU;QACtB;QAEA,OAAO;IACT;IAEA,IAAI;QACF,OAAO,UAAU;IACnB,EAAE,OAAO,KAAK;QACZ,IAAI,eAAe,OAAO,SAAS,IAAI,CAAC,CAAC,eAAe,OAAO,eAAe,GAAG;YAC/E,MAAM;QACR;QAEA,IAAI;QACJ,IAAI,iBAAiB;YACnB,MAAM;QACR,OAAO;YACL,MAAM;QACR;QAEA,MAAM,IAAI,UAAU;IACtB;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2758, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/deep_clone.js"],"sourcesContent":["module.exports = obj => JSON.parse(JSON.stringify(obj))\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAA,MAAO,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2764, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/timing_safe_equal.js"],"sourcesContent":["const { timingSafeEqual: TSE } = require('crypto')\n\nconst paddedBuffer = (input, length) => {\n  if (input.length === length) {\n    return input\n  }\n\n  const buffer = Buffer.alloc(length)\n  input.copy(buffer)\n  return buffer\n}\n\nconst timingSafeEqual = (a, b) => {\n  const length = Math.max(a.length, b.length)\n  return TSE(paddedBuffer(a, length), paddedBuffer(b, length))\n}\n\nmodule.exports = timingSafeEqual\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,iBAAiB,GAAG,EAAE;AAE9B,MAAM,eAAe,CAAC,OAAO;IAC3B,IAAI,MAAM,MAAM,KAAK,QAAQ;QAC3B,OAAO;IACT;IAEA,MAAM,SAAS,OAAO,KAAK,CAAC;IAC5B,MAAM,IAAI,CAAC;IACX,OAAO;AACT;AAEA,MAAM,kBAAkB,CAAC,GAAG;IAC1B,MAAM,SAAS,KAAK,GAAG,CAAC,EAAE,MAAM,EAAE,EAAE,MAAM;IAC1C,OAAO,IAAI,aAAa,GAAG,SAAS,aAAa,GAAG;AACtD;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2783, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/node_alg.js"],"sourcesContent":["module.exports = alg => `sha${alg.substr(2, 3)}`\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAA,MAAO,CAAC,GAAG,EAAE,IAAI,MAAM,CAAC,GAAG,IAAI","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2789, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/hmac.js"],"sourcesContent":["const { createHmac } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst timingSafeEqual = require('../help/timing_safe_equal')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\n\nconst sign = (jwaAlg, hmacAlg, { [KEYOBJECT]: keyObject }, payload) => {\n  const hmac = createHmac(hmacAlg, asInput(keyObject, false))\n  hmac.update(payload)\n  return hmac.digest()\n}\n\nconst verify = (jwaAlg, hmacAlg, key, payload, signature) => {\n  const expected = sign(jwaAlg, hmacAlg, key, payload)\n  const actual = signature\n\n  return timingSafeEqual(actual, expected)\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['HS256', 'HS384', 'HS512'].forEach((jwaAlg) => {\n    const hmacAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, jwaAlg, hmacAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, jwaAlg, hmacAlg))\n    JWK.oct.sign[jwaAlg] = JWK.oct.verify[jwaAlg] = key => key.use === 'sig' || key.use === undefined\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE;AAEpB,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM;AACN,MAAM;AACN,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM,OAAO,CAAC,QAAQ,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IACzD,MAAM,OAAO,WAAW,SAAS,QAAQ,WAAW;IACpD,KAAK,MAAM,CAAC;IACZ,OAAO,KAAK,MAAM;AACpB;AAEA,MAAM,SAAS,CAAC,QAAQ,SAAS,KAAK,SAAS;IAC7C,MAAM,WAAW,KAAK,QAAQ,SAAS,KAAK;IAC5C,MAAM,SAAS;IAEf,OAAO,gBAAgB,QAAQ;AACjC;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAS;QAAS;KAAQ,CAAC,OAAO,CAAC,CAAC;QACnC,MAAM,UAAU,eAAe;QAC/B,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,WAAW,QAAQ;QAClD,IAAI,MAAM,CAAC,GAAG,CAAC,QAAQ,OAAO,IAAI,CAAC,WAAW,QAAQ;QACtD,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,GAAG,CAAA,MAAO,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK;IAC1F;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2821, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/ecdsa_signatures.js"],"sourcesContent":["const MAX_OCTET = 0x80\nconst CLASS_UNIVERSAL = 0\nconst PRIMITIVE_BIT = 0x20\nconst TAG_SEQ = 0x10\nconst TAG_INT = 0x02\nconst ENCODED_TAG_SEQ = (TAG_SEQ | PRIMITIVE_BIT) | (CLASS_UNIVERSAL << 6)\nconst ENCODED_TAG_INT = TAG_INT | (CLASS_UNIVERSAL << 6)\n\nconst getParamSize = keySize => ((keySize / 8) | 0) + (keySize % 8 === 0 ? 0 : 1)\n\nconst paramBytesForAlg = {\n  ES256: getParamSize(256),\n  ES256K: getParamSize(256),\n  ES384: getParamSize(384),\n  ES512: getParamSize(521)\n}\n\nconst countPadding = (buf, start, stop) => {\n  let padding = 0\n  while (start + padding < stop && buf[start + padding] === 0) {\n    ++padding\n  }\n\n  const needsSign = buf[start + padding] >= MAX_OCTET\n  if (needsSign) {\n    --padding\n  }\n\n  return padding\n}\n\nmodule.exports.derToJose = (signature, alg) => {\n  if (!Buffer.isBuffer(signature)) {\n    throw new TypeError('ECDSA signature must be a Buffer')\n  }\n\n  if (!paramBytesForAlg[alg]) {\n    throw new Error(`Unknown algorithm \"${alg}\"`)\n  }\n\n  const paramBytes = paramBytesForAlg[alg]\n\n  // the DER encoded param should at most be the param size, plus a padding\n  // zero, since due to being a signed integer\n  const maxEncodedParamLength = paramBytes + 1\n\n  const inputLength = signature.length\n\n  let offset = 0\n  if (signature[offset++] !== ENCODED_TAG_SEQ) {\n    throw new Error('Could not find expected \"seq\"')\n  }\n\n  let seqLength = signature[offset++]\n  if (seqLength === (MAX_OCTET | 1)) {\n    seqLength = signature[offset++]\n  }\n\n  if (inputLength - offset < seqLength) {\n    throw new Error(`\"seq\" specified length of ${seqLength}\", only ${inputLength - offset}\" remaining`)\n  }\n\n  if (signature[offset++] !== ENCODED_TAG_INT) {\n    throw new Error('Could not find expected \"int\" for \"r\"')\n  }\n\n  const rLength = signature[offset++]\n\n  if (inputLength - offset - 2 < rLength) {\n    throw new Error(`\"r\" specified length of \"${rLength}\", only \"${inputLength - offset - 2}\" available`)\n  }\n\n  if (maxEncodedParamLength < rLength) {\n    throw new Error(`\"r\" specified length of \"${rLength}\", max of \"${maxEncodedParamLength}\" is acceptable`)\n  }\n\n  const rOffset = offset\n  offset += rLength\n\n  if (signature[offset++] !== ENCODED_TAG_INT) {\n    throw new Error('Could not find expected \"int\" for \"s\"')\n  }\n\n  const sLength = signature[offset++]\n\n  if (inputLength - offset !== sLength) {\n    throw new Error(`\"s\" specified length of \"${sLength}\", expected \"${inputLength - offset}\"`)\n  }\n\n  if (maxEncodedParamLength < sLength) {\n    throw new Error(`\"s\" specified length of \"${sLength}\", max of \"${maxEncodedParamLength}\" is acceptable`)\n  }\n\n  const sOffset = offset\n  offset += sLength\n\n  if (offset !== inputLength) {\n    throw new Error(`Expected to consume entire buffer, but \"${inputLength - offset}\" bytes remain`)\n  }\n\n  const rPadding = paramBytes - rLength\n\n  const sPadding = paramBytes - sLength\n\n  const dst = Buffer.allocUnsafe(rPadding + rLength + sPadding + sLength)\n\n  for (offset = 0; offset < rPadding; ++offset) {\n    dst[offset] = 0\n  }\n  signature.copy(dst, offset, rOffset + Math.max(-rPadding, 0), rOffset + rLength)\n\n  offset = paramBytes\n\n  for (const o = offset; offset < o + sPadding; ++offset) {\n    dst[offset] = 0\n  }\n  signature.copy(dst, offset, sOffset + Math.max(-sPadding, 0), sOffset + sLength)\n\n  return dst\n}\n\nmodule.exports.joseToDer = (signature, alg) => {\n  if (!Buffer.isBuffer(signature)) {\n    throw new TypeError('ECDSA signature must be a Buffer')\n  }\n\n  if (!paramBytesForAlg[alg]) {\n    throw new TypeError(`Unknown algorithm \"${alg}\"`)\n  }\n\n  const paramBytes = paramBytesForAlg[alg]\n\n  const signatureBytes = signature.length\n  if (signatureBytes !== paramBytes * 2) {\n    throw new Error(`\"${alg}\" signatures must be \"${paramBytes * 2}\" bytes, saw \"${signatureBytes}\"`)\n  }\n\n  const rPadding = countPadding(signature, 0, paramBytes)\n  const sPadding = countPadding(signature, paramBytes, signature.length)\n  const rLength = paramBytes - rPadding\n  const sLength = paramBytes - sPadding\n\n  const rsBytes = 1 + 1 + rLength + 1 + 1 + sLength\n\n  const shortLength = rsBytes < MAX_OCTET\n\n  const dst = Buffer.allocUnsafe((shortLength ? 2 : 3) + rsBytes)\n\n  let offset = 0\n  dst[offset++] = ENCODED_TAG_SEQ\n  if (shortLength) {\n    // Bit 8 has value \"0\"\n    // bits 7-1 give the length.\n    dst[offset++] = rsBytes\n  } else {\n    // Bit 8 of first octet has value \"1\"\n    // bits 7-1 give the number of additional length octets.\n    dst[offset++] = MAX_OCTET\t| 1 // eslint-disable-line no-tabs\n    // length, base 256\n    dst[offset++] = rsBytes & 0xff\n  }\n  dst[offset++] = ENCODED_TAG_INT\n  dst[offset++] = rLength\n  if (rPadding < 0) {\n    dst[offset++] = 0\n    offset += signature.copy(dst, offset, 0, paramBytes)\n  } else {\n    offset += signature.copy(dst, offset, rPadding, paramBytes)\n  }\n  dst[offset++] = ENCODED_TAG_INT\n  dst[offset++] = sLength\n  if (sPadding < 0) {\n    dst[offset++] = 0\n    signature.copy(dst, offset, paramBytes)\n  } else {\n    signature.copy(dst, offset, paramBytes + sPadding)\n  }\n\n  return dst\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2965, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/ecdsa.js"],"sourcesContent":["const { sign: signOneShot, verify: verifyOneShot, createSign, createVerify, getCurves } = require('crypto')\n\nconst { derToJose, joseToDer } = require('../help/ecdsa_signatures')\nconst { KEYOBJECT } = require('../help/consts')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\nconst { dsaEncodingSupported } = require('../help/runtime_support')\n\nlet sign, verify\n\nif (dsaEncodingSupported) {\n  sign = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n    if (typeof payload === 'string') {\n      payload = Buffer.from(payload)\n    }\n    return signOneShot(nodeAlg, payload, { key: asInput(keyObject, false), dsaEncoding: 'ieee-p1363' })\n  }\n  verify = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n    try {\n      return verifyOneShot(nodeAlg, payload, { key: asInput(keyObject, true), dsaEncoding: 'ieee-p1363' }, signature)\n    } catch (err) {\n      return false\n    }\n  }\n} else {\n  sign = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n    return derToJose(createSign(nodeAlg).update(payload).sign(asInput(keyObject, false)), jwaAlg)\n  }\n  verify = (jwaAlg, nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n    try {\n      return createVerify(nodeAlg).update(payload).verify(asInput(keyObject, true), joseToDer(signature, jwaAlg))\n    } catch (err) {\n      return false\n    }\n  }\n}\n\nconst crvToAlg = (crv) => {\n  switch (crv) {\n    case 'P-256':\n      return 'ES256'\n    case 'secp256k1':\n      return 'ES256K'\n    case 'P-384':\n      return 'ES384'\n    case 'P-521':\n      return 'ES512'\n  }\n}\n\nmodule.exports = (JWA, JWK) => {\n  const algs = []\n\n  if (getCurves().includes('prime256v1')) {\n    algs.push('ES256')\n  }\n\n  if (getCurves().includes('secp256k1')) {\n    algs.push('ES256K')\n  }\n\n  if (getCurves().includes('secp384r1')) {\n    algs.push('ES384')\n  }\n\n  if (getCurves().includes('secp521r1')) {\n    algs.push('ES512')\n  }\n\n  algs.forEach((jwaAlg) => {\n    const nodeAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, jwaAlg, nodeAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, jwaAlg, nodeAlg))\n    JWK.EC.sign[jwaAlg] = key => key.private && JWK.EC.verify[jwaAlg](key)\n    JWK.EC.verify[jwaAlg] = key => (key.use === 'sig' || key.use === undefined) && crvToAlg(key.crv) === jwaAlg\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,MAAM,WAAW,EAAE,QAAQ,aAAa,EAAE,UAAU,EAAE,YAAY,EAAE,SAAS,EAAE;AAEvF,MAAM,EAAE,SAAS,EAAE,SAAS,EAAE;AAC9B,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM;AACN,MAAM,EAAE,OAAO,EAAE;AACjB,MAAM,EAAE,oBAAoB,EAAE;AAE9B,IAAI,MAAM;AAEV,IAAI,sBAAsB;IACxB,OAAO,CAAC,QAAQ,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;QACnD,IAAI,OAAO,YAAY,UAAU;YAC/B,UAAU,OAAO,IAAI,CAAC;QACxB;QACA,OAAO,YAAY,SAAS,SAAS;YAAE,KAAK,QAAQ,WAAW;YAAQ,aAAa;QAAa;IACnG;IACA,SAAS,CAAC,QAAQ,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS;QAC9D,IAAI;YACF,OAAO,cAAc,SAAS,SAAS;gBAAE,KAAK,QAAQ,WAAW;gBAAO,aAAa;YAAa,GAAG;QACvG,EAAE,OAAO,KAAK;YACZ,OAAO;QACT;IACF;AACF,OAAO;IACL,OAAO,CAAC,QAAQ,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;QACnD,OAAO,UAAU,WAAW,SAAS,MAAM,CAAC,SAAS,IAAI,CAAC,QAAQ,WAAW,SAAS;IACxF;IACA,SAAS,CAAC,QAAQ,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS;QAC9D,IAAI;YACF,OAAO,aAAa,SAAS,MAAM,CAAC,SAAS,MAAM,CAAC,QAAQ,WAAW,OAAO,UAAU,WAAW;QACrG,EAAE,OAAO,KAAK;YACZ,OAAO;QACT;IACF;AACF;AAEA,MAAM,WAAW,CAAC;IAChB,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;IACX;AACF;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB,MAAM,OAAO,EAAE;IAEf,IAAI,YAAY,QAAQ,CAAC,eAAe;QACtC,KAAK,IAAI,CAAC;IACZ;IAEA,IAAI,YAAY,QAAQ,CAAC,cAAc;QACrC,KAAK,IAAI,CAAC;IACZ;IAEA,IAAI,YAAY,QAAQ,CAAC,cAAc;QACrC,KAAK,IAAI,CAAC;IACZ;IAEA,IAAI,YAAY,QAAQ,CAAC,cAAc;QACrC,KAAK,IAAI,CAAC;IACZ;IAEA,KAAK,OAAO,CAAC,CAAC;QACZ,MAAM,UAAU,eAAe;QAC/B,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,WAAW,QAAQ;QAClD,IAAI,MAAM,CAAC,GAAG,CAAC,QAAQ,OAAO,IAAI,CAAC,WAAW,QAAQ;QACtD,IAAI,EAAE,CAAC,IAAI,CAAC,OAAO,GAAG,CAAA,MAAO,IAAI,OAAO,IAAI,IAAI,EAAE,CAAC,MAAM,CAAC,OAAO,CAAC;QAClE,IAAI,EAAE,CAAC,MAAM,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,SAAS,IAAI,GAAG,MAAM;IACvG;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3043, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/eddsa.js"],"sourcesContent":["const { sign: signOneShot, verify: verifyOneShot } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst { edDSASupported } = require('../help/runtime_support')\n\nconst sign = ({ [KEYOBJECT]: keyObject }, payload) => {\n  if (typeof payload === 'string') {\n    payload = Buffer.from(payload)\n  }\n  return signOneShot(undefined, payload, keyObject)\n}\n\nconst verify = ({ [KEYOBJECT]: keyObject }, payload, signature) => {\n  return verifyOneShot(undefined, payload, keyObject, signature)\n}\n\nmodule.exports = (JWA, JWK) => {\n  if (edDSASupported) {\n    JWA.sign.set('EdDSA', sign)\n    JWA.verify.set('EdDSA', verify)\n    JWK.OKP.sign.EdDSA = key => key.private && JWK.OKP.verify.EdDSA(key)\n    JWK.OKP.verify.EdDSA = key => (key.use === 'sig' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('ed')\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,MAAM,WAAW,EAAE,QAAQ,aAAa,EAAE;AAElD,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM,EAAE,cAAc,EAAE;AAExB,MAAM,OAAO,CAAC,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IACxC,IAAI,OAAO,YAAY,UAAU;QAC/B,UAAU,OAAO,IAAI,CAAC;IACxB;IACA,OAAO,YAAY,WAAW,SAAS;AACzC;AAEA,MAAM,SAAS,CAAC,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS;IACnD,OAAO,cAAc,WAAW,SAAS,WAAW;AACtD;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB,IAAI,gBAAgB;QAClB,IAAI,IAAI,CAAC,GAAG,CAAC,SAAS;QACtB,IAAI,MAAM,CAAC,GAAG,CAAC,SAAS;QACxB,IAAI,GAAG,CAAC,IAAI,CAAC,KAAK,GAAG,CAAA,MAAO,IAAI,OAAO,IAAI,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,CAAC;QAChE,IAAI,GAAG,CAAC,MAAM,CAAC,KAAK,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,SAAS,CAAC,iBAAiB,CAAC,UAAU,CAAC;IAC3H;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3068, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/rsassa_pss.js"],"sourcesContent":["const {\n  createSign,\n  createVerify,\n  constants\n} = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\n\nconst sign = (nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  return createSign(nodeAlg).update(payload).sign({\n    key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  })\n}\n\nconst verify = (nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n  const key = asInput(keyObject, true)\n  return createVerify(nodeAlg).update(payload).verify({\n    key,\n    padding: constants.RSA_PKCS1_PSS_PADDING,\n    saltLength: constants.RSA_PSS_SALTLEN_DIGEST\n  }, signature)\n}\n\nconst LENGTHS = {\n  PS256: 528,\n  PS384: 784,\n  PS512: 1040\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['PS256', 'PS384', 'PS512'].forEach((jwaAlg) => {\n    const nodeAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, nodeAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, nodeAlg))\n    JWK.RSA.sign[jwaAlg] = key => key.private && JWK.RSA.verify[jwaAlg](key)\n    JWK.RSA.verify[jwaAlg] = key => (key.use === 'sig' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EACJ,UAAU,EACV,YAAY,EACZ,SAAS,EACV;AAED,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM;AACN,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM,OAAO,CAAC,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IACjD,MAAM,MAAM,QAAQ,WAAW;IAC/B,OAAO,WAAW,SAAS,MAAM,CAAC,SAAS,IAAI,CAAC;QAC9C;QACA,SAAS,UAAU,qBAAqB;QACxC,YAAY,UAAU,sBAAsB;IAC9C;AACF;AAEA,MAAM,SAAS,CAAC,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS;IAC5D,MAAM,MAAM,QAAQ,WAAW;IAC/B,OAAO,aAAa,SAAS,MAAM,CAAC,SAAS,MAAM,CAAC;QAClD;QACA,SAAS,UAAU,qBAAqB;QACxC,YAAY,UAAU,sBAAsB;IAC9C,GAAG;AACL;AAEA,MAAM,UAAU;IACd,OAAO;IACP,OAAO;IACP,OAAO;AACT;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAS;QAAS;KAAQ,CAAC,OAAO,CAAC,CAAC;QACnC,MAAM,UAAU,eAAe;QAC/B,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,WAAW;QAC1C,IAAI,MAAM,CAAC,GAAG,CAAC,QAAQ,OAAO,IAAI,CAAC,WAAW;QAC9C,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,CAAA,MAAO,IAAI,OAAO,IAAI,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC;QACpE,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,MAAM,IAAI,OAAO,CAAC,OAAO;IAC/G;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3111, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/rsassa.js"],"sourcesContent":["const { createSign, createVerify } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst resolveNodeAlg = require('../help/node_alg')\nconst { asInput } = require('../help/key_object')\n\nconst sign = (nodeAlg, { [KEYOBJECT]: keyObject }, payload) => {\n  return createSign(nodeAlg).update(payload).sign(asInput(keyObject, false))\n}\n\nconst verify = (nodeAlg, { [KEYOBJECT]: keyObject }, payload, signature) => {\n  return createVerify(nodeAlg).update(payload).verify(asInput(keyObject, true), signature)\n}\n\nconst LENGTHS = {\n  RS256: 0,\n  RS384: 624,\n  RS512: 752\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['RS256', 'RS384', 'RS512'].forEach((jwaAlg) => {\n    const nodeAlg = resolveNodeAlg(jwaAlg)\n    JWA.sign.set(jwaAlg, sign.bind(undefined, nodeAlg))\n    JWA.verify.set(jwaAlg, verify.bind(undefined, nodeAlg))\n    JWK.RSA.sign[jwaAlg] = key => key.private && JWK.RSA.verify[jwaAlg](key)\n    JWK.RSA.verify[jwaAlg] = key => (key.use === 'sig' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE,YAAY,EAAE;AAElC,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM;AACN,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM,OAAO,CAAC,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IACjD,OAAO,WAAW,SAAS,MAAM,CAAC,SAAS,IAAI,CAAC,QAAQ,WAAW;AACrE;AAEA,MAAM,SAAS,CAAC,SAAS,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS;IAC5D,OAAO,aAAa,SAAS,MAAM,CAAC,SAAS,MAAM,CAAC,QAAQ,WAAW,OAAO;AAChF;AAEA,MAAM,UAAU;IACd,OAAO;IACP,OAAO;IACP,OAAO;AACT;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAS;QAAS;KAAQ,CAAC,OAAO,CAAC,CAAC;QACnC,MAAM,UAAU,eAAe;QAC/B,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ,KAAK,IAAI,CAAC,WAAW;QAC1C,IAAI,MAAM,CAAC,GAAG,CAAC,QAAQ,OAAO,IAAI,CAAC,WAAW;QAC9C,IAAI,GAAG,CAAC,IAAI,CAAC,OAAO,GAAG,CAAA,MAAO,IAAI,OAAO,IAAI,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,CAAC;QACpE,IAAI,GAAG,CAAC,MAAM,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,MAAM,IAAI,OAAO,CAAC,OAAO;IAC/G;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3144, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/none.js"],"sourcesContent":["const sign = () => Buffer.from('')\nconst verify = (key, payload, signature) => !signature.length\n\nmodule.exports = (JWA, JWK) => {\n  JWA.sign.set('none', sign)\n  JWA.verify.set('none', verify)\n}\n"],"names":[],"mappings":"AAAA,MAAM,OAAO,IAAM,OAAO,IAAI,CAAC;AAC/B,MAAM,SAAS,CAAC,KAAK,SAAS,YAAc,CAAC,UAAU,MAAM;AAE7D,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB,IAAI,IAAI,CAAC,GAAG,CAAC,QAAQ;IACrB,IAAI,MAAM,CAAC,GAAG,CAAC,QAAQ;AACzB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3155, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/uint64be.js"],"sourcesContent":["const MAX_INT32 = Math.pow(2, 32)\n\nmodule.exports = (value, buf = Buffer.allocUnsafe(8)) => {\n  const high = Math.floor(value / MAX_INT32)\n  const low = value % MAX_INT32\n\n  buf.writeUInt32BE(high, 0)\n  buf.writeUInt32BE(low, 4)\n  return buf\n}\n"],"names":[],"mappings":"AAAA,MAAM,YAAY,KAAK,GAAG,CAAC,GAAG;AAE9B,OAAO,OAAO,GAAG,CAAC,OAAO,MAAM,OAAO,WAAW,CAAC,EAAE;IAClD,MAAM,OAAO,KAAK,KAAK,CAAC,QAAQ;IAChC,MAAM,MAAM,QAAQ;IAEpB,IAAI,aAAa,CAAC,MAAM;IACxB,IAAI,aAAa,CAAC,KAAK;IACvB,OAAO;AACT","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3168, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/aes_cbc_hmac_sha2.js"],"sourcesContent":["const { createCipheriv, createDecipheriv, getCiphers } = require('crypto')\n\nconst uint64be = require('../help/uint64be')\nconst timingSafeEqual = require('../help/timing_safe_equal')\nconst { KEYOBJECT } = require('../help/consts')\nconst { JWEInvalid, JWEDecryptionFailed } = require('../errors')\n\nconst checkInput = function (size, iv, tag) {\n  if (iv.length !== 16) {\n    throw new JWEInvalid('invalid iv')\n  }\n  if (arguments.length === 3) {\n    if (tag.length !== size / 8) {\n      throw new JWEInvalid('invalid tag')\n    }\n  }\n}\n\nconst encrypt = (size, sign, { [KEYOBJECT]: keyObject }, cleartext, { iv, aad = Buffer.alloc(0) }) => {\n  const key = keyObject.export()\n  checkInput(size, iv)\n\n  const keySize = size / 8\n  const encKey = key.slice(keySize)\n  const cipher = createCipheriv(`aes-${size}-cbc`, encKey, iv)\n  const ciphertext = Buffer.concat([cipher.update(cleartext), cipher.final()])\n  const macData = Buffer.concat([aad, iv, ciphertext, uint64be(aad.length * 8)])\n\n  const macKey = key.slice(0, keySize)\n  const tag = sign({ [KEYOBJECT]: macKey }, macData).slice(0, keySize)\n\n  return { ciphertext, tag }\n}\n\nconst decrypt = (size, sign, { [KEYOBJECT]: keyObject }, ciphertext, { iv, tag = Buffer.alloc(0), aad = Buffer.alloc(0) }) => {\n  checkInput(size, iv, tag)\n\n  const keySize = size / 8\n  const key = keyObject.export()\n  const encKey = key.slice(keySize)\n  const macKey = key.slice(0, keySize)\n\n  const macData = Buffer.concat([aad, iv, ciphertext, uint64be(aad.length * 8)])\n  const expectedTag = sign({ [KEYOBJECT]: macKey }, macData, tag).slice(0, keySize)\n  const macCheckPassed = timingSafeEqual(tag, expectedTag)\n\n  if (!macCheckPassed) {\n    throw new JWEDecryptionFailed()\n  }\n\n  let cleartext\n  try {\n    const cipher = createDecipheriv(`aes-${size}-cbc`, encKey, iv)\n    cleartext = Buffer.concat([cipher.update(ciphertext), cipher.final()])\n  } catch (err) {}\n\n  if (!cleartext) {\n    throw new JWEDecryptionFailed()\n  }\n\n  return cleartext\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['A128CBC-HS256', 'A192CBC-HS384', 'A256CBC-HS512'].forEach((jwaAlg) => {\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    const sign = JWA.sign.get(`HS${size * 2}`)\n    if (getCiphers().includes(`aes-${size}-cbc`)) {\n      JWA.encrypt.set(jwaAlg, encrypt.bind(undefined, size, sign))\n      JWA.decrypt.set(jwaAlg, decrypt.bind(undefined, size, sign))\n      JWK.oct.encrypt[jwaAlg] = JWK.oct.decrypt[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length / 2 === size\n    }\n  })\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3260, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/aes_gcm.js"],"sourcesContent":["const { createCipheriv, createDecipheriv, getCiphers } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst { JWEInvalid, JWEDecryptionFailed } = require('../errors')\nconst { asInput } = require('../help/key_object')\n\nconst checkInput = function (size, iv, tag) {\n  if (iv.length !== 12) {\n    throw new JWEInvalid('invalid iv')\n  }\n  if (arguments.length === 3) {\n    if (tag.length !== 16) {\n      throw new JWEInvalid('invalid tag')\n    }\n  }\n}\n\nconst encrypt = (size, { [KEYOBJECT]: keyObject }, cleartext, { iv, aad = Buffer.alloc(0) }) => {\n  const key = asInput(keyObject, false)\n  checkInput(size, iv)\n\n  const cipher = createCipheriv(`aes-${size}-gcm`, key, iv, { authTagLength: 16 })\n  cipher.setAAD(aad)\n\n  const ciphertext = Buffer.concat([cipher.update(cleartext), cipher.final()])\n  const tag = cipher.getAuthTag()\n\n  return { ciphertext, tag }\n}\n\nconst decrypt = (size, { [KEYOBJECT]: keyObject }, ciphertext, { iv, tag = Buffer.alloc(0), aad = Buffer.alloc(0) }) => {\n  const key = asInput(keyObject, false)\n  checkInput(size, iv, tag)\n\n  try {\n    const cipher = createDecipheriv(`aes-${size}-gcm`, key, iv, { authTagLength: 16 })\n    cipher.setAuthTag(tag)\n    cipher.setAAD(aad)\n\n    return Buffer.concat([cipher.update(ciphertext), cipher.final()])\n  } catch (err) {\n    throw new JWEDecryptionFailed()\n  }\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['A128GCM', 'A192GCM', 'A256GCM'].forEach((jwaAlg) => {\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    if (getCiphers().includes(`aes-${size}-gcm`)) {\n      JWA.encrypt.set(jwaAlg, encrypt.bind(undefined, size))\n      JWA.decrypt.set(jwaAlg, decrypt.bind(undefined, size))\n      JWK.oct.encrypt[jwaAlg] = JWK.oct.decrypt[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length === size\n    }\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,cAAc,EAAE,gBAAgB,EAAE,UAAU,EAAE;AAEtD,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM,EAAE,UAAU,EAAE,mBAAmB,EAAE;AACzC,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM,aAAa,SAAU,IAAI,EAAE,EAAE,EAAE,GAAG;IACxC,IAAI,GAAG,MAAM,KAAK,IAAI;QACpB,MAAM,IAAI,WAAW;IACvB;IACA,IAAI,UAAU,MAAM,KAAK,GAAG;QAC1B,IAAI,IAAI,MAAM,KAAK,IAAI;YACrB,MAAM,IAAI,WAAW;QACvB;IACF;AACF;AAEA,MAAM,UAAU,CAAC,MAAM,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,WAAW,EAAE,EAAE,EAAE,MAAM,OAAO,KAAK,CAAC,EAAE,EAAE;IACzF,MAAM,MAAM,QAAQ,WAAW;IAC/B,WAAW,MAAM;IAEjB,MAAM,SAAS,eAAe,CAAC,IAAI,EAAE,KAAK,IAAI,CAAC,EAAE,KAAK,IAAI;QAAE,eAAe;IAAG;IAC9E,OAAO,MAAM,CAAC;IAEd,MAAM,aAAa,OAAO,MAAM,CAAC;QAAC,OAAO,MAAM,CAAC;QAAY,OAAO,KAAK;KAAG;IAC3E,MAAM,MAAM,OAAO,UAAU;IAE7B,OAAO;QAAE;QAAY;IAAI;AAC3B;AAEA,MAAM,UAAU,CAAC,MAAM,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,YAAY,EAAE,EAAE,EAAE,MAAM,OAAO,KAAK,CAAC,EAAE,EAAE,MAAM,OAAO,KAAK,CAAC,EAAE,EAAE;IACjH,MAAM,MAAM,QAAQ,WAAW;IAC/B,WAAW,MAAM,IAAI;IAErB,IAAI;QACF,MAAM,SAAS,iBAAiB,CAAC,IAAI,EAAE,KAAK,IAAI,CAAC,EAAE,KAAK,IAAI;YAAE,eAAe;QAAG;QAChF,OAAO,UAAU,CAAC;QAClB,OAAO,MAAM,CAAC;QAEd,OAAO,OAAO,MAAM,CAAC;YAAC,OAAO,MAAM,CAAC;YAAa,OAAO,KAAK;SAAG;IAClE,EAAE,OAAO,KAAK;QACZ,MAAM,IAAI;IACZ;AACF;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAW;QAAW;KAAU,CAAC,OAAO,CAAC,CAAC;QACzC,MAAM,OAAO,SAAS,OAAO,MAAM,CAAC,GAAG,IAAI;QAC3C,IAAI,aAAa,QAAQ,CAAC,CAAC,IAAI,EAAE,KAAK,IAAI,CAAC,GAAG;YAC5C,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,QAAQ,IAAI,CAAC,WAAW;YAChD,IAAI,OAAO,CAAC,GAAG,CAAC,QAAQ,QAAQ,IAAI,CAAC,WAAW;YAChD,IAAI,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,MAAM,KAAK;QAC5H;IACF;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3327, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/rsaes.js"],"sourcesContent":["const { publicEncrypt, privateDecrypt, constants } = require('crypto')\n\nconst { oaepHashSupported } = require('../help/runtime_support')\nconst { KEYOBJECT } = require('../help/consts')\nconst { asInput } = require('../help/key_object')\n\nconst resolvePadding = (alg) => {\n  switch (alg) {\n    case 'RSA-OAEP':\n    case 'RSA-OAEP-256':\n    case 'RSA-OAEP-384':\n    case 'RSA-OAEP-512':\n      return constants.RSA_PKCS1_OAEP_PADDING\n    case 'RSA1_5':\n      return constants.RSA_PKCS1_PADDING\n  }\n}\n\nconst resolveOaepHash = (alg) => {\n  switch (alg) {\n    case 'RSA-OAEP':\n      return 'sha1'\n    case 'RSA-OAEP-256':\n      return 'sha256'\n    case 'RSA-OAEP-384':\n      return 'sha384'\n    case 'RSA-OAEP-512':\n      return 'sha512'\n    default:\n      return undefined\n  }\n}\n\nconst wrapKey = (padding, oaepHash, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, true)\n  return { wrapped: publicEncrypt({ key, oaepHash, padding }, payload) }\n}\n\nconst unwrapKey = (padding, oaepHash, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  return privateDecrypt({ key, oaepHash, padding }, payload)\n}\n\nconst LENGTHS = {\n  RSA1_5: 0,\n  'RSA-OAEP': 592,\n  'RSA-OAEP-256': 784,\n  'RSA-OAEP-384': 1040,\n  'RSA-OAEP-512': 1296\n}\n\nmodule.exports = (JWA, JWK) => {\n  const algs = ['RSA-OAEP', 'RSA1_5']\n\n  if (oaepHashSupported) {\n    algs.splice(1, 0, 'RSA-OAEP-256', 'RSA-OAEP-384', 'RSA-OAEP-512')\n  }\n\n  algs.forEach((jwaAlg) => {\n    const padding = resolvePadding(jwaAlg)\n    const oaepHash = resolveOaepHash(jwaAlg)\n    JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, padding, oaepHash))\n    JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, padding, oaepHash))\n    JWK.RSA.wrapKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n    JWK.RSA.unwrapKey[jwaAlg] = key => key.private && (key.use === 'enc' || key.use === undefined) && key.length >= LENGTHS[jwaAlg]\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,aAAa,EAAE,cAAc,EAAE,SAAS,EAAE;AAElD,MAAM,EAAE,iBAAiB,EAAE;AAC3B,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM,iBAAiB,CAAC;IACtB,OAAQ;QACN,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,UAAU,sBAAsB;QACzC,KAAK;YACH,OAAO,UAAU,iBAAiB;IACtC;AACF;AAEA,MAAM,kBAAkB,CAAC;IACvB,OAAQ;QACN,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT,KAAK;YACH,OAAO;QACT;YACE,OAAO;IACX;AACF;AAEA,MAAM,UAAU,CAAC,SAAS,UAAU,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IAC9D,MAAM,MAAM,QAAQ,WAAW;IAC/B,OAAO;QAAE,SAAS,cAAc;YAAE;YAAK;YAAU;QAAQ,GAAG;IAAS;AACvE;AAEA,MAAM,YAAY,CAAC,SAAS,UAAU,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IAChE,MAAM,MAAM,QAAQ,WAAW;IAC/B,OAAO,eAAe;QAAE;QAAK;QAAU;IAAQ,GAAG;AACpD;AAEA,MAAM,UAAU;IACd,QAAQ;IACR,YAAY;IACZ,gBAAgB;IAChB,gBAAgB;IAChB,gBAAgB;AAClB;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB,MAAM,OAAO;QAAC;QAAY;KAAS;IAEnC,IAAI,mBAAmB;QACrB,KAAK,MAAM,CAAC,GAAG,GAAG,gBAAgB,gBAAgB;IACpD;IAEA,KAAK,OAAO,CAAC,CAAC;QACZ,MAAM,UAAU,eAAe;QAC/B,MAAM,WAAW,gBAAgB;QACjC,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,QAAQ,IAAI,CAAC,WAAW,SAAS;QACtE,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,UAAU,IAAI,CAAC,WAAW,SAAS;QACxE,IAAI,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,MAAM,IAAI,OAAO,CAAC,OAAO;QAC9G,IAAI,GAAG,CAAC,SAAS,CAAC,OAAO,GAAG,CAAA,MAAO,IAAI,OAAO,IAAI,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,MAAM,IAAI,OAAO,CAAC,OAAO;IACjI;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3403, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/aes_kw.js"],"sourcesContent":["const { createCipheriv, createDecipheriv, getCiphers } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst { asInput } = require('../help/key_object')\n\nconst checkInput = (data) => {\n  if (data !== undefined && data.length % 8 !== 0) {\n    throw new Error('invalid data length')\n  }\n}\n\nconst wrapKey = (alg, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  const cipher = createCipheriv(alg, key, Buffer.alloc(8, 'a6', 'hex'))\n\n  return { wrapped: Buffer.concat([cipher.update(payload), cipher.final()]) }\n}\n\nconst unwrapKey = (alg, { [KEYOBJECT]: keyObject }, payload) => {\n  const key = asInput(keyObject, false)\n  checkInput(payload)\n  const cipher = createDecipheriv(alg, key, Buffer.alloc(8, 'a6', 'hex'))\n\n  return Buffer.concat([cipher.update(payload), cipher.final()])\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['A128KW', 'A192KW', 'A256KW'].forEach((jwaAlg) => {\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    const alg = `aes${size}-wrap`\n    if (getCiphers().includes(alg)) {\n      JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, alg))\n      JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, alg))\n      JWK.oct.wrapKey[jwaAlg] = JWK.oct.unwrapKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length === size\n    }\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,cAAc,EAAE,gBAAgB,EAAE,UAAU,EAAE;AAEtD,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM,aAAa,CAAC;IAClB,IAAI,SAAS,aAAa,KAAK,MAAM,GAAG,MAAM,GAAG;QAC/C,MAAM,IAAI,MAAM;IAClB;AACF;AAEA,MAAM,UAAU,CAAC,KAAK,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IAChD,MAAM,MAAM,QAAQ,WAAW;IAC/B,MAAM,SAAS,eAAe,KAAK,KAAK,OAAO,KAAK,CAAC,GAAG,MAAM;IAE9D,OAAO;QAAE,SAAS,OAAO,MAAM,CAAC;YAAC,OAAO,MAAM,CAAC;YAAU,OAAO,KAAK;SAAG;IAAE;AAC5E;AAEA,MAAM,YAAY,CAAC,KAAK,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IAClD,MAAM,MAAM,QAAQ,WAAW;IAC/B,WAAW;IACX,MAAM,SAAS,iBAAiB,KAAK,KAAK,OAAO,KAAK,CAAC,GAAG,MAAM;IAEhE,OAAO,OAAO,MAAM,CAAC;QAAC,OAAO,MAAM,CAAC;QAAU,OAAO,KAAK;KAAG;AAC/D;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAU;QAAU;KAAS,CAAC,OAAO,CAAC,CAAC;QACtC,MAAM,OAAO,SAAS,OAAO,MAAM,CAAC,GAAG,IAAI;QAC3C,MAAM,MAAM,CAAC,GAAG,EAAE,KAAK,KAAK,CAAC;QAC7B,IAAI,aAAa,QAAQ,CAAC,MAAM;YAC9B,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,QAAQ,IAAI,CAAC,WAAW;YAC7D,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,UAAU,IAAI,CAAC,WAAW;YAC/D,IAAI,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,GAAG,CAAC,SAAS,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,MAAM,KAAK;QAC9H;IACF;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3450, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/aes_gcm_kw.js"],"sourcesContent":["const generateIV = require('../help/generate_iv')\nconst base64url = require('../help/base64url')\n\nmodule.exports = (JWA, JWK) => {\n  ['A128GCMKW', 'A192GCMKW', 'A256GCMKW'].forEach((jwaAlg) => {\n    const encAlg = jwaAlg.substr(0, 7)\n    const size = parseInt(jwaAlg.substr(1, 3), 10)\n    const encrypt = JWA.encrypt.get(encAlg)\n    const decrypt = JWA.decrypt.get(encAlg)\n\n    if (encrypt && decrypt) {\n      JWA.keyManagementEncrypt.set(jwaAlg, (key, payload) => {\n        const iv = generateIV(jwaAlg)\n        const { ciphertext, tag } = encrypt(key, payload, { iv })\n        return {\n          wrapped: ciphertext,\n          header: { tag: base64url.encodeBuffer(tag), iv: base64url.encodeBuffer(iv) }\n        }\n      })\n      JWA.keyManagementDecrypt.set(jwaAlg, decrypt)\n      JWK.oct.wrapKey[jwaAlg] = JWK.oct.unwrapKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.length === size\n    }\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AAEN,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAa;QAAa;KAAY,CAAC,OAAO,CAAC,CAAC;QAC/C,MAAM,SAAS,OAAO,MAAM,CAAC,GAAG;QAChC,MAAM,OAAO,SAAS,OAAO,MAAM,CAAC,GAAG,IAAI;QAC3C,MAAM,UAAU,IAAI,OAAO,CAAC,GAAG,CAAC;QAChC,MAAM,UAAU,IAAI,OAAO,CAAC,GAAG,CAAC;QAEhC,IAAI,WAAW,SAAS;YACtB,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,CAAC,KAAK;gBACzC,MAAM,KAAK,WAAW;gBACtB,MAAM,EAAE,UAAU,EAAE,GAAG,EAAE,GAAG,QAAQ,KAAK,SAAS;oBAAE;gBAAG;gBACvD,OAAO;oBACL,SAAS;oBACT,QAAQ;wBAAE,KAAK,UAAU,YAAY,CAAC;wBAAM,IAAI,UAAU,YAAY,CAAC;oBAAI;gBAC7E;YACF;YACA,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ;YACrC,IAAI,GAAG,CAAC,OAAO,CAAC,OAAO,GAAG,IAAI,GAAG,CAAC,SAAS,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,MAAM,KAAK;QAC9H;IACF;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3486, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/pbes2.js"],"sourcesContent":["const { pbkdf2Sync: pbkdf2, randomBytes } = require('crypto')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst base64url = require('../help/base64url')\n\nconst SALT_LENGTH = 16\nconst NULL_BUFFER = Buffer.alloc(1, 0)\n\nconst concatSalt = (alg, p2s) => {\n  return Buffer.concat([\n    Buffer.from(alg, 'utf8'),\n    NULL_BUFFER,\n    p2s\n  ])\n}\n\nconst wrapKey = (keylen, sha, concat, wrap, { [KEYOBJECT]: keyObject }, payload) => {\n  // Note that if password-based encryption is used for multiple\n  // recipients, it is expected that each recipient use different values\n  // for the PBES2 parameters \"p2s\" and \"p2c\".\n  // here we generate p2c between 2048 and 4096 and random p2s\n  const p2c = Math.floor((Math.random() * 2049) + 2048)\n  const p2s = randomBytes(SALT_LENGTH)\n  const salt = concat(p2s)\n\n  const derivedKey = pbkdf2(keyObject.export(), salt, p2c, keylen, sha)\n\n  const result = wrap({ [KEYOBJECT]: derivedKey }, payload)\n  result.header = result.header || {}\n  Object.assign(result.header, { p2c, p2s: base64url.encodeBuffer(p2s) })\n\n  return result\n}\n\nconst unwrapKey = (keylen, sha, concat, unwrap, { [KEYOBJECT]: keyObject }, payload, header) => {\n  const { p2s, p2c } = header\n  const salt = concat(p2s)\n  const derivedKey = pbkdf2(keyObject.export(), salt, p2c, keylen, sha)\n  return unwrap({ [KEYOBJECT]: derivedKey }, payload, header)\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['PBES2-HS256+A128KW', 'PBES2-HS384+A192KW', 'PBES2-HS512+A256KW'].forEach((jwaAlg) => {\n    const kw = jwaAlg.substr(-6)\n    const kwWrap = JWA.keyManagementEncrypt.get(kw)\n    const kwUnwrap = JWA.keyManagementDecrypt.get(kw)\n    const keylen = parseInt(jwaAlg.substr(13, 3), 10) / 8\n    const sha = `sha${jwaAlg.substr(8, 3)}`\n\n    if (kwWrap && kwUnwrap) {\n      JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, keylen, sha, concatSalt.bind(undefined, jwaAlg), kwWrap))\n      JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, keylen, sha, concatSalt.bind(undefined, jwaAlg), kwUnwrap))\n      JWK.oct.deriveKey[jwaAlg] = key => key.use === 'enc' || key.use === undefined\n    }\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,YAAY,MAAM,EAAE,WAAW,EAAE;AAEzC,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM;AAEN,MAAM,cAAc;AACpB,MAAM,cAAc,OAAO,KAAK,CAAC,GAAG;AAEpC,MAAM,aAAa,CAAC,KAAK;IACvB,OAAO,OAAO,MAAM,CAAC;QACnB,OAAO,IAAI,CAAC,KAAK;QACjB;QACA;KACD;AACH;AAEA,MAAM,UAAU,CAAC,QAAQ,KAAK,QAAQ,MAAM,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE;IACtE,8DAA8D;IAC9D,sEAAsE;IACtE,4CAA4C;IAC5C,4DAA4D;IAC5D,MAAM,MAAM,KAAK,KAAK,CAAC,AAAC,KAAK,MAAM,KAAK,OAAQ;IAChD,MAAM,MAAM,YAAY;IACxB,MAAM,OAAO,OAAO;IAEpB,MAAM,aAAa,OAAO,UAAU,MAAM,IAAI,MAAM,KAAK,QAAQ;IAEjE,MAAM,SAAS,KAAK;QAAE,CAAC,UAAU,EAAE;IAAW,GAAG;IACjD,OAAO,MAAM,GAAG,OAAO,MAAM,IAAI,CAAC;IAClC,OAAO,MAAM,CAAC,OAAO,MAAM,EAAE;QAAE;QAAK,KAAK,UAAU,YAAY,CAAC;IAAK;IAErE,OAAO;AACT;AAEA,MAAM,YAAY,CAAC,QAAQ,KAAK,QAAQ,QAAQ,EAAE,CAAC,UAAU,EAAE,SAAS,EAAE,EAAE,SAAS;IACnF,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG;IACrB,MAAM,OAAO,OAAO;IACpB,MAAM,aAAa,OAAO,UAAU,MAAM,IAAI,MAAM,KAAK,QAAQ;IACjE,OAAO,OAAO;QAAE,CAAC,UAAU,EAAE;IAAW,GAAG,SAAS;AACtD;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAsB;QAAsB;KAAqB,CAAC,OAAO,CAAC,CAAC;QAC1E,MAAM,KAAK,OAAO,MAAM,CAAC,CAAC;QAC1B,MAAM,SAAS,IAAI,oBAAoB,CAAC,GAAG,CAAC;QAC5C,MAAM,WAAW,IAAI,oBAAoB,CAAC,GAAG,CAAC;QAC9C,MAAM,SAAS,SAAS,OAAO,MAAM,CAAC,IAAI,IAAI,MAAM;QACpD,MAAM,MAAM,CAAC,GAAG,EAAE,OAAO,MAAM,CAAC,GAAG,IAAI;QAEvC,IAAI,UAAU,UAAU;YACtB,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,QAAQ,IAAI,CAAC,WAAW,QAAQ,KAAK,WAAW,IAAI,CAAC,WAAW,SAAS;YAC9G,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,UAAU,IAAI,CAAC,WAAW,QAAQ,KAAK,WAAW,IAAI,CAAC,WAAW,SAAS;YAChH,IAAI,GAAG,CAAC,SAAS,CAAC,OAAO,GAAG,CAAA,MAAO,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK;QACtE;IACF;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3548, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/ecdh/compute_secret.js"],"sourcesContent":["const { improvedDH } = require('../../help/runtime_support')\n\nif (improvedDH) {\n  const { diffieHellman } = require('crypto')\n\n  const { KeyObject } = require('../../help/key_object')\n  const importKey = require('../../jwk/import')\n\n  module.exports = ({ keyObject: privateKey }, publicKey) => {\n    if (!(publicKey instanceof KeyObject)) {\n      ({ keyObject: publicKey } = importKey(publicKey))\n    }\n\n    return diffieHellman({ privateKey, publicKey })\n  }\n} else {\n  const { createECDH, constants: { POINT_CONVERSION_UNCOMPRESSED } } = require('crypto')\n\n  const base64url = require('../../help/base64url')\n\n  const crvToCurve = (crv) => {\n    switch (crv) {\n      case 'P-256':\n        return 'prime256v1'\n      case 'P-384':\n        return 'secp384r1'\n      case 'P-521':\n        return 'secp521r1'\n    }\n  }\n\n  const UNCOMPRESSED = Buffer.alloc(1, POINT_CONVERSION_UNCOMPRESSED)\n  const pubToBuffer = (x, y) => Buffer.concat([UNCOMPRESSED, base64url.decodeToBuffer(x), base64url.decodeToBuffer(y)])\n\n  module.exports = ({ crv, d }, { x, y }) => {\n    const curve = crvToCurve(crv)\n    const exchange = createECDH(curve)\n\n    exchange.setPrivateKey(base64url.decodeToBuffer(d))\n\n    return exchange.computeSecret(pubToBuffer(x, y))\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE;AAEpB,IAAI,YAAY;IACd,MAAM,EAAE,aAAa,EAAE;IAEvB,MAAM,EAAE,SAAS,EAAE;IACnB,MAAM;IAEN,OAAO,OAAO,GAAG,CAAC,EAAE,WAAW,UAAU,EAAE,EAAE;QAC3C,IAAI,CAAC,CAAC,qBAAqB,SAAS,GAAG;YACrC,CAAC,EAAE,WAAW,SAAS,EAAE,GAAG,UAAU,UAAU;QAClD;QAEA,OAAO,cAAc;YAAE;YAAY;QAAU;IAC/C;AACF,OAAO;IACL,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE,6BAA6B,EAAE,EAAE;IAElE,MAAM;IAEN,MAAM,aAAa,CAAC;QAClB,OAAQ;YACN,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;YACT,KAAK;gBACH,OAAO;QACX;IACF;IAEA,MAAM,eAAe,OAAO,KAAK,CAAC,GAAG;IACrC,MAAM,cAAc,CAAC,GAAG,IAAM,OAAO,MAAM,CAAC;YAAC;YAAc,UAAU,cAAc,CAAC;YAAI,UAAU,cAAc,CAAC;SAAG;IAEpH,OAAO,OAAO,GAAG,CAAC,EAAE,GAAG,EAAE,CAAC,EAAE,EAAE,EAAE,CAAC,EAAE,CAAC,EAAE;QACpC,MAAM,QAAQ,WAAW;QACzB,MAAM,WAAW,WAAW;QAE5B,SAAS,aAAa,CAAC,UAAU,cAAc,CAAC;QAEhD,OAAO,SAAS,aAAa,CAAC,YAAY,GAAG;IAC/C;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3593, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/ecdh/derive.js"],"sourcesContent":["const { createHash } = require('crypto')\nconst ecdhComputeSecret = require('./compute_secret')\n\nconst concat = (key, length, value) => {\n  const iterations = Math.ceil(length / 32)\n  let res\n\n  for (let iter = 1; iter <= iterations; iter++) {\n    const buf = Buffer.allocUnsafe(4 + key.length + value.length)\n    buf.writeUInt32BE(iter, 0)\n    key.copy(buf, 4)\n    value.copy(buf, 4 + key.length)\n    if (!res) {\n      res = createHash('sha256').update(buf).digest()\n    } else {\n      res = Buffer.concat([res, createHash('sha256').update(buf).digest()])\n    }\n  }\n\n  return res.slice(0, length)\n}\n\nconst uint32be = (value, buf = Buffer.allocUnsafe(4)) => {\n  buf.writeUInt32BE(value)\n  return buf\n}\n\nconst lengthAndInput = input => Buffer.concat([uint32be(input.length), input])\n\nmodule.exports = (alg, keyLen, privKey, pubKey, { apu = Buffer.alloc(0), apv = Buffer.alloc(0) } = {}, computeSecret = ecdhComputeSecret) => {\n  const value = Buffer.concat([\n    lengthAndInput(Buffer.from(alg)),\n    lengthAndInput(apu),\n    lengthAndInput(apv),\n    uint32be(keyLen)\n  ])\n\n  const sharedSecret = computeSecret(privKey, pubKey)\n  return concat(sharedSecret, keyLen / 8, value)\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE;AACpB,MAAM;AAEN,MAAM,SAAS,CAAC,KAAK,QAAQ;IAC3B,MAAM,aAAa,KAAK,IAAI,CAAC,SAAS;IACtC,IAAI;IAEJ,IAAK,IAAI,OAAO,GAAG,QAAQ,YAAY,OAAQ;QAC7C,MAAM,MAAM,OAAO,WAAW,CAAC,IAAI,IAAI,MAAM,GAAG,MAAM,MAAM;QAC5D,IAAI,aAAa,CAAC,MAAM;QACxB,IAAI,IAAI,CAAC,KAAK;QACd,MAAM,IAAI,CAAC,KAAK,IAAI,IAAI,MAAM;QAC9B,IAAI,CAAC,KAAK;YACR,MAAM,WAAW,UAAU,MAAM,CAAC,KAAK,MAAM;QAC/C,OAAO;YACL,MAAM,OAAO,MAAM,CAAC;gBAAC;gBAAK,WAAW,UAAU,MAAM,CAAC,KAAK,MAAM;aAAG;QACtE;IACF;IAEA,OAAO,IAAI,KAAK,CAAC,GAAG;AACtB;AAEA,MAAM,WAAW,CAAC,OAAO,MAAM,OAAO,WAAW,CAAC,EAAE;IAClD,IAAI,aAAa,CAAC;IAClB,OAAO;AACT;AAEA,MAAM,iBAAiB,CAAA,QAAS,OAAO,MAAM,CAAC;QAAC,SAAS,MAAM,MAAM;QAAG;KAAM;AAE7E,OAAO,OAAO,GAAG,CAAC,KAAK,QAAQ,SAAS,QAAQ,EAAE,MAAM,OAAO,KAAK,CAAC,EAAE,EAAE,MAAM,OAAO,KAAK,CAAC,EAAE,EAAE,GAAG,CAAC,CAAC,EAAE,gBAAgB,iBAAiB;IACtI,MAAM,QAAQ,OAAO,MAAM,CAAC;QAC1B,eAAe,OAAO,IAAI,CAAC;QAC3B,eAAe;QACf,eAAe;QACf,SAAS;KACV;IAED,MAAM,eAAe,cAAc,SAAS;IAC5C,OAAO,OAAO,cAAc,SAAS,GAAG;AAC1C","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3637, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/ecdh/dir.js"],"sourcesContent":["const { improvedDH } = require('../../help/runtime_support')\nconst { KEYLENGTHS } = require('../../registry')\nconst { generateSync } = require('../../jwk/generate')\n\nconst derive = require('./derive')\n\nconst wrapKey = (key, payload, { enc }) => {\n  const epk = generateSync(key.kty, key.crv)\n\n  const derivedKey = derive(enc, KEYLENGTHS.get(enc), epk, key)\n\n  return {\n    wrapped: derivedKey,\n    header: { epk: { kty: key.kty, crv: key.crv, x: epk.x, y: epk.y } }\n  }\n}\n\nconst unwrapKey = (key, payload, header) => {\n  const { enc, epk } = header\n  return derive(enc, KEYLENGTHS.get(enc), key, epk, header)\n}\n\nmodule.exports = (JWA, JWK) => {\n  JWA.keyManagementEncrypt.set('ECDH-ES', wrapKey)\n  JWA.keyManagementDecrypt.set('ECDH-ES', unwrapKey)\n  JWK.EC.deriveKey['ECDH-ES'] = key => (key.use === 'enc' || key.use === undefined) && key.crv !== 'secp256k1'\n\n  if (improvedDH) {\n    JWK.OKP.deriveKey['ECDH-ES'] = key => (key.use === 'enc' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('x')\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE;AACpB,MAAM,EAAE,UAAU,EAAE;AACpB,MAAM,EAAE,YAAY,EAAE;AAEtB,MAAM;AAEN,MAAM,UAAU,CAAC,KAAK,SAAS,EAAE,GAAG,EAAE;IACpC,MAAM,MAAM,aAAa,IAAI,GAAG,EAAE,IAAI,GAAG;IAEzC,MAAM,aAAa,OAAO,KAAK,WAAW,GAAG,CAAC,MAAM,KAAK;IAEzD,OAAO;QACL,SAAS;QACT,QAAQ;YAAE,KAAK;gBAAE,KAAK,IAAI,GAAG;gBAAE,KAAK,IAAI,GAAG;gBAAE,GAAG,IAAI,CAAC;gBAAE,GAAG,IAAI,CAAC;YAAC;QAAE;IACpE;AACF;AAEA,MAAM,YAAY,CAAC,KAAK,SAAS;IAC/B,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE,GAAG;IACrB,OAAO,OAAO,KAAK,WAAW,GAAG,CAAC,MAAM,KAAK,KAAK;AACpD;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB,IAAI,oBAAoB,CAAC,GAAG,CAAC,WAAW;IACxC,IAAI,oBAAoB,CAAC,GAAG,CAAC,WAAW;IACxC,IAAI,EAAE,CAAC,SAAS,CAAC,UAAU,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,GAAG,KAAK;IAEjG,IAAI,YAAY;QACd,IAAI,GAAG,CAAC,SAAS,CAAC,UAAU,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,SAAS,CAAC,iBAAiB,CAAC,UAAU,CAAC;IACnI;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3673, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/ecdh/kw.js"],"sourcesContent":["const { improvedDH } = require('../../help/runtime_support')\nconst { KEYOBJECT } = require('../../help/consts')\nconst { generateSync } = require('../../jwk/generate')\nconst { ECDH_DERIVE_LENGTHS } = require('../../registry')\n\nconst derive = require('./derive')\n\nconst wrapKey = (wrap, derive, key, payload) => {\n  const epk = generateSync(key.kty, key.crv)\n\n  const derivedKey = derive(epk, key, payload)\n\n  const result = wrap({ [KEYOBJECT]: derivedKey }, payload)\n  result.header = result.header || {}\n  Object.assign(result.header, { epk: { kty: key.kty, crv: key.crv, x: epk.x, y: epk.y } })\n\n  return result\n}\n\nconst unwrapKey = (unwrap, derive, key, payload, header) => {\n  const { epk } = header\n  const derivedKey = derive(key, epk, header)\n\n  return unwrap({ [KEYOBJECT]: derivedKey }, payload, header)\n}\n\nmodule.exports = (JWA, JWK) => {\n  ['ECDH-ES+A128KW', 'ECDH-ES+A192KW', 'ECDH-ES+A256KW'].forEach((jwaAlg) => {\n    const kw = jwaAlg.substr(-6)\n    const kwWrap = JWA.keyManagementEncrypt.get(kw)\n    const kwUnwrap = JWA.keyManagementDecrypt.get(kw)\n    const keylen = parseInt(jwaAlg.substr(9, 3), 10)\n    ECDH_DERIVE_LENGTHS.set(jwaAlg, keylen)\n\n    if (kwWrap && kwUnwrap) {\n      JWA.keyManagementEncrypt.set(jwaAlg, wrapKey.bind(undefined, kwWrap, derive.bind(undefined, jwaAlg, keylen)))\n      JWA.keyManagementDecrypt.set(jwaAlg, unwrapKey.bind(undefined, kwUnwrap, derive.bind(undefined, jwaAlg, keylen)))\n      JWK.EC.deriveKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.crv !== 'secp256k1'\n\n      if (improvedDH) {\n        JWK.OKP.deriveKey[jwaAlg] = key => (key.use === 'enc' || key.use === undefined) && key.keyObject.asymmetricKeyType.startsWith('x')\n      }\n    }\n  })\n}\nmodule.exports.wrapKey = wrapKey\nmodule.exports.unwrapKey = unwrapKey\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE;AACpB,MAAM,EAAE,SAAS,EAAE;AACnB,MAAM,EAAE,YAAY,EAAE;AACtB,MAAM,EAAE,mBAAmB,EAAE;AAE7B,MAAM;AAEN,MAAM,UAAU,CAAC,MAAM,QAAQ,KAAK;IAClC,MAAM,MAAM,aAAa,IAAI,GAAG,EAAE,IAAI,GAAG;IAEzC,MAAM,aAAa,OAAO,KAAK,KAAK;IAEpC,MAAM,SAAS,KAAK;QAAE,CAAC,UAAU,EAAE;IAAW,GAAG;IACjD,OAAO,MAAM,GAAG,OAAO,MAAM,IAAI,CAAC;IAClC,OAAO,MAAM,CAAC,OAAO,MAAM,EAAE;QAAE,KAAK;YAAE,KAAK,IAAI,GAAG;YAAE,KAAK,IAAI,GAAG;YAAE,GAAG,IAAI,CAAC;YAAE,GAAG,IAAI,CAAC;QAAC;IAAE;IAEvF,OAAO;AACT;AAEA,MAAM,YAAY,CAAC,QAAQ,QAAQ,KAAK,SAAS;IAC/C,MAAM,EAAE,GAAG,EAAE,GAAG;IAChB,MAAM,aAAa,OAAO,KAAK,KAAK;IAEpC,OAAO,OAAO;QAAE,CAAC,UAAU,EAAE;IAAW,GAAG,SAAS;AACtD;AAEA,OAAO,OAAO,GAAG,CAAC,KAAK;IACrB;QAAC;QAAkB;QAAkB;KAAiB,CAAC,OAAO,CAAC,CAAC;QAC9D,MAAM,KAAK,OAAO,MAAM,CAAC,CAAC;QAC1B,MAAM,SAAS,IAAI,oBAAoB,CAAC,GAAG,CAAC;QAC5C,MAAM,WAAW,IAAI,oBAAoB,CAAC,GAAG,CAAC;QAC9C,MAAM,SAAS,SAAS,OAAO,MAAM,CAAC,GAAG,IAAI;QAC7C,oBAAoB,GAAG,CAAC,QAAQ;QAEhC,IAAI,UAAU,UAAU;YACtB,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,QAAQ,IAAI,CAAC,WAAW,QAAQ,OAAO,IAAI,CAAC,WAAW,QAAQ;YACpG,IAAI,oBAAoB,CAAC,GAAG,CAAC,QAAQ,UAAU,IAAI,CAAC,WAAW,UAAU,OAAO,IAAI,CAAC,WAAW,QAAQ;YACxG,IAAI,EAAE,CAAC,SAAS,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,GAAG,KAAK;YAE9F,IAAI,YAAY;gBACd,IAAI,GAAG,CAAC,SAAS,CAAC,OAAO,GAAG,CAAA,MAAO,CAAC,IAAI,GAAG,KAAK,SAAS,IAAI,GAAG,KAAK,SAAS,KAAK,IAAI,SAAS,CAAC,iBAAiB,CAAC,UAAU,CAAC;YAChI;QACF;IACF;AACF;AACA,OAAO,OAAO,CAAC,OAAO,GAAG;AACzB,OAAO,OAAO,CAAC,SAAS,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3730, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwa/index.js"],"sourcesContent":["const { JWKKeySupport, JOSENotSupported } = require('../errors')\nconst { KEY_MANAGEMENT_ENCRYPT, KEY_MANAGEMENT_DECRYPT } = require('../help/consts')\n\nconst { JWA, JWK } = require('../registry')\n\n// sign, verify\nrequire('./hmac')(JWA, JWK)\nrequire('./ecdsa')(JWA, JWK)\nrequire('./eddsa')(JWA, JWK)\nrequire('./rsassa_pss')(JWA, JWK)\nrequire('./rsassa')(JWA, JWK)\nrequire('./none')(JWA)\n\n// encrypt, decrypt\nrequire('./aes_cbc_hmac_sha2')(JWA, JWK)\nrequire('./aes_gcm')(JWA, JWK)\n\n// wrapKey, unwrapKey\nrequire('./rsaes')(JWA, JWK)\nrequire('./aes_kw')(JWA, JWK)\nrequire('./aes_gcm_kw')(JWA, JWK)\n\n// deriveKey\nrequire('./pbes2')(JWA, JWK)\nrequire('./ecdh/dir')(JWA, JWK)\nrequire('./ecdh/kw')(JWA, JWK)\n\nconst check = (key, op, alg) => {\n  const cache = `_${op}_${alg}`\n\n  let label\n  let keyOp\n  if (op === 'keyManagementEncrypt') {\n    label = 'key management (encryption)'\n    keyOp = KEY_MANAGEMENT_ENCRYPT\n  } else if (op === 'keyManagementDecrypt') {\n    label = 'key management (decryption)'\n    keyOp = KEY_MANAGEMENT_DECRYPT\n  }\n\n  if (cache in key) {\n    if (key[cache]) {\n      return\n    }\n    throw new JWKKeySupport(`the key does not support ${alg} ${label || op} algorithm`)\n  }\n\n  let value = true\n  if (!JWA[op].has(alg)) {\n    throw new JOSENotSupported(`unsupported ${label || op} alg: ${alg}`)\n  } else if (!key.algorithms(keyOp).has(alg)) {\n    value = false\n  }\n\n  Object.defineProperty(key, cache, { value, enumerable: false })\n\n  if (!value) {\n    return check(key, op, alg)\n  }\n}\n\nmodule.exports = {\n  check,\n  sign: (alg, key, payload) => {\n    check(key, 'sign', alg)\n    return JWA.sign.get(alg)(key, payload)\n  },\n  verify: (alg, key, payload, signature) => {\n    check(key, 'verify', alg)\n    return JWA.verify.get(alg)(key, payload, signature)\n  },\n  keyManagementEncrypt: (alg, key, payload, opts) => {\n    check(key, 'keyManagementEncrypt', alg)\n    return JWA.keyManagementEncrypt.get(alg)(key, payload, opts)\n  },\n  keyManagementDecrypt: (alg, key, payload, opts) => {\n    check(key, 'keyManagementDecrypt', alg)\n    return JWA.keyManagementDecrypt.get(alg)(key, payload, opts)\n  },\n  encrypt: (alg, key, cleartext, opts) => {\n    check(key, 'encrypt', alg)\n    return JWA.encrypt.get(alg)(key, cleartext, opts)\n  },\n  decrypt: (alg, key, ciphertext, opts) => {\n    check(key, 'decrypt', alg)\n    return JWA.decrypt.get(alg)(key, ciphertext, opts)\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,aAAa,EAAE,gBAAgB,EAAE;AACzC,MAAM,EAAE,sBAAsB,EAAE,sBAAsB,EAAE;AAExD,MAAM,EAAE,GAAG,EAAE,GAAG,EAAE;AAElB,eAAe;AACf,uHAAkB,KAAK;AACvB,wHAAmB,KAAK;AACxB,wHAAmB,KAAK;AACxB,6HAAwB,KAAK;AAC7B,yHAAoB,KAAK;AACzB,uHAAkB;AAElB,mBAAmB;AACnB,oIAA+B,KAAK;AACpC,0HAAqB,KAAK;AAE1B,qBAAqB;AACrB,wHAAmB,KAAK;AACxB,yHAAoB,KAAK;AACzB,6HAAwB,KAAK;AAE7B,YAAY;AACZ,wHAAmB,KAAK;AACxB,2HAAsB,KAAK;AAC3B,0HAAqB,KAAK;AAE1B,MAAM,QAAQ,CAAC,KAAK,IAAI;IACtB,MAAM,QAAQ,CAAC,CAAC,EAAE,GAAG,CAAC,EAAE,KAAK;IAE7B,IAAI;IACJ,IAAI;IACJ,IAAI,OAAO,wBAAwB;QACjC,QAAQ;QACR,QAAQ;IACV,OAAO,IAAI,OAAO,wBAAwB;QACxC,QAAQ;QACR,QAAQ;IACV;IAEA,IAAI,SAAS,KAAK;QAChB,IAAI,GAAG,CAAC,MAAM,EAAE;YACd;QACF;QACA,MAAM,IAAI,cAAc,CAAC,yBAAyB,EAAE,IAAI,CAAC,EAAE,SAAS,GAAG,UAAU,CAAC;IACpF;IAEA,IAAI,QAAQ;IACZ,IAAI,CAAC,GAAG,CAAC,GAAG,CAAC,GAAG,CAAC,MAAM;QACrB,MAAM,IAAI,iBAAiB,CAAC,YAAY,EAAE,SAAS,GAAG,MAAM,EAAE,KAAK;IACrE,OAAO,IAAI,CAAC,IAAI,UAAU,CAAC,OAAO,GAAG,CAAC,MAAM;QAC1C,QAAQ;IACV;IAEA,OAAO,cAAc,CAAC,KAAK,OAAO;QAAE;QAAO,YAAY;IAAM;IAE7D,IAAI,CAAC,OAAO;QACV,OAAO,MAAM,KAAK,IAAI;IACxB;AACF;AAEA,OAAO,OAAO,GAAG;IACf;IACA,MAAM,CAAC,KAAK,KAAK;QACf,MAAM,KAAK,QAAQ;QACnB,OAAO,IAAI,IAAI,CAAC,GAAG,CAAC,KAAK,KAAK;IAChC;IACA,QAAQ,CAAC,KAAK,KAAK,SAAS;QAC1B,MAAM,KAAK,UAAU;QACrB,OAAO,IAAI,MAAM,CAAC,GAAG,CAAC,KAAK,KAAK,SAAS;IAC3C;IACA,sBAAsB,CAAC,KAAK,KAAK,SAAS;QACxC,MAAM,KAAK,wBAAwB;QACnC,OAAO,IAAI,oBAAoB,CAAC,GAAG,CAAC,KAAK,KAAK,SAAS;IACzD;IACA,sBAAsB,CAAC,KAAK,KAAK,SAAS;QACxC,MAAM,KAAK,wBAAwB;QACnC,OAAO,IAAI,oBAAoB,CAAC,GAAG,CAAC,KAAK,KAAK,SAAS;IACzD;IACA,SAAS,CAAC,KAAK,KAAK,WAAW;QAC7B,MAAM,KAAK,WAAW;QACtB,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,KAAK,KAAK,WAAW;IAC9C;IACA,SAAS,CAAC,KAAK,KAAK,YAAY;QAC9B,MAAM,KAAK,WAAW;QACtB,OAAO,IAAI,OAAO,CAAC,GAAG,CAAC,KAAK,KAAK,YAAY;IAC/C;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3814, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/validate_crit.js"],"sourcesContent":["const { JOSECritNotUnderstood, JWSInvalid } = require('../errors')\n\nconst DEFINED = new Set([\n  'alg', 'jku', 'jwk', 'kid', 'x5u', 'x5c', 'x5t', 'x5t#S256', 'typ', 'cty',\n  'crit', 'enc', 'zip', 'epk', 'apu', 'apv', 'iv', 'tag', 'p2s', 'p2c'\n])\n\nmodule.exports = function validateCrit (Err, protectedHeader, unprotectedHeader, understood) {\n  if (protectedHeader && 'crit' in protectedHeader) {\n    if (\n      !Array.isArray(protectedHeader.crit) ||\n      protectedHeader.crit.length === 0 ||\n      protectedHeader.crit.some(s => typeof s !== 'string' || !s)\n    ) {\n      throw new Err('\"crit\" Header Parameter MUST be an array of non-empty strings when present')\n    }\n    const whitelisted = new Set(understood)\n    const combined = { ...protectedHeader, ...unprotectedHeader }\n    protectedHeader.crit.forEach((parameter) => {\n      if (DEFINED.has(parameter)) {\n        throw new Err(`The critical list contains a non-extension Header Parameter ${parameter}`)\n      }\n      if (!whitelisted.has(parameter)) {\n        throw new JOSECritNotUnderstood(`critical \"${parameter}\" is not understood`)\n      }\n      if (parameter === 'b64') {\n        if (!('b64' in protectedHeader)) {\n          throw new JWSInvalid('\"b64\" critical parameter must be integrity protected')\n        }\n        if (typeof protectedHeader.b64 !== 'boolean') {\n          throw new JWSInvalid('\"b64\" critical parameter must be a boolean')\n        }\n      } else if (!(parameter in combined)) {\n        throw new Err(`critical parameter \"${parameter}\" is missing`)\n      }\n    })\n  }\n  if (unprotectedHeader && 'crit' in unprotectedHeader) {\n    throw new Err('\"crit\" Header Parameter MUST be integrity protected when present')\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,qBAAqB,EAAE,UAAU,EAAE;AAE3C,MAAM,UAAU,IAAI,IAAI;IACtB;IAAO;IAAO;IAAO;IAAO;IAAO;IAAO;IAAO;IAAY;IAAO;IACpE;IAAQ;IAAO;IAAO;IAAO;IAAO;IAAO;IAAM;IAAO;IAAO;CAChE;AAED,OAAO,OAAO,GAAG,SAAS,aAAc,GAAG,EAAE,eAAe,EAAE,iBAAiB,EAAE,UAAU;IACzF,IAAI,mBAAmB,UAAU,iBAAiB;QAChD,IACE,CAAC,MAAM,OAAO,CAAC,gBAAgB,IAAI,KACnC,gBAAgB,IAAI,CAAC,MAAM,KAAK,KAChC,gBAAgB,IAAI,CAAC,IAAI,CAAC,CAAA,IAAK,OAAO,MAAM,YAAY,CAAC,IACzD;YACA,MAAM,IAAI,IAAI;QAChB;QACA,MAAM,cAAc,IAAI,IAAI;QAC5B,MAAM,WAAW;YAAE,GAAG,eAAe;YAAE,GAAG,iBAAiB;QAAC;QAC5D,gBAAgB,IAAI,CAAC,OAAO,CAAC,CAAC;YAC5B,IAAI,QAAQ,GAAG,CAAC,YAAY;gBAC1B,MAAM,IAAI,IAAI,CAAC,4DAA4D,EAAE,WAAW;YAC1F;YACA,IAAI,CAAC,YAAY,GAAG,CAAC,YAAY;gBAC/B,MAAM,IAAI,sBAAsB,CAAC,UAAU,EAAE,UAAU,mBAAmB,CAAC;YAC7E;YACA,IAAI,cAAc,OAAO;gBACvB,IAAI,CAAC,CAAC,SAAS,eAAe,GAAG;oBAC/B,MAAM,IAAI,WAAW;gBACvB;gBACA,IAAI,OAAO,gBAAgB,GAAG,KAAK,WAAW;oBAC5C,MAAM,IAAI,WAAW;gBACvB;YACF,OAAO,IAAI,CAAC,CAAC,aAAa,QAAQ,GAAG;gBACnC,MAAM,IAAI,IAAI,CAAC,oBAAoB,EAAE,UAAU,YAAY,CAAC;YAC9D;QACF;IACF;IACA,IAAI,qBAAqB,UAAU,mBAAmB;QACpD,MAAM,IAAI,IAAI;IAChB;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 3875, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwe/serializers.js"],"sourcesContent":["const isObject = require('../help/is_object')\nlet validateCrit = require('../help/validate_crit')\n\nconst { JWEInvalid } = require('../errors')\n\nvalidateCrit = validateCrit.bind(undefined, JWEInvalid)\n\nconst compactSerializer = (final, [recipient]) => {\n  return `${final.protected}.${recipient.encrypted_key}.${final.iv}.${final.ciphertext}.${final.tag}`\n}\ncompactSerializer.validate = (protectedHeader, unprotectedHeader, aad, { 0: { header }, length }) => {\n  if (length !== 1 || aad || unprotectedHeader || header) {\n    throw new JWEInvalid('JWE Compact Serialization doesn\\'t support multiple recipients, JWE unprotected headers or AAD')\n  }\n  validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst flattenedSerializer = (final, [recipient]) => {\n  const { header, encrypted_key: encryptedKey } = recipient\n\n  return {\n    ...(final.protected ? { protected: final.protected } : undefined),\n    ...(final.unprotected ? { unprotected: final.unprotected } : undefined),\n    ...(header ? { header } : undefined),\n    ...(encryptedKey ? { encrypted_key: encryptedKey } : undefined),\n    ...(final.aad ? { aad: final.aad } : undefined),\n    iv: final.iv,\n    ciphertext: final.ciphertext,\n    tag: final.tag\n  }\n}\nflattenedSerializer.validate = (protectedHeader, unprotectedHeader, aad, { 0: { header }, length }) => {\n  if (length !== 1) {\n    throw new JWEInvalid('Flattened JWE JSON Serialization doesn\\'t support multiple recipients')\n  }\n  validateCrit(protectedHeader, { ...unprotectedHeader, ...header }, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst generalSerializer = (final, recipients) => {\n  const result = {\n    ...(final.protected ? { protected: final.protected } : undefined),\n    ...(final.unprotected ? { unprotected: final.unprotected } : undefined),\n    recipients: recipients.map(({ header, encrypted_key: encryptedKey, generatedHeader }) => {\n      if (!header && !encryptedKey && !generatedHeader) {\n        return false\n      }\n\n      return {\n        ...(header || generatedHeader ? { header: { ...header, ...generatedHeader } } : undefined),\n        ...(encryptedKey ? { encrypted_key: encryptedKey } : undefined)\n      }\n    }).filter(Boolean),\n    ...(final.aad ? { aad: final.aad } : undefined),\n    iv: final.iv,\n    ciphertext: final.ciphertext,\n    tag: final.tag\n  }\n\n  if (!result.recipients.length) {\n    delete result.recipients\n  }\n\n  return result\n}\ngeneralSerializer.validate = (protectedHeader, unprotectedHeader, aad, recipients) => {\n  recipients.forEach(({ header }) => {\n    validateCrit(protectedHeader, { ...header, ...unprotectedHeader }, protectedHeader ? protectedHeader.crit : undefined)\n  })\n}\n\nconst isJSON = (input) => {\n  return isObject(input) &&\n    typeof input.ciphertext === 'string' &&\n    typeof input.iv === 'string' &&\n    typeof input.tag === 'string' &&\n    (input.unprotected === undefined || isObject(input.unprotected)) &&\n    (input.protected === undefined || typeof input.protected === 'string') &&\n    (input.aad === undefined || typeof input.aad === 'string')\n}\n\nconst isSingleRecipient = (input) => {\n  return (input.encrypted_key === undefined || typeof input.encrypted_key === 'string') &&\n    (input.header === undefined || isObject(input.header))\n}\n\nconst isValidRecipient = (recipient) => {\n  return isObject(recipient) && typeof recipient.encrypted_key === 'string' && (recipient.header === undefined || isObject(recipient.header))\n}\n\nconst isMultiRecipient = (input) => {\n  if (Array.isArray(input.recipients) && input.recipients.every(isValidRecipient)) {\n    return true\n  }\n\n  return false\n}\n\nconst detect = (input) => {\n  if (typeof input === 'string' && input.split('.').length === 5) {\n    return 'compact'\n  }\n\n  if (isJSON(input)) {\n    if (isMultiRecipient(input)) {\n      return 'general'\n    }\n\n    if (isSingleRecipient(input)) {\n      return 'flattened'\n    }\n  }\n\n  throw new JWEInvalid('JWE malformed or invalid serialization')\n}\n\nmodule.exports = {\n  compact: compactSerializer,\n  flattened: flattenedSerializer,\n  general: generalSerializer,\n  detect\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4004, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwe/generate_cek.js"],"sourcesContent":["const { randomBytes } = require('crypto')\n\nconst { createSecretKey } = require('../help/key_object')\nconst { KEYLENGTHS } = require('../registry')\nconst Key = require('../jwk/key/oct')\n\nmodule.exports = (alg) => {\n  const keyLength = KEYLENGTHS.get(alg)\n\n  if (!keyLength) {\n    return new Key({ type: 'secret' })\n  }\n\n  return new Key(createSecretKey(randomBytes(keyLength / 8)), { use: 'enc', alg })\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,WAAW,EAAE;AAErB,MAAM,EAAE,eAAe,EAAE;AACzB,MAAM,EAAE,UAAU,EAAE;AACpB,MAAM;AAEN,OAAO,OAAO,GAAG,CAAC;IAChB,MAAM,YAAY,WAAW,GAAG,CAAC;IAEjC,IAAI,CAAC,WAAW;QACd,OAAO,IAAI,IAAI;YAAE,MAAM;QAAS;IAClC;IAEA,OAAO,IAAI,IAAI,gBAAgB,YAAY,YAAY,KAAK;QAAE,KAAK;QAAO;IAAI;AAChF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4025, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/is_disjoint.js"],"sourcesContent":["module.exports = (a = {}, b = {}) => {\n  const keysA = Object.keys(a)\n  const keysB = new Set(Object.keys(b))\n  return !keysA.some((ka) => keysB.has(ka))\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAC,IAAI,CAAC,CAAC,EAAE,IAAI,CAAC,CAAC;IAC9B,MAAM,QAAQ,OAAO,IAAI,CAAC;IAC1B,MAAM,QAAQ,IAAI,IAAI,OAAO,IAAI,CAAC;IAClC,OAAO,CAAC,MAAM,IAAI,CAAC,CAAC,KAAO,MAAM,GAAG,CAAC;AACvC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4035, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwe/validate_headers.js"],"sourcesContent":["const isDisjoint = require('../help/is_disjoint')\nconst base64url = require('../help/base64url')\nlet validateCrit = require('../help/validate_crit')\nconst { JWEInvalid, JOSENotSupported } = require('../errors')\n\nvalidateCrit = validateCrit.bind(undefined, JWEInvalid)\n\nmodule.exports = (prot, unprotected, recipients, checkAlgorithms, crit) => {\n  if (typeof prot === 'string') {\n    try {\n      prot = base64url.JSON.decode(prot)\n    } catch (err) {\n      throw new JWEInvalid('could not parse JWE protected header')\n    }\n  }\n\n  let alg = []\n  const enc = new Set()\n  if (!isDisjoint(prot, unprotected) || !recipients.every(({ header }) => {\n    if (typeof header === 'object') {\n      alg.push(header.alg)\n      enc.add(header.enc)\n    }\n    const combined = { ...unprotected, ...header }\n    validateCrit(prot, combined, crit)\n    if ('zip' in combined) {\n      throw new JWEInvalid('\"zip\" Header Parameter MUST be integrity protected')\n    } else if (prot && 'zip' in prot && prot.zip !== 'DEF') {\n      throw new JOSENotSupported('only \"DEF\" compression algorithm is supported')\n    }\n    return isDisjoint(header, prot) && isDisjoint(header, unprotected)\n  })) {\n    throw new JWEInvalid('JWE Shared Protected, JWE Shared Unprotected and JWE Per-Recipient Header Parameter names must be disjoint')\n  }\n\n  if (typeof prot === 'object') {\n    alg.push(prot.alg)\n    enc.add(prot.enc)\n  }\n  if (typeof unprotected === 'object') {\n    alg.push(unprotected.alg)\n    enc.add(unprotected.enc)\n  }\n\n  alg = alg.filter(Boolean)\n  enc.delete(undefined)\n\n  if (recipients.length !== 1) {\n    if (alg.includes('dir') || alg.includes('ECDH-ES')) {\n      throw new JWEInvalid('dir and ECDH-ES alg may only be used with a single recipient')\n    }\n  }\n\n  if (checkAlgorithms) {\n    if (alg.length !== recipients.length) {\n      throw new JWEInvalid('missing Key Management algorithm')\n    }\n    if (enc.size === 0) {\n      throw new JWEInvalid('missing Content Encryption algorithm')\n    } else if (enc.size !== 1) {\n      throw new JWEInvalid('there must only be one Content Encryption algorithm')\n    }\n  } else {\n    if (enc.size > 1) {\n      throw new JWEInvalid('there must only be one Content Encryption algorithm')\n    }\n  }\n\n  return [...enc][0]\n}\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AACN,IAAI;AACJ,MAAM,EAAE,UAAU,EAAE,gBAAgB,EAAE;AAEtC,eAAe,aAAa,IAAI,CAAC,WAAW;AAE5C,OAAO,OAAO,GAAG,CAAC,MAAM,aAAa,YAAY,iBAAiB;IAChE,IAAI,OAAO,SAAS,UAAU;QAC5B,IAAI;YACF,OAAO,UAAU,IAAI,CAAC,MAAM,CAAC;QAC/B,EAAE,OAAO,KAAK;YACZ,MAAM,IAAI,WAAW;QACvB;IACF;IAEA,IAAI,MAAM,EAAE;IACZ,MAAM,MAAM,IAAI;IAChB,IAAI,CAAC,WAAW,MAAM,gBAAgB,CAAC,WAAW,KAAK,CAAC,CAAC,EAAE,MAAM,EAAE;QACjE,IAAI,OAAO,WAAW,UAAU;YAC9B,IAAI,IAAI,CAAC,OAAO,GAAG;YACnB,IAAI,GAAG,CAAC,OAAO,GAAG;QACpB;QACA,MAAM,WAAW;YAAE,GAAG,WAAW;YAAE,GAAG,MAAM;QAAC;QAC7C,aAAa,MAAM,UAAU;QAC7B,IAAI,SAAS,UAAU;YACrB,MAAM,IAAI,WAAW;QACvB,OAAO,IAAI,QAAQ,SAAS,QAAQ,KAAK,GAAG,KAAK,OAAO;YACtD,MAAM,IAAI,iBAAiB;QAC7B;QACA,OAAO,WAAW,QAAQ,SAAS,WAAW,QAAQ;IACxD,IAAI;QACF,MAAM,IAAI,WAAW;IACvB;IAEA,IAAI,OAAO,SAAS,UAAU;QAC5B,IAAI,IAAI,CAAC,KAAK,GAAG;QACjB,IAAI,GAAG,CAAC,KAAK,GAAG;IAClB;IACA,IAAI,OAAO,gBAAgB,UAAU;QACnC,IAAI,IAAI,CAAC,YAAY,GAAG;QACxB,IAAI,GAAG,CAAC,YAAY,GAAG;IACzB;IAEA,MAAM,IAAI,MAAM,CAAC;IACjB,IAAI,MAAM,CAAC;IAEX,IAAI,WAAW,MAAM,KAAK,GAAG;QAC3B,IAAI,IAAI,QAAQ,CAAC,UAAU,IAAI,QAAQ,CAAC,YAAY;YAClD,MAAM,IAAI,WAAW;QACvB;IACF;IAEA,IAAI,iBAAiB;QACnB,IAAI,IAAI,MAAM,KAAK,WAAW,MAAM,EAAE;YACpC,MAAM,IAAI,WAAW;QACvB;QACA,IAAI,IAAI,IAAI,KAAK,GAAG;YAClB,MAAM,IAAI,WAAW;QACvB,OAAO,IAAI,IAAI,IAAI,KAAK,GAAG;YACzB,MAAM,IAAI,WAAW;QACvB;IACF,OAAO;QACL,IAAI,IAAI,IAAI,GAAG,GAAG;YAChB,MAAM,IAAI,WAAW;QACvB;IACF;IAEA,OAAO;WAAI;KAAI,CAAC,EAAE;AACpB","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4107, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwe/encrypt.js"],"sourcesContent":["const { deflateRawSync } = require('zlib')\n\nconst { KEYOBJECT } = require('../help/consts')\nconst generateIV = require('../help/generate_iv')\nconst base64url = require('../help/base64url')\nconst getKey = require('../help/get_key')\nconst isObject = require('../help/is_object')\nconst { createSecretKey } = require('../help/key_object')\nconst deepClone = require('../help/deep_clone')\nconst importKey = require('../jwk/import')\nconst { JWEInvalid } = require('../errors')\nconst { check, keyManagementEncrypt, encrypt } = require('../jwa')\n\nconst serializers = require('./serializers')\nconst generateCEK = require('./generate_cek')\nconst validateHeaders = require('./validate_headers')\n\nconst PROCESS_RECIPIENT = Symbol('PROCESS_RECIPIENT')\n\nclass Encrypt {\n  constructor (cleartext, protectedHeader, aad, unprotectedHeader) {\n    if (!Buffer.isBuffer(cleartext) && typeof cleartext !== 'string') {\n      throw new TypeError('cleartext argument must be a Buffer or a string')\n    }\n    cleartext = Buffer.from(cleartext)\n\n    if (aad !== undefined && !Buffer.isBuffer(aad) && typeof aad !== 'string') {\n      throw new TypeError('aad argument must be a Buffer or a string when provided')\n    }\n    aad = aad ? Buffer.from(aad) : undefined\n\n    if (protectedHeader !== undefined && !isObject(protectedHeader)) {\n      throw new TypeError('protectedHeader argument must be a plain object when provided')\n    }\n\n    if (unprotectedHeader !== undefined && !isObject(unprotectedHeader)) {\n      throw new TypeError('unprotectedHeader argument must be a plain object when provided')\n    }\n\n    this._recipients = []\n    this._cleartext = cleartext\n    this._aad = aad\n    this._unprotected = unprotectedHeader ? deepClone(unprotectedHeader) : undefined\n    this._protected = protectedHeader ? deepClone(protectedHeader) : undefined\n  }\n\n  /*\n   * @public\n   */\n  recipient (key, header) {\n    key = getKey(key)\n\n    if (header !== undefined && !isObject(header)) {\n      throw new TypeError('header argument must be a plain object when provided')\n    }\n\n    this._recipients.push({\n      key,\n      header: header ? deepClone(header) : undefined\n    })\n\n    return this\n  }\n\n  /*\n   * @private\n   */\n  [PROCESS_RECIPIENT] (recipient) {\n    const unprotectedHeader = this._unprotected\n    const protectedHeader = this._protected\n    const { length: recipientCount } = this._recipients\n\n    const jweHeader = {\n      ...protectedHeader,\n      ...unprotectedHeader,\n      ...recipient.header\n    }\n    const { key } = recipient\n\n    const enc = jweHeader.enc\n    let alg = jweHeader.alg\n\n    if (key.use === 'sig') {\n      throw new TypeError('a key with \"use\":\"sig\" is not usable for encryption')\n    }\n\n    if (alg === 'dir') {\n      check(key, 'encrypt', enc)\n    } else if (alg) {\n      check(key, 'keyManagementEncrypt', alg)\n    } else {\n      alg = key.alg || [...key.algorithms('wrapKey')][0] || [...key.algorithms('deriveKey')][0]\n\n      if (alg === 'ECDH-ES' && recipientCount !== 1) {\n        alg = [...key.algorithms('deriveKey')][1]\n      }\n\n      if (!alg) {\n        throw new JWEInvalid('could not resolve a usable \"alg\" for a recipient')\n      }\n\n      if (recipientCount === 1) {\n        if (protectedHeader) {\n          protectedHeader.alg = alg\n        } else {\n          this._protected = { alg }\n        }\n      } else {\n        if (recipient.header) {\n          recipient.header.alg = alg\n        } else {\n          recipient.header = { alg }\n        }\n      }\n    }\n\n    let wrapped\n    let generatedHeader\n\n    if (key.kty === 'oct' && alg === 'dir') {\n      this._cek = importKey(key[KEYOBJECT], { use: 'enc', alg: enc })\n    } else {\n      check(this._cek, 'encrypt', enc)\n      ;({ wrapped, header: generatedHeader } = keyManagementEncrypt(alg, key, this._cek[KEYOBJECT].export(), { enc, alg }))\n      if (alg === 'ECDH-ES') {\n        this._cek = importKey(createSecretKey(wrapped), { use: 'enc', alg: enc })\n      }\n    }\n\n    if (alg === 'dir' || alg === 'ECDH-ES') {\n      recipient.encrypted_key = ''\n    } else {\n      recipient.encrypted_key = base64url.encodeBuffer(wrapped)\n    }\n\n    if (generatedHeader) {\n      recipient.generatedHeader = generatedHeader\n    }\n  }\n\n  /*\n   * @public\n   */\n  encrypt (serialization) {\n    const serializer = serializers[serialization]\n    if (!serializer) {\n      throw new TypeError('serialization must be one of \"compact\", \"flattened\", \"general\"')\n    }\n\n    if (!this._recipients.length) {\n      throw new JWEInvalid('missing recipients')\n    }\n\n    serializer.validate(this._protected, this._unprotected, this._aad, this._recipients)\n\n    let enc = validateHeaders(this._protected, this._unprotected, this._recipients, false, this._protected ? this._protected.crit : undefined)\n    if (!enc) {\n      enc = 'A128CBC-HS256'\n      if (this._protected) {\n        this._protected.enc = enc\n      } else {\n        this._protected = { enc }\n      }\n    }\n    const final = {}\n    this._cek = generateCEK(enc)\n\n    for (const recipient of this._recipients) {\n      this[PROCESS_RECIPIENT](recipient)\n    }\n\n    const iv = generateIV(enc)\n    final.iv = base64url.encodeBuffer(iv)\n\n    if (this._recipients.length === 1 && this._recipients[0].generatedHeader) {\n      const [{ generatedHeader }] = this._recipients\n      delete this._recipients[0].generatedHeader\n      this._protected = {\n        ...this._protected,\n        ...generatedHeader\n      }\n    }\n\n    if (this._protected) {\n      final.protected = base64url.JSON.encode(this._protected)\n    }\n    final.unprotected = this._unprotected\n\n    let aad\n    if (this._aad) {\n      final.aad = base64url.encode(this._aad)\n      aad = Buffer.concat([\n        Buffer.from(final.protected || ''),\n        Buffer.from('.'),\n        Buffer.from(final.aad)\n      ])\n    } else {\n      aad = Buffer.from(final.protected || '')\n    }\n\n    let cleartext = this._cleartext\n    if (this._protected && 'zip' in this._protected) {\n      cleartext = deflateRawSync(cleartext)\n    }\n\n    const { ciphertext, tag } = encrypt(enc, this._cek, cleartext, { iv, aad })\n    final.tag = base64url.encodeBuffer(tag)\n    final.ciphertext = base64url.encodeBuffer(ciphertext)\n\n    return serializer(final, this._recipients)\n  }\n}\n\nmodule.exports = Encrypt\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4310, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwks/index.js"],"sourcesContent":["const KeyStore = require('./keystore')\n\nmodule.exports = KeyStore\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4317, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwe/decrypt.js"],"sourcesContent":["const { inflateRawSync } = require('zlib')\n\nconst base64url = require('../help/base64url')\nconst getKey = require('../help/get_key')\nconst { KeyStore } = require('../jwks')\nconst errors = require('../errors')\nconst { check, decrypt, keyManagementDecrypt } = require('../jwa')\nconst JWK = require('../jwk')\n\nconst { createSecretKey } = require('../help/key_object')\nconst generateCEK = require('./generate_cek')\nconst validateHeaders = require('./validate_headers')\nconst { detect: resolveSerialization } = require('./serializers')\n\nconst SINGLE_RECIPIENT = new Set(['compact', 'flattened'])\n\nconst combineHeader = (prot = {}, unprotected = {}, header = {}) => {\n  if (typeof prot === 'string') {\n    prot = base64url.JSON.decode(prot)\n  }\n\n  const p2s = prot.p2s || unprotected.p2s || header.p2s\n  const apu = prot.apu || unprotected.apu || header.apu\n  const apv = prot.apv || unprotected.apv || header.apv\n  const iv = prot.iv || unprotected.iv || header.iv\n  const tag = prot.tag || unprotected.tag || header.tag\n\n  return {\n    ...prot,\n    ...unprotected,\n    ...header,\n    ...(typeof p2s === 'string' ? { p2s: base64url.decodeToBuffer(p2s) } : undefined),\n    ...(typeof apu === 'string' ? { apu: base64url.decodeToBuffer(apu) } : undefined),\n    ...(typeof apv === 'string' ? { apv: base64url.decodeToBuffer(apv) } : undefined),\n    ...(typeof iv === 'string' ? { iv: base64url.decodeToBuffer(iv) } : undefined),\n    ...(typeof tag === 'string' ? { tag: base64url.decodeToBuffer(tag) } : undefined)\n  }\n}\n\nconst validateAlgorithms = (algorithms, option) => {\n  if (algorithms !== undefined && (!Array.isArray(algorithms) || algorithms.some(s => typeof s !== 'string' || !s))) {\n    throw new TypeError(`\"${option}\" option must be an array of non-empty strings`)\n  }\n\n  if (!algorithms) {\n    return undefined\n  }\n\n  return new Set(algorithms)\n}\n\n/*\n * @public\n */\nconst jweDecrypt = (skipValidateHeaders, serialization, jwe, key, { crit = [], complete = false, keyManagementAlgorithms, contentEncryptionAlgorithms, maxPBES2Count = 10000, inflateRawSyncLimit = 250000 } = {}) => {\n  key = getKey(key, true)\n\n  keyManagementAlgorithms = validateAlgorithms(keyManagementAlgorithms, 'keyManagementAlgorithms')\n  contentEncryptionAlgorithms = validateAlgorithms(contentEncryptionAlgorithms, 'contentEncryptionAlgorithms')\n\n  if (!Array.isArray(crit) || crit.some(s => typeof s !== 'string' || !s)) {\n    throw new TypeError('\"crit\" option must be an array of non-empty strings')\n  }\n\n  if (!serialization) {\n    serialization = resolveSerialization(jwe)\n  }\n\n  let alg, ciphertext, enc, encryptedKey, iv, opts, prot, tag, unprotected, cek, aad, header\n\n  // treat general format with one recipient as flattened\n  // skips iteration and avoids multi errors in this case\n  if (serialization === 'general' && jwe.recipients.length === 1) {\n    serialization = 'flattened'\n    const { recipients, ...root } = jwe\n    jwe = { ...root, ...recipients[0] }\n  }\n\n  if (SINGLE_RECIPIENT.has(serialization)) {\n    if (serialization === 'compact') { // compact serialization format\n      ([prot, encryptedKey, iv, ciphertext, tag] = jwe.split('.'))\n    } else { // flattened serialization format\n      ({ protected: prot, encrypted_key: encryptedKey, iv, ciphertext, tag, unprotected, aad, header } = jwe)\n    }\n\n    if (!skipValidateHeaders) {\n      validateHeaders(prot, unprotected, [{ header }], true, crit)\n    }\n\n    opts = combineHeader(prot, unprotected, header)\n\n    ;({ alg, enc } = opts)\n\n    if (keyManagementAlgorithms && !keyManagementAlgorithms.has(alg)) {\n      throw new errors.JOSEAlgNotWhitelisted('key management algorithm not whitelisted')\n    }\n\n    if (contentEncryptionAlgorithms && !contentEncryptionAlgorithms.has(enc)) {\n      throw new errors.JOSEAlgNotWhitelisted('content encryption algorithm not whitelisted')\n    }\n\n    if (key instanceof KeyStore) {\n      const keystore = key\n      let keys\n      if (opts.alg === 'dir') {\n        keys = keystore.all({ kid: opts.kid, alg: opts.enc, key_ops: ['decrypt'] })\n      } else {\n        keys = keystore.all({ kid: opts.kid, alg: opts.alg, key_ops: ['unwrapKey'] })\n      }\n      switch (keys.length) {\n        case 0:\n          throw new errors.JWKSNoMatchingKey()\n        case 1:\n          // treat the call as if a Key instance was passed in\n          // skips iteration and avoids multi errors in this case\n          key = keys[0]\n          break\n        default: {\n          const errs = []\n          for (const key of keys) {\n            try {\n              return jweDecrypt(true, serialization, jwe, key, {\n                crit,\n                complete,\n                contentEncryptionAlgorithms: contentEncryptionAlgorithms ? [...contentEncryptionAlgorithms] : undefined,\n                keyManagementAlgorithms: keyManagementAlgorithms ? [...keyManagementAlgorithms] : undefined\n              })\n            } catch (err) {\n              errs.push(err)\n              continue\n            }\n          }\n\n          const multi = new errors.JOSEMultiError(errs)\n          if ([...multi].some(e => e instanceof errors.JWEDecryptionFailed)) {\n            throw new errors.JWEDecryptionFailed()\n          }\n          throw multi\n        }\n      }\n    }\n\n    check(key, ...(alg === 'dir' ? ['decrypt', enc] : ['keyManagementDecrypt', alg]))\n\n    if (alg.startsWith('PBES2')) {\n      if (opts && opts.p2c > maxPBES2Count) {\n        throw new errors.JWEInvalid('JOSE Header \"p2c\" (PBES2 Count) out is of acceptable bounds')\n      }\n    }\n\n    try {\n      if (alg === 'dir') {\n        cek = JWK.asKey(key, { alg: enc, use: 'enc' })\n      } else if (alg === 'ECDH-ES') {\n        const unwrapped = keyManagementDecrypt(alg, key, undefined, opts)\n        cek = JWK.asKey(createSecretKey(unwrapped), { alg: enc, use: 'enc' })\n      } else {\n        const unwrapped = keyManagementDecrypt(alg, key, base64url.decodeToBuffer(encryptedKey), opts)\n        cek = JWK.asKey(createSecretKey(unwrapped), { alg: enc, use: 'enc' })\n      }\n    } catch (err) {\n      // To mitigate the attacks described in RFC 3218, the\n      // recipient MUST NOT distinguish between format, padding, and length\n      // errors of encrypted keys.  It is strongly recommended, in the event\n      // of receiving an improperly formatted key, that the recipient\n      // substitute a randomly generated CEK and proceed to the next step, to\n      // mitigate timing attacks.\n      cek = generateCEK(enc)\n    }\n\n    let adata\n    if (aad) {\n      adata = Buffer.concat([\n        Buffer.from(prot || ''),\n        Buffer.from('.'),\n        Buffer.from(aad)\n      ])\n    } else {\n      adata = Buffer.from(prot || '')\n    }\n\n    try {\n      iv = base64url.decodeToBuffer(iv)\n    } catch (err) {}\n    try {\n      tag = base64url.decodeToBuffer(tag)\n    } catch (err) {}\n\n    let cleartext = decrypt(enc, cek, base64url.decodeToBuffer(ciphertext), { iv, tag, aad: adata })\n\n    if (opts.zip) {\n      cleartext = inflateRawSync(cleartext, { maxOutputLength: inflateRawSyncLimit })\n    }\n\n    if (complete) {\n      const result = { cleartext, key, cek }\n      if (aad) result.aad = aad\n      if (header) result.header = header\n      if (unprotected) result.unprotected = unprotected\n      if (prot) result.protected = base64url.JSON.decode(prot)\n      return result\n    }\n\n    return cleartext\n  }\n\n  validateHeaders(jwe.protected, jwe.unprotected, jwe.recipients.map(({ header }) => ({ header })), true, crit)\n\n  // general serialization format\n  const { recipients, ...root } = jwe\n  const errs = []\n  for (const recipient of recipients) {\n    try {\n      return jweDecrypt(true, 'flattened', { ...root, ...recipient }, key, {\n        crit,\n        complete,\n        contentEncryptionAlgorithms: contentEncryptionAlgorithms ? [...contentEncryptionAlgorithms] : undefined,\n        keyManagementAlgorithms: keyManagementAlgorithms ? [...keyManagementAlgorithms] : undefined\n      })\n    } catch (err) {\n      errs.push(err)\n      continue\n    }\n  }\n\n  const multi = new errors.JOSEMultiError(errs)\n  if ([...multi].some(e => e instanceof errors.JWEDecryptionFailed)) {\n    throw new errors.JWEDecryptionFailed()\n  } else if ([...multi].every(e => e instanceof errors.JWKSNoMatchingKey)) {\n    throw new errors.JWKSNoMatchingKey()\n  }\n  throw multi\n}\n\nmodule.exports = jweDecrypt.bind(undefined, false, undefined)\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4597, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwe/index.js"],"sourcesContent":["const Encrypt = require('./encrypt')\nconst decrypt = require('./decrypt')\n\nconst single = (serialization, cleartext, key, protectedHeader, aad, unprotectedHeader) => {\n  return new Encrypt(cleartext, protectedHeader, aad, unprotectedHeader)\n    .recipient(key)\n    .encrypt(serialization)\n}\n\nmodule.exports.Encrypt = Encrypt\nmodule.exports.encrypt = single.bind(undefined, 'compact')\nmodule.exports.encrypt.flattened = single.bind(undefined, 'flattened')\nmodule.exports.encrypt.general = single.bind(undefined, 'general')\n\nmodule.exports.decrypt = decrypt\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AAEN,MAAM,SAAS,CAAC,eAAe,WAAW,KAAK,iBAAiB,KAAK;IACnE,OAAO,IAAI,QAAQ,WAAW,iBAAiB,KAAK,mBACjD,SAAS,CAAC,KACV,OAAO,CAAC;AACb;AAEA,OAAO,OAAO,CAAC,OAAO,GAAG;AACzB,OAAO,OAAO,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,WAAW;AAChD,OAAO,OAAO,CAAC,OAAO,CAAC,SAAS,GAAG,OAAO,IAAI,CAAC,WAAW;AAC1D,OAAO,OAAO,CAAC,OAAO,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,WAAW;AAExD,OAAO,OAAO,CAAC,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4612, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jws/serializers.js"],"sourcesContent":["const isObject = require('../help/is_object')\nlet validateCrit = require('../help/validate_crit')\nconst { JWSInvalid } = require('../errors')\n\nvalidateCrit = validateCrit.bind(undefined, JWSInvalid)\n\nconst compactSerializer = (payload, [recipient]) => {\n  return `${recipient.protected}.${payload}.${recipient.signature}`\n}\ncompactSerializer.validate = (jws, { 0: { unprotectedHeader, protectedHeader }, length }) => {\n  if (length !== 1 || unprotectedHeader) {\n    throw new JWSInvalid('JWS Compact Serialization doesn\\'t support multiple recipients or JWS unprotected headers')\n  }\n  validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst flattenedSerializer = (payload, [recipient]) => {\n  const { header, signature, protected: prot } = recipient\n\n  return {\n    payload,\n    ...prot ? { protected: prot } : undefined,\n    ...header ? { header } : undefined,\n    signature\n  }\n}\nflattenedSerializer.validate = (jws, { 0: { unprotectedHeader, protectedHeader }, length }) => {\n  if (length !== 1) {\n    throw new JWSInvalid('Flattened JWS JSON Serialization doesn\\'t support multiple recipients')\n  }\n  validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n}\n\nconst generalSerializer = (payload, recipients) => {\n  return {\n    payload,\n    signatures: recipients.map(({ header, signature, protected: prot }) => {\n      return {\n        ...prot ? { protected: prot } : undefined,\n        ...header ? { header } : undefined,\n        signature\n      }\n    })\n  }\n}\ngeneralSerializer.validate = (jws, recipients) => {\n  let validateB64 = false\n  recipients.forEach(({ protectedHeader, unprotectedHeader }) => {\n    if (protectedHeader && !validateB64 && 'b64' in protectedHeader) {\n      validateB64 = true\n    }\n    validateCrit(protectedHeader, unprotectedHeader, protectedHeader ? protectedHeader.crit : undefined)\n  })\n\n  if (validateB64) {\n    const values = recipients.map(({ protectedHeader }) => protectedHeader && protectedHeader.b64)\n    if (!values.every((actual, i, [expected]) => actual === expected)) {\n      throw new JWSInvalid('the \"b64\" Header Parameter value MUST be the same for all recipients')\n    }\n  }\n}\n\nconst isJSON = (input) => {\n  return isObject(input) && (typeof input.payload === 'string' || Buffer.isBuffer(input.payload))\n}\n\nconst isValidRecipient = (recipient) => {\n  return isObject(recipient) && typeof recipient.signature === 'string' &&\n    (recipient.header === undefined || isObject(recipient.header)) &&\n    (recipient.protected === undefined || typeof recipient.protected === 'string')\n}\n\nconst isMultiRecipient = (input) => {\n  if (Array.isArray(input.signatures) && input.signatures.every(isValidRecipient)) {\n    return true\n  }\n\n  return false\n}\n\nconst detect = (input) => {\n  if (typeof input === 'string' && input.split('.').length === 3) {\n    return 'compact'\n  }\n\n  if (isJSON(input)) {\n    if (isMultiRecipient(input)) {\n      return 'general'\n    }\n\n    if (isValidRecipient(input)) {\n      return 'flattened'\n    }\n  }\n\n  throw new JWSInvalid('JWS malformed or invalid serialization')\n}\n\nmodule.exports = {\n  compact: compactSerializer,\n  flattened: flattenedSerializer,\n  general: generalSerializer,\n  detect\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4712, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jws/sign.js"],"sourcesContent":["const base64url = require('../help/base64url')\nconst isDisjoint = require('../help/is_disjoint')\nconst isObject = require('../help/is_object')\nconst deepClone = require('../help/deep_clone')\nconst { JWSInvalid } = require('../errors')\nconst { sign } = require('../jwa')\nconst getKey = require('../help/get_key')\n\nconst serializers = require('./serializers')\n\nconst PROCESS_RECIPIENT = Symbol('PROCESS_RECIPIENT')\n\nclass Sign {\n  constructor (payload) {\n    if (typeof payload === 'string') {\n      payload = base64url.encode(payload)\n    } else if (Buffer.isBuffer(payload)) {\n      payload = base64url.encodeBuffer(payload)\n      this._binary = true\n    } else if (isObject(payload)) {\n      payload = base64url.JSON.encode(payload)\n    } else {\n      throw new TypeError('payload argument must be a Buffer, string or an object')\n    }\n\n    this._payload = payload\n    this._recipients = []\n  }\n\n  /*\n   * @public\n   */\n  recipient (key, protectedHeader, unprotectedHeader) {\n    key = getKey(key)\n\n    if (protectedHeader !== undefined && !isObject(protectedHeader)) {\n      throw new TypeError('protectedHeader argument must be a plain object when provided')\n    }\n\n    if (unprotectedHeader !== undefined && !isObject(unprotectedHeader)) {\n      throw new TypeError('unprotectedHeader argument must be a plain object when provided')\n    }\n\n    if (!isDisjoint(protectedHeader, unprotectedHeader)) {\n      throw new JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint')\n    }\n\n    this._recipients.push({\n      key,\n      protectedHeader: protectedHeader ? deepClone(protectedHeader) : undefined,\n      unprotectedHeader: unprotectedHeader ? deepClone(unprotectedHeader) : undefined\n    })\n\n    return this\n  }\n\n  /*\n   * @private\n   */\n  [PROCESS_RECIPIENT] (recipient, first) {\n    const { key, protectedHeader, unprotectedHeader } = recipient\n\n    if (key.use === 'enc') {\n      throw new TypeError('a key with \"use\":\"enc\" is not usable for signing')\n    }\n\n    const joseHeader = {\n      protected: protectedHeader || {},\n      unprotected: unprotectedHeader || {}\n    }\n\n    let alg = joseHeader.protected.alg || joseHeader.unprotected.alg\n\n    if (!alg) {\n      alg = key.alg || [...key.algorithms('sign')][0]\n      if (recipient.protectedHeader) {\n        joseHeader.protected.alg = recipient.protectedHeader.alg = alg\n      } else {\n        joseHeader.protected = recipient.protectedHeader = { alg }\n      }\n    }\n\n    if (!alg) {\n      throw new JWSInvalid('could not resolve a usable \"alg\" for a recipient')\n    }\n\n    recipient.header = unprotectedHeader\n    recipient.protected = Object.keys(joseHeader.protected).length ? base64url.JSON.encode(joseHeader.protected) : ''\n\n    if (first && joseHeader.protected.crit && joseHeader.protected.crit.includes('b64') && joseHeader.protected.b64 === false) {\n      if (this._binary) {\n        this._payload = base64url.decodeToBuffer(this._payload)\n      } else {\n        this._payload = base64url.decode(this._payload)\n      }\n    }\n\n    const data = Buffer.concat([\n      Buffer.from(recipient.protected || ''),\n      Buffer.from('.'),\n      Buffer.from(this._payload)\n    ])\n\n    recipient.signature = base64url.encodeBuffer(sign(alg, key, data))\n  }\n\n  /*\n   * @public\n   */\n  sign (serialization) {\n    const serializer = serializers[serialization]\n    if (!serializer) {\n      throw new TypeError('serialization must be one of \"compact\", \"flattened\", \"general\"')\n    }\n\n    if (!this._recipients.length) {\n      throw new JWSInvalid('missing recipients')\n    }\n\n    serializer.validate(this, this._recipients)\n\n    this._recipients.forEach((recipient, i) => {\n      this[PROCESS_RECIPIENT](recipient, i === 0)\n    })\n\n    return serializer(this._payload, this._recipients)\n  }\n}\n\nmodule.exports = Sign\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 4822, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jws/verify.js"],"sourcesContent":["const { EOL } = require('os')\n\nconst base64url = require('../help/base64url')\nconst isDisjoint = require('../help/is_disjoint')\nconst isObject = require('../help/is_object')\nlet validateCrit = require('../help/validate_crit')\nconst getKey = require('../help/get_key')\nconst { KeyStore } = require('../jwks')\nconst errors = require('../errors')\nconst { check, verify } = require('../jwa')\nconst JWK = require('../jwk')\n\nconst { detect: resolveSerialization } = require('./serializers')\n\nvalidateCrit = validateCrit.bind(undefined, errors.JWSInvalid)\nconst SINGLE_RECIPIENT = new Set(['compact', 'flattened', 'preparsed'])\n\n/*\n * @public\n */\nconst jwsVerify = (skipDisjointCheck, serialization, jws, key, { crit = [], complete = false, algorithms } = {}) => {\n  key = getKey(key, true)\n\n  if (algorithms !== undefined && (!Array.isArray(algorithms) || algorithms.some(s => typeof s !== 'string' || !s))) {\n    throw new TypeError('\"algorithms\" option must be an array of non-empty strings')\n  } else if (algorithms) {\n    algorithms = new Set(algorithms)\n  }\n\n  if (!Array.isArray(crit) || crit.some(s => typeof s !== 'string' || !s)) {\n    throw new TypeError('\"crit\" option must be an array of non-empty strings')\n  }\n\n  if (!serialization) {\n    serialization = resolveSerialization(jws)\n  }\n\n  let prot // protected header\n  let header // unprotected header\n  let payload\n  let signature\n  let alg\n\n  // treat general format with one recipient as flattened\n  // skips iteration and avoids multi errors in this case\n  if (serialization === 'general' && jws.signatures.length === 1) {\n    serialization = 'flattened'\n    const { signatures, ...root } = jws\n    jws = { ...root, ...signatures[0] }\n  }\n\n  let decoded\n\n  if (SINGLE_RECIPIENT.has(serialization)) {\n    let parsedProt = {}\n\n    switch (serialization) {\n      case 'compact': // compact serialization format\n        ([prot, payload, signature] = jws.split('.'))\n        break\n      case 'flattened': // flattened serialization format\n        ({ protected: prot, payload, signature, header } = jws)\n        break\n      case 'preparsed': { // from the JWT module\n        ({ decoded } = jws);\n        ([prot, payload, signature] = jws.token.split('.'))\n        break\n      }\n    }\n\n    if (!header) {\n      skipDisjointCheck = true\n    }\n\n    if (decoded) {\n      parsedProt = decoded.header\n    } else if (prot) {\n      try {\n        parsedProt = base64url.JSON.decode(prot)\n      } catch (err) {\n        throw new errors.JWSInvalid('could not parse JWS protected header')\n      }\n    } else {\n      skipDisjointCheck = skipDisjointCheck || true\n    }\n\n    if (!skipDisjointCheck && !isDisjoint(parsedProt, header)) {\n      throw new errors.JWSInvalid('JWS Protected and JWS Unprotected Header Parameter names must be disjoint')\n    }\n\n    const combinedHeader = { ...parsedProt, ...header }\n    validateCrit(parsedProt, header, crit)\n\n    alg = parsedProt.alg || (header && header.alg)\n    if (!alg) {\n      throw new errors.JWSInvalid('missing JWS signature algorithm')\n    } else if (algorithms && !algorithms.has(alg)) {\n      throw new errors.JOSEAlgNotWhitelisted('alg not whitelisted')\n    }\n\n    if (key instanceof KeyStore) {\n      const keystore = key\n      const keys = keystore.all({ kid: combinedHeader.kid, alg: combinedHeader.alg, key_ops: ['verify'] })\n      switch (keys.length) {\n        case 0:\n          throw new errors.JWKSNoMatchingKey()\n        case 1:\n          // treat the call as if a Key instance was passed in\n          // skips iteration and avoids multi errors in this case\n          key = keys[0]\n          break\n        default: {\n          const errs = []\n          for (const key of keys) {\n            try {\n              return jwsVerify(true, serialization, jws, key, { crit, complete, algorithms: algorithms ? [...algorithms] : undefined })\n            } catch (err) {\n              errs.push(err)\n              continue\n            }\n          }\n\n          const multi = new errors.JOSEMultiError(errs)\n          if ([...multi].some(e => e instanceof errors.JWSVerificationFailed)) {\n            throw new errors.JWSVerificationFailed()\n          }\n          throw multi\n        }\n      }\n    }\n\n    if (key === JWK.EmbeddedJWK) {\n      if (!isObject(combinedHeader.jwk)) {\n        throw new errors.JWSInvalid('JWS Header Parameter \"jwk\" must be a JSON object')\n      }\n      key = JWK.asKey(combinedHeader.jwk)\n      if (key.type !== 'public') {\n        throw new errors.JWSInvalid('JWS Header Parameter \"jwk\" must be a public key')\n      }\n    } else if (key === JWK.EmbeddedX5C) {\n      if (!Array.isArray(combinedHeader.x5c) || !combinedHeader.x5c.length || combinedHeader.x5c.some(c => typeof c !== 'string' || !c)) {\n        throw new errors.JWSInvalid('JWS Header Parameter \"x5c\" must be a JSON array of certificate value strings')\n      }\n      key = JWK.asKey(\n        `-----BEGIN CERTIFICATE-----${EOL}${(combinedHeader.x5c[0].match(/.{1,64}/g) || []).join(EOL)}${EOL}-----END CERTIFICATE-----`,\n        { x5c: combinedHeader.x5c }\n      )\n    }\n\n    check(key, 'verify', alg)\n\n    const toBeVerified = Buffer.concat([\n      Buffer.from(prot || ''),\n      Buffer.from('.'),\n      Buffer.isBuffer(payload) ? payload : Buffer.from(payload)\n    ])\n\n    if (!verify(alg, key, toBeVerified, base64url.decodeToBuffer(signature))) {\n      throw new errors.JWSVerificationFailed()\n    }\n\n    if (combinedHeader.b64 === false) {\n      payload = Buffer.from(payload)\n    } else {\n      payload = base64url.decodeToBuffer(payload)\n    }\n\n    if (complete) {\n      const result = { payload, key }\n      if (prot) result.protected = parsedProt\n      if (header) result.header = header\n      return result\n    }\n\n    return payload\n  }\n\n  // general serialization format\n  const { signatures, ...root } = jws\n  const errs = []\n  for (const recipient of signatures) {\n    try {\n      return jwsVerify(false, 'flattened', { ...root, ...recipient }, key, { crit, complete, algorithms: algorithms ? [...algorithms] : undefined })\n    } catch (err) {\n      errs.push(err)\n      continue\n    }\n  }\n\n  const multi = new errors.JOSEMultiError(errs)\n  if ([...multi].some(e => e instanceof errors.JWSVerificationFailed)) {\n    throw new errors.JWSVerificationFailed()\n  } else if ([...multi].every(e => e instanceof errors.JWKSNoMatchingKey)) {\n    throw new errors.JWKSNoMatchingKey()\n  }\n  throw multi\n}\n\nmodule.exports = {\n  bare: jwsVerify,\n  verify: jwsVerify.bind(undefined, false, undefined)\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5042, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jws/index.js"],"sourcesContent":["const Sign = require('./sign')\nconst { verify } = require('./verify')\n\nconst single = (serialization, payload, key, protectedHeader, unprotectedHeader) => {\n  return new Sign(payload)\n    .recipient(key, protectedHeader, unprotectedHeader)\n    .sign(serialization)\n}\n\nmodule.exports.Sign = Sign\nmodule.exports.sign = single.bind(undefined, 'compact')\nmodule.exports.sign.flattened = single.bind(undefined, 'flattened')\nmodule.exports.sign.general = single.bind(undefined, 'general')\n\nmodule.exports.verify = verify\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM,EAAE,MAAM,EAAE;AAEhB,MAAM,SAAS,CAAC,eAAe,SAAS,KAAK,iBAAiB;IAC5D,OAAO,IAAI,KAAK,SACb,SAAS,CAAC,KAAK,iBAAiB,mBAChC,IAAI,CAAC;AACV;AAEA,OAAO,OAAO,CAAC,IAAI,GAAG;AACtB,OAAO,OAAO,CAAC,IAAI,GAAG,OAAO,IAAI,CAAC,WAAW;AAC7C,OAAO,OAAO,CAAC,IAAI,CAAC,SAAS,GAAG,OAAO,IAAI,CAAC,WAAW;AACvD,OAAO,OAAO,CAAC,IAAI,CAAC,OAAO,GAAG,OAAO,IAAI,CAAC,WAAW;AAErD,OAAO,OAAO,CAAC,MAAM,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5057, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwt/decode.js"],"sourcesContent":["const base64url = require('../help/base64url')\nconst errors = require('../errors')\n\nmodule.exports = (token, { complete = false } = {}) => {\n  if (typeof token !== 'string' || !token) {\n    throw new TypeError('JWT must be a string')\n  }\n\n  const { 0: header, 1: payload, 2: signature, length } = token.split('.')\n\n  if (length === 5) {\n    throw new TypeError('encrypted JWTs cannot be decoded')\n  }\n\n  if (length !== 3) {\n    throw new errors.JWTMalformed('JWTs must have three components')\n  }\n\n  try {\n    const result = {\n      header: base64url.JSON.decode(header),\n      payload: base64url.JSON.decode(payload),\n      signature\n    }\n\n    return complete ? result : result.payload\n  } catch (err) {\n    throw new errors.JWTMalformed('JWT is malformed')\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AAEN,OAAO,OAAO,GAAG,CAAC,OAAO,EAAE,WAAW,KAAK,EAAE,GAAG,CAAC,CAAC;IAChD,IAAI,OAAO,UAAU,YAAY,CAAC,OAAO;QACvC,MAAM,IAAI,UAAU;IACtB;IAEA,MAAM,EAAE,GAAG,MAAM,EAAE,GAAG,OAAO,EAAE,GAAG,SAAS,EAAE,MAAM,EAAE,GAAG,MAAM,KAAK,CAAC;IAEpE,IAAI,WAAW,GAAG;QAChB,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI,WAAW,GAAG;QAChB,MAAM,IAAI,OAAO,YAAY,CAAC;IAChC;IAEA,IAAI;QACF,MAAM,SAAS;YACb,QAAQ,UAAU,IAAI,CAAC,MAAM,CAAC;YAC9B,SAAS,UAAU,IAAI,CAAC,MAAM,CAAC;YAC/B;QACF;QAEA,OAAO,WAAW,SAAS,OAAO,OAAO;IAC3C,EAAE,OAAO,KAAK;QACZ,MAAM,IAAI,OAAO,YAAY,CAAC;IAChC;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5086, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/secs.js"],"sourcesContent":["const minute = 60\nconst hour = minute * 60\nconst day = hour * 24\nconst week = day * 7\nconst year = day * 365.25\n\nconst REGEX = /^(\\d+|\\d+\\.\\d+) ?(seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)$/i\n\nmodule.exports = (str) => {\n  const matched = REGEX.exec(str)\n\n  if (!matched) {\n    throw new TypeError(`invalid time period format (\"${str}\")`)\n  }\n\n  const value = parseFloat(matched[1])\n  const unit = matched[2].toLowerCase()\n\n  switch (unit) {\n    case 'sec':\n    case 'secs':\n    case 'second':\n    case 'seconds':\n    case 's':\n      return Math.round(value)\n    case 'minute':\n    case 'minutes':\n    case 'min':\n    case 'mins':\n    case 'm':\n      return Math.round(value * minute)\n    case 'hour':\n    case 'hours':\n    case 'hr':\n    case 'hrs':\n    case 'h':\n      return Math.round(value * hour)\n    case 'day':\n    case 'days':\n    case 'd':\n      return Math.round(value * day)\n    case 'week':\n    case 'weeks':\n    case 'w':\n      return Math.round(value * week)\n    case 'year':\n    case 'years':\n    case 'yr':\n    case 'yrs':\n    case 'y':\n      return Math.round(value * year)\n  }\n}\n"],"names":[],"mappings":"AAAA,MAAM,SAAS;AACf,MAAM,OAAO,SAAS;AACtB,MAAM,MAAM,OAAO;AACnB,MAAM,OAAO,MAAM;AACnB,MAAM,OAAO,MAAM;AAEnB,MAAM,QAAQ;AAEd,OAAO,OAAO,GAAG,CAAC;IAChB,MAAM,UAAU,MAAM,IAAI,CAAC;IAE3B,IAAI,CAAC,SAAS;QACZ,MAAM,IAAI,UAAU,CAAC,6BAA6B,EAAE,IAAI,EAAE,CAAC;IAC7D;IAEA,MAAM,QAAQ,WAAW,OAAO,CAAC,EAAE;IACnC,MAAM,OAAO,OAAO,CAAC,EAAE,CAAC,WAAW;IAEnC,OAAQ;QACN,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,KAAK,KAAK,CAAC;QACpB,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,KAAK,KAAK,CAAC,QAAQ;QAC5B,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,KAAK,KAAK,CAAC,QAAQ;QAC5B,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,KAAK,KAAK,CAAC,QAAQ;QAC5B,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,KAAK,KAAK,CAAC,QAAQ;QAC5B,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;QACL,KAAK;YACH,OAAO,KAAK,KAAK,CAAC,QAAQ;IAC9B;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5139, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/help/epoch.js"],"sourcesContent":["module.exports = (date) => Math.floor(date.getTime() / 1000)\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAC,OAAS,KAAK,KAAK,CAAC,KAAK,OAAO,KAAK","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5145, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwt/shared_validations.js"],"sourcesContent":["const { JWTClaimInvalid } = require('../errors')\n\nconst isNotString = val => typeof val !== 'string' || val.length === 0\nconst isNotArrayOfStrings = val => !Array.isArray(val) || val.length === 0 || val.some(isNotString)\nconst isRequired = (Err, value, label, claim) => {\n  if (value === undefined) {\n    throw new Err(`${label} is missing`, claim, 'missing')\n  }\n}\nconst isString = (Err, value, label, claim, required = false) => {\n  if (required) {\n    isRequired(Err, value, label, claim)\n  }\n\n  if (value !== undefined && isNotString(value)) {\n    throw new Err(`${label} must be a string`, claim, 'invalid')\n  }\n}\nconst isTimestamp = (value, label, required = false) => {\n  if (required && value === undefined) {\n    throw new JWTClaimInvalid(`\"${label}\" claim is missing`, label, 'missing')\n  }\n\n  if (value !== undefined && (typeof value !== 'number')) {\n    throw new JWTClaimInvalid(`\"${label}\" claim must be a JSON numeric value`, label, 'invalid')\n  }\n}\nconst isStringOrArrayOfStrings = (value, label, required = false) => {\n  if (required && value === undefined) {\n    throw new JWTClaimInvalid(`\"${label}\" claim is missing`, label, 'missing')\n  }\n\n  if (value !== undefined && (isNotString(value) && isNotArrayOfStrings(value))) {\n    throw new JWTClaimInvalid(`\"${label}\" claim must be a string or array of strings`, label, 'invalid')\n  }\n}\n\nmodule.exports = {\n  isNotArrayOfStrings,\n  isRequired,\n  isNotString,\n  isString,\n  isTimestamp,\n  isStringOrArrayOfStrings\n}\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,eAAe,EAAE;AAEzB,MAAM,cAAc,CAAA,MAAO,OAAO,QAAQ,YAAY,IAAI,MAAM,KAAK;AACrE,MAAM,sBAAsB,CAAA,MAAO,CAAC,MAAM,OAAO,CAAC,QAAQ,IAAI,MAAM,KAAK,KAAK,IAAI,IAAI,CAAC;AACvF,MAAM,aAAa,CAAC,KAAK,OAAO,OAAO;IACrC,IAAI,UAAU,WAAW;QACvB,MAAM,IAAI,IAAI,GAAG,MAAM,WAAW,CAAC,EAAE,OAAO;IAC9C;AACF;AACA,MAAM,WAAW,CAAC,KAAK,OAAO,OAAO,OAAO,WAAW,KAAK;IAC1D,IAAI,UAAU;QACZ,WAAW,KAAK,OAAO,OAAO;IAChC;IAEA,IAAI,UAAU,aAAa,YAAY,QAAQ;QAC7C,MAAM,IAAI,IAAI,GAAG,MAAM,iBAAiB,CAAC,EAAE,OAAO;IACpD;AACF;AACA,MAAM,cAAc,CAAC,OAAO,OAAO,WAAW,KAAK;IACjD,IAAI,YAAY,UAAU,WAAW;QACnC,MAAM,IAAI,gBAAgB,CAAC,CAAC,EAAE,MAAM,kBAAkB,CAAC,EAAE,OAAO;IAClE;IAEA,IAAI,UAAU,aAAc,OAAO,UAAU,UAAW;QACtD,MAAM,IAAI,gBAAgB,CAAC,CAAC,EAAE,MAAM,oCAAoC,CAAC,EAAE,OAAO;IACpF;AACF;AACA,MAAM,2BAA2B,CAAC,OAAO,OAAO,WAAW,KAAK;IAC9D,IAAI,YAAY,UAAU,WAAW;QACnC,MAAM,IAAI,gBAAgB,CAAC,CAAC,EAAE,MAAM,kBAAkB,CAAC,EAAE,OAAO;IAClE;IAEA,IAAI,UAAU,aAAc,YAAY,UAAU,oBAAoB,QAAS;QAC7E,MAAM,IAAI,gBAAgB,CAAC,CAAC,EAAE,MAAM,4CAA4C,CAAC,EAAE,OAAO;IAC5F;AACF;AAEA,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;IACA;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5190, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwt/sign.js"],"sourcesContent":["const isObject = require('../help/is_object')\nconst secs = require('../help/secs')\nconst epoch = require('../help/epoch')\nconst getKey = require('../help/get_key')\nconst JWS = require('../jws')\n\nconst isString = require('./shared_validations').isString.bind(undefined, TypeError)\n\nconst validateOptions = (options) => {\n  if (typeof options.iat !== 'boolean') {\n    throw new TypeError('options.iat must be a boolean')\n  }\n\n  if (typeof options.kid !== 'boolean') {\n    throw new TypeError('options.kid must be a boolean')\n  }\n\n  isString(options.subject, 'options.subject')\n  isString(options.issuer, 'options.issuer')\n\n  if (\n    options.audience !== undefined &&\n    (\n      (typeof options.audience !== 'string' || !options.audience) &&\n      (!Array.isArray(options.audience) || options.audience.length === 0 || options.audience.some(a => !a || typeof a !== 'string'))\n    )\n  ) {\n    throw new TypeError('options.audience must be a string or an array of strings')\n  }\n\n  if (!isObject(options.header)) {\n    throw new TypeError('options.header must be an object')\n  }\n\n  isString(options.algorithm, 'options.algorithm')\n  isString(options.expiresIn, 'options.expiresIn')\n  isString(options.notBefore, 'options.notBefore')\n  isString(options.jti, 'options.jti')\n\n  if (options.now !== undefined && (!(options.now instanceof Date) || !options.now.getTime())) {\n    throw new TypeError('options.now must be a valid Date object')\n  }\n}\n\nmodule.exports = (payload, key, options = {}) => {\n  if (!isObject(options)) {\n    throw new TypeError('options must be an object')\n  }\n\n  const {\n    algorithm, audience, expiresIn, header = {}, iat = true,\n    issuer, jti, kid = true, notBefore, subject, now\n  } = options\n\n  validateOptions({\n    algorithm, audience, expiresIn, header, iat, issuer, jti, kid, notBefore, now, subject\n  })\n\n  if (!isObject(payload)) {\n    throw new TypeError('payload must be an object')\n  }\n\n  let unix\n  if (expiresIn || notBefore || iat) {\n    unix = epoch(now || new Date())\n  }\n\n  payload = {\n    ...payload,\n    sub: subject || payload.sub,\n    aud: audience || payload.aud,\n    iss: issuer || payload.iss,\n    jti: jti || payload.jti,\n    iat: iat ? unix : payload.iat,\n    exp: expiresIn ? unix + secs(expiresIn) : payload.exp,\n    nbf: notBefore ? unix + secs(notBefore) : payload.nbf\n  }\n\n  key = getKey(key)\n\n  let includeKid\n\n  if (typeof options.kid === 'boolean') {\n    includeKid = kid\n  } else {\n    includeKid = !key.secret\n  }\n\n  return JWS.sign(JSON.stringify(payload), key, {\n    ...header,\n    alg: algorithm || header.alg,\n    kid: includeKid ? key.kid : header.kid\n  })\n}\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AAEN,MAAM,WAAW,qIAAgC,QAAQ,CAAC,IAAI,CAAC,WAAW;AAE1E,MAAM,kBAAkB,CAAC;IACvB,IAAI,OAAO,QAAQ,GAAG,KAAK,WAAW;QACpC,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI,OAAO,QAAQ,GAAG,KAAK,WAAW;QACpC,MAAM,IAAI,UAAU;IACtB;IAEA,SAAS,QAAQ,OAAO,EAAE;IAC1B,SAAS,QAAQ,MAAM,EAAE;IAEzB,IACE,QAAQ,QAAQ,KAAK,aAEnB,CAAC,OAAO,QAAQ,QAAQ,KAAK,YAAY,CAAC,QAAQ,QAAQ,KAC1D,CAAC,CAAC,MAAM,OAAO,CAAC,QAAQ,QAAQ,KAAK,QAAQ,QAAQ,CAAC,MAAM,KAAK,KAAK,QAAQ,QAAQ,CAAC,IAAI,CAAC,CAAA,IAAK,CAAC,KAAK,OAAO,MAAM,SAAS,GAE/H;QACA,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI,CAAC,SAAS,QAAQ,MAAM,GAAG;QAC7B,MAAM,IAAI,UAAU;IACtB;IAEA,SAAS,QAAQ,SAAS,EAAE;IAC5B,SAAS,QAAQ,SAAS,EAAE;IAC5B,SAAS,QAAQ,SAAS,EAAE;IAC5B,SAAS,QAAQ,GAAG,EAAE;IAEtB,IAAI,QAAQ,GAAG,KAAK,aAAa,CAAC,CAAC,CAAC,QAAQ,GAAG,YAAY,IAAI,KAAK,CAAC,QAAQ,GAAG,CAAC,OAAO,EAAE,GAAG;QAC3F,MAAM,IAAI,UAAU;IACtB;AACF;AAEA,OAAO,OAAO,GAAG,CAAC,SAAS,KAAK,UAAU,CAAC,CAAC;IAC1C,IAAI,CAAC,SAAS,UAAU;QACtB,MAAM,IAAI,UAAU;IACtB;IAEA,MAAM,EACJ,SAAS,EAAE,QAAQ,EAAE,SAAS,EAAE,SAAS,CAAC,CAAC,EAAE,MAAM,IAAI,EACvD,MAAM,EAAE,GAAG,EAAE,MAAM,IAAI,EAAE,SAAS,EAAE,OAAO,EAAE,GAAG,EACjD,GAAG;IAEJ,gBAAgB;QACd;QAAW;QAAU;QAAW;QAAQ;QAAK;QAAQ;QAAK;QAAK;QAAW;QAAK;IACjF;IAEA,IAAI,CAAC,SAAS,UAAU;QACtB,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI;IACJ,IAAI,aAAa,aAAa,KAAK;QACjC,OAAO,MAAM,OAAO,IAAI;IAC1B;IAEA,UAAU;QACR,GAAG,OAAO;QACV,KAAK,WAAW,QAAQ,GAAG;QAC3B,KAAK,YAAY,QAAQ,GAAG;QAC5B,KAAK,UAAU,QAAQ,GAAG;QAC1B,KAAK,OAAO,QAAQ,GAAG;QACvB,KAAK,MAAM,OAAO,QAAQ,GAAG;QAC7B,KAAK,YAAY,OAAO,KAAK,aAAa,QAAQ,GAAG;QACrD,KAAK,YAAY,OAAO,KAAK,aAAa,QAAQ,GAAG;IACvD;IAEA,MAAM,OAAO;IAEb,IAAI;IAEJ,IAAI,OAAO,QAAQ,GAAG,KAAK,WAAW;QACpC,aAAa;IACf,OAAO;QACL,aAAa,CAAC,IAAI,MAAM;IAC1B;IAEA,OAAO,IAAI,IAAI,CAAC,KAAK,SAAS,CAAC,UAAU,KAAK;QAC5C,GAAG,MAAM;QACT,KAAK,aAAa,OAAO,GAAG;QAC5B,KAAK,aAAa,IAAI,GAAG,GAAG,OAAO,GAAG;IACxC;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5272, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwt/verify.js"],"sourcesContent":["const isObject = require('../help/is_object')\nconst epoch = require('../help/epoch')\nconst secs = require('../help/secs')\nconst getKey = require('../help/get_key')\nconst { bare: verify } = require('../jws/verify')\nconst { JWTClaimInvalid, JWTExpired } = require('../errors')\n\nconst {\n  isString,\n  isNotString,\n  isNotArrayOfStrings,\n  isTimestamp,\n  isStringOrArrayOfStrings\n} = require('./shared_validations')\nconst decode = require('./decode')\n\nconst isPayloadString = isString.bind(undefined, JWTClaimInvalid)\nconst isOptionString = isString.bind(undefined, TypeError)\n\nconst normalizeTyp = (value) => value.toLowerCase().replace(/^application\\//, '')\n\nconst validateOptions = ({\n  algorithms, audience, clockTolerance, complete = false, crit, ignoreExp = false,\n  ignoreIat = false, ignoreNbf = false, issuer, jti, maxTokenAge, now = new Date(),\n  subject, typ\n}) => {\n  if (typeof complete !== 'boolean') {\n    throw new TypeError('options.complete must be a boolean')\n  }\n\n  if (typeof ignoreExp !== 'boolean') {\n    throw new TypeError('options.ignoreExp must be a boolean')\n  }\n\n  if (typeof ignoreNbf !== 'boolean') {\n    throw new TypeError('options.ignoreNbf must be a boolean')\n  }\n\n  if (typeof ignoreIat !== 'boolean') {\n    throw new TypeError('options.ignoreIat must be a boolean')\n  }\n\n  isOptionString(maxTokenAge, 'options.maxTokenAge')\n  isOptionString(subject, 'options.subject')\n  isOptionString(jti, 'options.jti')\n  isOptionString(clockTolerance, 'options.clockTolerance')\n  isOptionString(typ, 'options.typ')\n\n  if (issuer !== undefined && (isNotString(issuer) && isNotArrayOfStrings(issuer))) {\n    throw new TypeError('options.issuer must be a string or an array of strings')\n  }\n\n  if (audience !== undefined && (isNotString(audience) && isNotArrayOfStrings(audience))) {\n    throw new TypeError('options.audience must be a string or an array of strings')\n  }\n\n  if (algorithms !== undefined && isNotArrayOfStrings(algorithms)) {\n    throw new TypeError('options.algorithms must be an array of strings')\n  }\n\n  if (!(now instanceof Date) || !now.getTime()) {\n    throw new TypeError('options.now must be a valid Date object')\n  }\n\n  if (ignoreIat && maxTokenAge !== undefined) {\n    throw new TypeError('options.ignoreIat and options.maxTokenAge cannot used together')\n  }\n\n  if (crit !== undefined && isNotArrayOfStrings(crit)) {\n    throw new TypeError('options.crit must be an array of strings')\n  }\n\n  return {\n    algorithms,\n    audience,\n    clockTolerance,\n    complete,\n    crit,\n    ignoreExp,\n    ignoreIat,\n    ignoreNbf,\n    issuer,\n    jti,\n    maxTokenAge,\n    now,\n    subject,\n    typ\n  }\n}\n\nconst validateTypes = ({ header, payload }, options) => {\n  isPayloadString(header.alg, '\"alg\" header parameter', 'alg', true)\n\n  isTimestamp(payload.iat, 'iat', !!options.maxTokenAge)\n  isTimestamp(payload.exp, 'exp')\n  isTimestamp(payload.nbf, 'nbf')\n  isPayloadString(payload.jti, '\"jti\" claim', 'jti', !!options.jti)\n  isStringOrArrayOfStrings(payload.iss, 'iss', !!options.issuer)\n  isPayloadString(payload.sub, '\"sub\" claim', 'sub', !!options.subject)\n  isStringOrArrayOfStrings(payload.aud, 'aud', !!options.audience)\n  isPayloadString(header.typ, '\"typ\" header parameter', 'typ', !!options.typ)\n}\n\nconst checkAudiencePresence = (audPayload, audOption) => {\n  if (typeof audPayload === 'string') {\n    return audOption.includes(audPayload)\n  }\n\n  // Each principal intended to process the JWT MUST\n  // identify itself with a value in the audience claim\n  audPayload = new Set(audPayload)\n  return audOption.some(Set.prototype.has.bind(audPayload))\n}\n\nmodule.exports = (token, key, options = {}) => {\n  if (!isObject(options)) {\n    throw new TypeError('options must be an object')\n  }\n\n  const {\n    algorithms, audience, clockTolerance, complete, crit, ignoreExp, ignoreIat, ignoreNbf, issuer,\n    jti, maxTokenAge, now, subject, typ\n  } = options = validateOptions(options)\n\n  const decoded = decode(token, { complete: true })\n  key = getKey(key, true)\n\n  if (complete) {\n    ({ key } = verify(true, 'preparsed', { decoded, token }, key, { crit, algorithms, complete: true }))\n    decoded.key = key\n  } else {\n    verify(true, 'preparsed', { decoded, token }, key, { crit, algorithms })\n  }\n\n  const unix = epoch(now)\n  validateTypes(decoded, options)\n\n  if (issuer && (typeof decoded.payload.iss !== 'string' || !(typeof issuer === 'string' ? [issuer] : issuer).includes(decoded.payload.iss))) {\n    throw new JWTClaimInvalid('unexpected \"iss\" claim value', 'iss', 'check_failed')\n  }\n\n  if (subject && decoded.payload.sub !== subject) {\n    throw new JWTClaimInvalid('unexpected \"sub\" claim value', 'sub', 'check_failed')\n  }\n\n  if (jti && decoded.payload.jti !== jti) {\n    throw new JWTClaimInvalid('unexpected \"jti\" claim value', 'jti', 'check_failed')\n  }\n\n  if (audience && !checkAudiencePresence(decoded.payload.aud, typeof audience === 'string' ? [audience] : audience)) {\n    throw new JWTClaimInvalid('unexpected \"aud\" claim value', 'aud', 'check_failed')\n  }\n\n  if (typ && normalizeTyp(decoded.header.typ) !== normalizeTyp(typ)) {\n    throw new JWTClaimInvalid('unexpected \"typ\" JWT header value', 'typ', 'check_failed')\n  }\n\n  const tolerance = clockTolerance ? secs(clockTolerance) : 0\n\n  if (!ignoreIat && !('exp' in decoded.payload) && 'iat' in decoded.payload && decoded.payload.iat > unix + tolerance) {\n    throw new JWTClaimInvalid('\"iat\" claim timestamp check failed (it should be in the past)', 'iat', 'check_failed')\n  }\n\n  if (!ignoreNbf && 'nbf' in decoded.payload && decoded.payload.nbf > unix + tolerance) {\n    throw new JWTClaimInvalid('\"nbf\" claim timestamp check failed', 'nbf', 'check_failed')\n  }\n\n  if (!ignoreExp && 'exp' in decoded.payload && decoded.payload.exp <= unix - tolerance) {\n    throw new JWTExpired('\"exp\" claim timestamp check failed', 'exp', 'check_failed')\n  }\n\n  if (maxTokenAge) {\n    const age = unix - decoded.payload.iat\n    const max = secs(maxTokenAge)\n\n    if (age - tolerance > max) {\n      throw new JWTExpired('\"iat\" claim timestamp check failed (too far in the past)', 'iat', 'check_failed')\n    }\n\n    if (age < 0 - tolerance) {\n      throw new JWTClaimInvalid('\"iat\" claim timestamp check failed (it should be in the past)', 'iat', 'check_failed')\n    }\n  }\n\n  return complete ? decoded : decoded.payload\n}\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5432, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwt/profiles.js"],"sourcesContent":["const { JWTClaimInvalid } = require('../errors')\nconst secs = require('../help/secs')\nconst epoch = require('../help/epoch')\nconst isObject = require('../help/is_object')\n\nconst verify = require('./verify')\nconst {\n  isString,\n  isRequired,\n  isTimestamp,\n  isStringOrArrayOfStrings\n} = require('./shared_validations')\n\nconst isPayloadRequired = isRequired.bind(undefined, JWTClaimInvalid)\nconst isPayloadString = isString.bind(undefined, JWTClaimInvalid)\nconst isOptionString = isString.bind(undefined, TypeError)\n\nconst defineLazyExportWithWarning = (obj, property, name, definition) => {\n  Object.defineProperty(obj, property, {\n    enumerable: true,\n    configurable: true,\n    value (...args) {\n      process.emitWarning(\n        `The ${name} API implements an IETF draft. Breaking draft implementations are included as minor versions of the jose library, therefore, the ~ semver operator should be used and close attention be payed to library changelog as well as the drafts themselves.`,\n        'DraftWarning'\n      )\n      Object.defineProperty(obj, property, {\n        enumerable: true,\n        configurable: true,\n        value: definition\n      })\n      return obj[property](...args)\n    }\n  })\n}\n\nconst validateCommonOptions = (options, profile) => {\n  if (!isObject(options)) {\n    throw new TypeError('options must be an object')\n  }\n\n  if (!options.issuer) {\n    throw new TypeError(`\"issuer\" option is required to validate ${profile}`)\n  }\n\n  if (!options.audience) {\n    throw new TypeError(`\"audience\" option is required to validate ${profile}`)\n  }\n}\n\nmodule.exports = {\n  IdToken: {\n    verify: (token, key, options = {}) => {\n      validateCommonOptions(options, 'an ID Token')\n\n      if ('maxAuthAge' in options) {\n        isOptionString(options.maxAuthAge, 'options.maxAuthAge')\n      }\n      if ('nonce' in options) {\n        isOptionString(options.nonce, 'options.nonce')\n      }\n\n      const unix = epoch(options.now || new Date())\n      const result = verify(token, key, { ...options })\n      const payload = options.complete ? result.payload : result\n\n      if (Array.isArray(payload.aud) && payload.aud.length > 1) {\n        isPayloadRequired(payload.azp, '\"azp\" claim', 'azp')\n      }\n      isPayloadRequired(payload.iat, '\"iat\" claim', 'iat')\n      isPayloadRequired(payload.sub, '\"sub\" claim', 'sub')\n      isPayloadRequired(payload.exp, '\"exp\" claim', 'exp')\n      isTimestamp(payload.auth_time, 'auth_time', !!options.maxAuthAge)\n      isPayloadString(payload.nonce, '\"nonce\" claim', 'nonce', !!options.nonce)\n      isPayloadString(payload.acr, '\"acr\" claim', 'acr')\n      isStringOrArrayOfStrings(payload.amr, 'amr')\n\n      if (options.nonce && payload.nonce !== options.nonce) {\n        throw new JWTClaimInvalid('unexpected \"nonce\" claim value', 'nonce', 'check_failed')\n      }\n\n      const tolerance = options.clockTolerance ? secs(options.clockTolerance) : 0\n\n      if (options.maxAuthAge) {\n        const maxAuthAgeSeconds = secs(options.maxAuthAge)\n        if (payload.auth_time + maxAuthAgeSeconds < unix - tolerance) {\n          throw new JWTClaimInvalid('\"auth_time\" claim timestamp check failed (too much time has elapsed since the last End-User authentication)', 'auth_time', 'check_failed')\n        }\n      }\n\n      if (Array.isArray(payload.aud) && payload.aud.length > 1 && payload.azp !== options.audience) {\n        throw new JWTClaimInvalid('unexpected \"azp\" claim value', 'azp', 'check_failed')\n      }\n\n      return result\n    }\n  },\n  LogoutToken: {},\n  AccessToken: {}\n}\n\ndefineLazyExportWithWarning(module.exports.LogoutToken, 'verify', 'jose.JWT.LogoutToken.verify', (token, key, options = {}) => {\n  validateCommonOptions(options, 'a Logout Token')\n\n  const result = verify(token, key, { ...options })\n  const payload = options.complete ? result.payload : result\n\n  isPayloadRequired(payload.iat, '\"iat\" claim', 'iat')\n  isPayloadRequired(payload.jti, '\"jti\" claim', 'jti')\n  isPayloadString(payload.sid, '\"sid\" claim', 'sid')\n\n  if (!('sid' in payload) && !('sub' in payload)) {\n    throw new JWTClaimInvalid('either \"sid\" or \"sub\" (or both) claims must be present')\n  }\n\n  if ('nonce' in payload) {\n    throw new JWTClaimInvalid('\"nonce\" claim is prohibited', 'nonce', 'prohibited')\n  }\n\n  if (!('events' in payload)) {\n    throw new JWTClaimInvalid('\"events\" claim is missing', 'events', 'missing')\n  }\n\n  if (!isObject(payload.events)) {\n    throw new JWTClaimInvalid('\"events\" claim must be an object', 'events', 'invalid')\n  }\n\n  if (!('http://schemas.openid.net/event/backchannel-logout' in payload.events)) {\n    throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member is missing in the \"events\" claim', 'events', 'invalid')\n  }\n\n  if (!isObject(payload.events['http://schemas.openid.net/event/backchannel-logout'])) {\n    throw new JWTClaimInvalid('\"http://schemas.openid.net/event/backchannel-logout\" member in the \"events\" claim must be an object', 'events', 'invalid')\n  }\n\n  return result\n})\n\ndefineLazyExportWithWarning(module.exports.AccessToken, 'verify', 'jose.JWT.AccessToken.verify', (token, key, options = {}) => {\n  validateCommonOptions(options, 'a JWT Access Token')\n\n  isOptionString(options.maxAuthAge, 'options.maxAuthAge')\n\n  const unix = epoch(options.now || new Date())\n  const typ = 'at+JWT'\n  const result = verify(token, key, { ...options, typ })\n  const payload = options.complete ? result.payload : result\n\n  isPayloadRequired(payload.iat, '\"iat\" claim', 'iat')\n  isPayloadRequired(payload.exp, '\"exp\" claim', 'exp')\n  isPayloadRequired(payload.sub, '\"sub\" claim', 'sub')\n  isPayloadRequired(payload.jti, '\"jti\" claim', 'jti')\n  isPayloadString(payload.client_id, '\"client_id\" claim', 'client_id', true)\n  isTimestamp(payload.auth_time, 'auth_time', !!options.maxAuthAge)\n  isPayloadString(payload.acr, '\"acr\" claim', 'acr')\n  isStringOrArrayOfStrings(payload.amr, 'amr')\n\n  const tolerance = options.clockTolerance ? secs(options.clockTolerance) : 0\n\n  if (options.maxAuthAge) {\n    const maxAuthAgeSeconds = secs(options.maxAuthAge)\n    if (payload.auth_time + maxAuthAgeSeconds < unix - tolerance) {\n      throw new JWTClaimInvalid('\"auth_time\" claim timestamp check failed (too much time has elapsed since the last End-User authentication)', 'auth_time', 'check_failed')\n    }\n  }\n\n  return result\n})\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,eAAe,EAAE;AACzB,MAAM;AACN,MAAM;AACN,MAAM;AAEN,MAAM;AACN,MAAM,EACJ,QAAQ,EACR,UAAU,EACV,WAAW,EACX,wBAAwB,EACzB;AAED,MAAM,oBAAoB,WAAW,IAAI,CAAC,WAAW;AACrD,MAAM,kBAAkB,SAAS,IAAI,CAAC,WAAW;AACjD,MAAM,iBAAiB,SAAS,IAAI,CAAC,WAAW;AAEhD,MAAM,8BAA8B,CAAC,KAAK,UAAU,MAAM;IACxD,OAAO,cAAc,CAAC,KAAK,UAAU;QACnC,YAAY;QACZ,cAAc;QACd,OAAO,GAAG,IAAI;YACZ,QAAQ,WAAW,CACjB,CAAC,IAAI,EAAE,KAAK,qPAAqP,CAAC,EAClQ;YAEF,OAAO,cAAc,CAAC,KAAK,UAAU;gBACnC,YAAY;gBACZ,cAAc;gBACd,OAAO;YACT;YACA,OAAO,GAAG,CAAC,SAAS,IAAI;QAC1B;IACF;AACF;AAEA,MAAM,wBAAwB,CAAC,SAAS;IACtC,IAAI,CAAC,SAAS,UAAU;QACtB,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI,CAAC,QAAQ,MAAM,EAAE;QACnB,MAAM,IAAI,UAAU,CAAC,wCAAwC,EAAE,SAAS;IAC1E;IAEA,IAAI,CAAC,QAAQ,QAAQ,EAAE;QACrB,MAAM,IAAI,UAAU,CAAC,0CAA0C,EAAE,SAAS;IAC5E;AACF;AAEA,OAAO,OAAO,GAAG;IACf,SAAS;QACP,QAAQ,CAAC,OAAO,KAAK,UAAU,CAAC,CAAC;YAC/B,sBAAsB,SAAS;YAE/B,IAAI,gBAAgB,SAAS;gBAC3B,eAAe,QAAQ,UAAU,EAAE;YACrC;YACA,IAAI,WAAW,SAAS;gBACtB,eAAe,QAAQ,KAAK,EAAE;YAChC;YAEA,MAAM,OAAO,MAAM,QAAQ,GAAG,IAAI,IAAI;YACtC,MAAM,SAAS,OAAO,OAAO,KAAK;gBAAE,GAAG,OAAO;YAAC;YAC/C,MAAM,UAAU,QAAQ,QAAQ,GAAG,OAAO,OAAO,GAAG;YAEpD,IAAI,MAAM,OAAO,CAAC,QAAQ,GAAG,KAAK,QAAQ,GAAG,CAAC,MAAM,GAAG,GAAG;gBACxD,kBAAkB,QAAQ,GAAG,EAAE,eAAe;YAChD;YACA,kBAAkB,QAAQ,GAAG,EAAE,eAAe;YAC9C,kBAAkB,QAAQ,GAAG,EAAE,eAAe;YAC9C,kBAAkB,QAAQ,GAAG,EAAE,eAAe;YAC9C,YAAY,QAAQ,SAAS,EAAE,aAAa,CAAC,CAAC,QAAQ,UAAU;YAChE,gBAAgB,QAAQ,KAAK,EAAE,iBAAiB,SAAS,CAAC,CAAC,QAAQ,KAAK;YACxE,gBAAgB,QAAQ,GAAG,EAAE,eAAe;YAC5C,yBAAyB,QAAQ,GAAG,EAAE;YAEtC,IAAI,QAAQ,KAAK,IAAI,QAAQ,KAAK,KAAK,QAAQ,KAAK,EAAE;gBACpD,MAAM,IAAI,gBAAgB,kCAAkC,SAAS;YACvE;YAEA,MAAM,YAAY,QAAQ,cAAc,GAAG,KAAK,QAAQ,cAAc,IAAI;YAE1E,IAAI,QAAQ,UAAU,EAAE;gBACtB,MAAM,oBAAoB,KAAK,QAAQ,UAAU;gBACjD,IAAI,QAAQ,SAAS,GAAG,oBAAoB,OAAO,WAAW;oBAC5D,MAAM,IAAI,gBAAgB,+GAA+G,aAAa;gBACxJ;YACF;YAEA,IAAI,MAAM,OAAO,CAAC,QAAQ,GAAG,KAAK,QAAQ,GAAG,CAAC,MAAM,GAAG,KAAK,QAAQ,GAAG,KAAK,QAAQ,QAAQ,EAAE;gBAC5F,MAAM,IAAI,gBAAgB,gCAAgC,OAAO;YACnE;YAEA,OAAO;QACT;IACF;IACA,aAAa,CAAC;IACd,aAAa,CAAC;AAChB;AAEA,4BAA4B,OAAO,OAAO,CAAC,WAAW,EAAE,UAAU,+BAA+B,CAAC,OAAO,KAAK,UAAU,CAAC,CAAC;IACxH,sBAAsB,SAAS;IAE/B,MAAM,SAAS,OAAO,OAAO,KAAK;QAAE,GAAG,OAAO;IAAC;IAC/C,MAAM,UAAU,QAAQ,QAAQ,GAAG,OAAO,OAAO,GAAG;IAEpD,kBAAkB,QAAQ,GAAG,EAAE,eAAe;IAC9C,kBAAkB,QAAQ,GAAG,EAAE,eAAe;IAC9C,gBAAgB,QAAQ,GAAG,EAAE,eAAe;IAE5C,IAAI,CAAC,CAAC,SAAS,OAAO,KAAK,CAAC,CAAC,SAAS,OAAO,GAAG;QAC9C,MAAM,IAAI,gBAAgB;IAC5B;IAEA,IAAI,WAAW,SAAS;QACtB,MAAM,IAAI,gBAAgB,+BAA+B,SAAS;IACpE;IAEA,IAAI,CAAC,CAAC,YAAY,OAAO,GAAG;QAC1B,MAAM,IAAI,gBAAgB,6BAA6B,UAAU;IACnE;IAEA,IAAI,CAAC,SAAS,QAAQ,MAAM,GAAG;QAC7B,MAAM,IAAI,gBAAgB,oCAAoC,UAAU;IAC1E;IAEA,IAAI,CAAC,CAAC,wDAAwD,QAAQ,MAAM,GAAG;QAC7E,MAAM,IAAI,gBAAgB,gGAAgG,UAAU;IACtI;IAEA,IAAI,CAAC,SAAS,QAAQ,MAAM,CAAC,qDAAqD,GAAG;QACnF,MAAM,IAAI,gBAAgB,uGAAuG,UAAU;IAC7I;IAEA,OAAO;AACT;AAEA,4BAA4B,OAAO,OAAO,CAAC,WAAW,EAAE,UAAU,+BAA+B,CAAC,OAAO,KAAK,UAAU,CAAC,CAAC;IACxH,sBAAsB,SAAS;IAE/B,eAAe,QAAQ,UAAU,EAAE;IAEnC,MAAM,OAAO,MAAM,QAAQ,GAAG,IAAI,IAAI;IACtC,MAAM,MAAM;IACZ,MAAM,SAAS,OAAO,OAAO,KAAK;QAAE,GAAG,OAAO;QAAE;IAAI;IACpD,MAAM,UAAU,QAAQ,QAAQ,GAAG,OAAO,OAAO,GAAG;IAEpD,kBAAkB,QAAQ,GAAG,EAAE,eAAe;IAC9C,kBAAkB,QAAQ,GAAG,EAAE,eAAe;IAC9C,kBAAkB,QAAQ,GAAG,EAAE,eAAe;IAC9C,kBAAkB,QAAQ,GAAG,EAAE,eAAe;IAC9C,gBAAgB,QAAQ,SAAS,EAAE,qBAAqB,aAAa;IACrE,YAAY,QAAQ,SAAS,EAAE,aAAa,CAAC,CAAC,QAAQ,UAAU;IAChE,gBAAgB,QAAQ,GAAG,EAAE,eAAe;IAC5C,yBAAyB,QAAQ,GAAG,EAAE;IAEtC,MAAM,YAAY,QAAQ,cAAc,GAAG,KAAK,QAAQ,cAAc,IAAI;IAE1E,IAAI,QAAQ,UAAU,EAAE;QACtB,MAAM,oBAAoB,KAAK,QAAQ,UAAU;QACjD,IAAI,QAAQ,SAAS,GAAG,oBAAoB,OAAO,WAAW;YAC5D,MAAM,IAAI,gBAAgB,+GAA+G,aAAa;QACxJ;IACF;IAEA,OAAO;AACT","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5572, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/jwt/index.js"],"sourcesContent":["const decode = require('./decode')\nconst sign = require('./sign')\nconst verify = require('./verify')\nconst profiles = require('./profiles')\n\nmodule.exports = {\n  sign,\n  verify,\n  ...profiles\n}\n\nObject.defineProperty(module.exports, 'decode', {\n  enumerable: false,\n  configurable: true,\n  value: decode\n})\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM;AAEN,OAAO,OAAO,GAAG;IACf;IACA;IACA,GAAG,QAAQ;AACb;AAEA,OAAO,cAAc,CAAC,OAAO,OAAO,EAAE,UAAU;IAC9C,YAAY;IACZ,cAAc;IACd,OAAO;AACT","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 5591, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/xero-node/node_modules/jose/lib/index.js"],"sourcesContent":["module.exports = {\n  JWE: require('./jwe'),\n  JWK: require('./jwk'),\n  JWKS: require('./jwks'),\n  JWS: require('./jws'),\n  JWT: require('./jwt'),\n  errors: require('./errors')\n}\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG;IACf,GAAG;IACH,GAAG;IACH,IAAI;IACJ,GAAG;IACH,GAAG;IACH,MAAM;AACR","ignoreList":[0],"debugId":null}}]
}