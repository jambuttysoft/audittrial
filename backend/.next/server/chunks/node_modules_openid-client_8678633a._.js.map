{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 6, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/errors.js"],"sourcesContent":["/* eslint-disable camelcase */\nconst { format } = require('util');\n\nconst makeError = require('make-error');\n\nfunction OPError({\n  error_description,\n  error,\n  error_uri,\n  session_state,\n  state,\n  scope,\n}, response) {\n  OPError.super.call(this, !error_description ? error : `${error} (${error_description})`);\n\n  Object.assign(\n    this,\n    { error },\n    (error_description && { error_description }),\n    (error_uri && { error_uri }),\n    (state && { state }),\n    (scope && { scope }),\n    (session_state && { session_state }),\n  );\n\n  if (response) {\n    Object.defineProperty(this, 'response', {\n      value: response,\n    });\n  }\n}\n\nmakeError(OPError);\n\nfunction RPError(...args) {\n  if (typeof args[0] === 'string') {\n    RPError.super.call(this, format(...args));\n  } else {\n    const {\n      message, printf, response, ...rest\n    } = args[0];\n    if (printf) {\n      RPError.super.call(this, format(...printf));\n    } else {\n      RPError.super.call(this, message);\n    }\n    Object.assign(this, rest);\n    if (response) {\n      Object.defineProperty(this, 'response', {\n        value: response,\n      });\n    }\n  }\n}\n\nmakeError(RPError);\n\nmodule.exports = {\n  OPError,\n  RPError,\n};\n"],"names":[],"mappings":"AAAA,4BAA4B,GAC5B,MAAM,EAAE,MAAM,EAAE;AAEhB,MAAM;AAEN,SAAS,QAAQ,EACf,iBAAiB,EACjB,KAAK,EACL,SAAS,EACT,aAAa,EACb,KAAK,EACL,KAAK,EACN,EAAE,QAAQ;IACT,QAAQ,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC,oBAAoB,QAAQ,GAAG,MAAM,EAAE,EAAE,kBAAkB,CAAC,CAAC;IAEvF,OAAO,MAAM,CACX,IAAI,EACJ;QAAE;IAAM,GACP,qBAAqB;QAAE;IAAkB,GACzC,aAAa;QAAE;IAAU,GACzB,SAAS;QAAE;IAAM,GACjB,SAAS;QAAE;IAAM,GACjB,iBAAiB;QAAE;IAAc;IAGpC,IAAI,UAAU;QACZ,OAAO,cAAc,CAAC,IAAI,EAAE,YAAY;YACtC,OAAO;QACT;IACF;AACF;AAEA,UAAU;AAEV,SAAS,QAAQ,GAAG,IAAI;IACtB,IAAI,OAAO,IAAI,CAAC,EAAE,KAAK,UAAU;QAC/B,QAAQ,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU;IACrC,OAAO;QACL,MAAM,EACJ,OAAO,EAAE,MAAM,EAAE,QAAQ,EAAE,GAAG,MAC/B,GAAG,IAAI,CAAC,EAAE;QACX,IAAI,QAAQ;YACV,QAAQ,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE,UAAU;QACrC,OAAO;YACL,QAAQ,KAAK,CAAC,IAAI,CAAC,IAAI,EAAE;QAC3B;QACA,OAAO,MAAM,CAAC,IAAI,EAAE;QACpB,IAAI,UAAU;YACZ,OAAO,cAAc,CAAC,IAAI,EAAE,YAAY;gBACtC,OAAO;YACT;QACF;IACF;AACF;AAEA,UAAU;AAEV,OAAO,OAAO,GAAG;IACf;IACA;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 58, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/base64url.js"],"sourcesContent":["let encode;\nif (Buffer.isEncoding('base64url')) {\n  encode = (input, encoding = 'utf8') => Buffer.from(input, encoding).toString('base64url');\n} else {\n  const fromBase64 = (base64) => base64.replace(/=/g, '').replace(/\\+/g, '-').replace(/\\//g, '_');\n  encode = (input, encoding = 'utf8') => fromBase64(Buffer.from(input, encoding).toString('base64'));\n}\n\nconst decode = (input) => Buffer.from(input, 'base64');\n\nmodule.exports.decode = decode;\nmodule.exports.encode = encode;\n"],"names":[],"mappings":"AAAA,IAAI;AACJ,IAAI,OAAO,UAAU,CAAC,cAAc;IAClC,SAAS,CAAC,OAAO,WAAW,MAAM,GAAK,OAAO,IAAI,CAAC,OAAO,UAAU,QAAQ,CAAC;AAC/E,OAAO;IACL,MAAM,aAAa,CAAC,SAAW,OAAO,OAAO,CAAC,MAAM,IAAI,OAAO,CAAC,OAAO,KAAK,OAAO,CAAC,OAAO;IAC3F,SAAS,CAAC,OAAO,WAAW,MAAM,GAAK,WAAW,OAAO,IAAI,CAAC,OAAO,UAAU,QAAQ,CAAC;AAC1F;AAEA,MAAM,SAAS,CAAC,QAAU,OAAO,IAAI,CAAC,OAAO;AAE7C,OAAO,OAAO,CAAC,MAAM,GAAG;AACxB,OAAO,OAAO,CAAC,MAAM,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 73, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/is_plain_object.js"],"sourcesContent":["module.exports = (a) => !!a && a.constructor === Object;\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAC,IAAM,CAAC,CAAC,KAAK,EAAE,WAAW,KAAK","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 79, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/defaults.js"],"sourcesContent":["/* eslint-disable no-restricted-syntax, no-continue */\n\nconst isPlainObject = require('./is_plain_object');\n\nfunction defaults(deep, target, ...sources) {\n  for (const source of sources) {\n    if (!isPlainObject(source)) {\n      continue;\n    }\n    for (const [key, value] of Object.entries(source)) {\n      /* istanbul ignore if */\n      if (key === '__proto__' || key === 'constructor') {\n        continue;\n      }\n      if (typeof target[key] === 'undefined' && typeof value !== 'undefined') {\n        target[key] = value;\n      }\n\n      if (deep && isPlainObject(target[key]) && isPlainObject(value)) {\n        defaults(true, target[key], value);\n      }\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = defaults.bind(undefined, false);\nmodule.exports.deep = defaults.bind(undefined, true);\n"],"names":[],"mappings":"AAAA,oDAAoD,GAEpD,MAAM;AAEN,SAAS,SAAS,IAAI,EAAE,MAAM,EAAE,GAAG,OAAO;IACxC,KAAK,MAAM,UAAU,QAAS;QAC5B,IAAI,CAAC,cAAc,SAAS;YAC1B;QACF;QACA,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,QAAS;YACjD,sBAAsB,GACtB,IAAI,QAAQ,eAAe,QAAQ,eAAe;gBAChD;YACF;YACA,IAAI,OAAO,MAAM,CAAC,IAAI,KAAK,eAAe,OAAO,UAAU,aAAa;gBACtE,MAAM,CAAC,IAAI,GAAG;YAChB;YAEA,IAAI,QAAQ,cAAc,MAAM,CAAC,IAAI,KAAK,cAAc,QAAQ;gBAC9D,SAAS,MAAM,MAAM,CAAC,IAAI,EAAE;YAC9B;QACF;IACF;IAEA,OAAO;AACT;AAEA,OAAO,OAAO,GAAG,SAAS,IAAI,CAAC,WAAW;AAC1C,OAAO,OAAO,CAAC,IAAI,GAAG,SAAS,IAAI,CAAC,WAAW","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 106, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/assert.js"],"sourcesContent":["function assertSigningAlgValuesSupport(endpoint, issuer, properties) {\n  if (!issuer[`${endpoint}_endpoint`]) return;\n\n  const eam = `${endpoint}_endpoint_auth_method`;\n  const easa = `${endpoint}_endpoint_auth_signing_alg`;\n  const easavs = `${endpoint}_endpoint_auth_signing_alg_values_supported`;\n\n  if (properties[eam] && properties[eam].endsWith('_jwt') && !properties[easa] && !issuer[easavs]) {\n    throw new TypeError(`${easavs} must be configured on the issuer if ${easa} is not defined on a client`);\n  }\n}\n\nfunction assertIssuerConfiguration(issuer, endpoint) {\n  if (!issuer[endpoint]) {\n    throw new TypeError(`${endpoint} must be configured on the issuer`);\n  }\n}\n\nmodule.exports = {\n  assertSigningAlgValuesSupport,\n  assertIssuerConfiguration,\n};\n"],"names":[],"mappings":"AAAA,SAAS,8BAA8B,QAAQ,EAAE,MAAM,EAAE,UAAU;IACjE,IAAI,CAAC,MAAM,CAAC,GAAG,SAAS,SAAS,CAAC,CAAC,EAAE;IAErC,MAAM,MAAM,GAAG,SAAS,qBAAqB,CAAC;IAC9C,MAAM,OAAO,GAAG,SAAS,0BAA0B,CAAC;IACpD,MAAM,SAAS,GAAG,SAAS,2CAA2C,CAAC;IAEvE,IAAI,UAAU,CAAC,IAAI,IAAI,UAAU,CAAC,IAAI,CAAC,QAAQ,CAAC,WAAW,CAAC,UAAU,CAAC,KAAK,IAAI,CAAC,MAAM,CAAC,OAAO,EAAE;QAC/F,MAAM,IAAI,UAAU,GAAG,OAAO,qCAAqC,EAAE,KAAK,2BAA2B,CAAC;IACxG;AACF;AAEA,SAAS,0BAA0B,MAAM,EAAE,QAAQ;IACjD,IAAI,CAAC,MAAM,CAAC,SAAS,EAAE;QACrB,MAAM,IAAI,UAAU,GAAG,SAAS,iCAAiC,CAAC;IACpE;AACF;AAEA,OAAO,OAAO,GAAG;IACf;IACA;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 129, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/pick.js"],"sourcesContent":["module.exports = function pick(object, ...paths) {\n  const obj = {};\n  for (const path of paths) { // eslint-disable-line no-restricted-syntax\n    if (object[path]) {\n      obj[path] = object[path];\n    }\n  }\n  return obj;\n};\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,SAAS,KAAK,MAAM,EAAE,GAAG,KAAK;IAC7C,MAAM,MAAM,CAAC;IACb,KAAK,MAAM,QAAQ,MAAO;QACxB,IAAI,MAAM,CAAC,KAAK,EAAE;YAChB,GAAG,CAAC,KAAK,GAAG,MAAM,CAAC,KAAK;QAC1B;IACF;IACA,OAAO;AACT","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 143, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/process_response.js"],"sourcesContent":["const { STATUS_CODES } = require('http');\nconst { format } = require('util');\n\nconst { OPError } = require('../errors');\n\nconst REGEXP = /(\\w+)=(\"[^\"]*\")/g;\nconst throwAuthenticateErrors = (response) => {\n  const params = {};\n  try {\n    while ((REGEXP.exec(response.headers['www-authenticate'])) !== null) {\n      if (RegExp.$1 && RegExp.$2) {\n        params[RegExp.$1] = RegExp.$2.slice(1, -1);\n      }\n    }\n  } catch (err) {}\n\n  if (params.error) {\n    throw new OPError(params, response);\n  }\n};\n\nconst isStandardBodyError = (response) => {\n  let result = false;\n  try {\n    let jsonbody;\n    if (typeof response.body !== 'object' || Buffer.isBuffer(response.body)) {\n      jsonbody = JSON.parse(response.body);\n    } else {\n      jsonbody = response.body;\n    }\n    result = typeof jsonbody.error === 'string' && jsonbody.error.length;\n    if (result) response.body = jsonbody;\n  } catch (err) {}\n\n  return result;\n};\n\nfunction processResponse(response, { statusCode = 200, body = true, bearer = false } = {}) {\n  if (response.statusCode !== statusCode) {\n    if (bearer) {\n      throwAuthenticateErrors(response);\n    }\n\n    if (isStandardBodyError(response)) {\n      throw new OPError(response.body, response);\n    }\n\n    throw new OPError({\n      error: format('expected %i %s, got: %i %s', statusCode, STATUS_CODES[statusCode], response.statusCode, STATUS_CODES[response.statusCode]),\n    }, response);\n  }\n\n  if (body && !response.body) {\n    throw new OPError({\n      error: format('expected %i %s with body but no body was returned', statusCode, STATUS_CODES[statusCode]),\n    }, response);\n  }\n\n  return response.body;\n}\n\nmodule.exports = processResponse;\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,YAAY,EAAE;AACtB,MAAM,EAAE,MAAM,EAAE;AAEhB,MAAM,EAAE,OAAO,EAAE;AAEjB,MAAM,SAAS;AACf,MAAM,0BAA0B,CAAC;IAC/B,MAAM,SAAS,CAAC;IAChB,IAAI;QACF,MAAO,AAAC,OAAO,IAAI,CAAC,SAAS,OAAO,CAAC,mBAAmB,MAAO,KAAM;YACnE,IAAI,OAAO,EAAE,IAAI,OAAO,EAAE,EAAE;gBAC1B,MAAM,CAAC,OAAO,EAAE,CAAC,GAAG,OAAO,EAAE,CAAC,KAAK,CAAC,GAAG,CAAC;YAC1C;QACF;IACF,EAAE,OAAO,KAAK,CAAC;IAEf,IAAI,OAAO,KAAK,EAAE;QAChB,MAAM,IAAI,QAAQ,QAAQ;IAC5B;AACF;AAEA,MAAM,sBAAsB,CAAC;IAC3B,IAAI,SAAS;IACb,IAAI;QACF,IAAI;QACJ,IAAI,OAAO,SAAS,IAAI,KAAK,YAAY,OAAO,QAAQ,CAAC,SAAS,IAAI,GAAG;YACvE,WAAW,KAAK,KAAK,CAAC,SAAS,IAAI;QACrC,OAAO;YACL,WAAW,SAAS,IAAI;QAC1B;QACA,SAAS,OAAO,SAAS,KAAK,KAAK,YAAY,SAAS,KAAK,CAAC,MAAM;QACpE,IAAI,QAAQ,SAAS,IAAI,GAAG;IAC9B,EAAE,OAAO,KAAK,CAAC;IAEf,OAAO;AACT;AAEA,SAAS,gBAAgB,QAAQ,EAAE,EAAE,aAAa,GAAG,EAAE,OAAO,IAAI,EAAE,SAAS,KAAK,EAAE,GAAG,CAAC,CAAC;IACvF,IAAI,SAAS,UAAU,KAAK,YAAY;QACtC,IAAI,QAAQ;YACV,wBAAwB;QAC1B;QAEA,IAAI,oBAAoB,WAAW;YACjC,MAAM,IAAI,QAAQ,SAAS,IAAI,EAAE;QACnC;QAEA,MAAM,IAAI,QAAQ;YAChB,OAAO,OAAO,8BAA8B,YAAY,YAAY,CAAC,WAAW,EAAE,SAAS,UAAU,EAAE,YAAY,CAAC,SAAS,UAAU,CAAC;QAC1I,GAAG;IACL;IAEA,IAAI,QAAQ,CAAC,SAAS,IAAI,EAAE;QAC1B,MAAM,IAAI,QAAQ;YAChB,OAAO,OAAO,qDAAqD,YAAY,YAAY,CAAC,WAAW;QACzG,GAAG;IACL;IAEA,OAAO,SAAS,IAAI;AACtB;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 199, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/unix_timestamp.js"],"sourcesContent":["module.exports = () => Math.floor(Date.now() / 1000);\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,IAAM,KAAK,KAAK,CAAC,KAAK,GAAG,KAAK","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 205, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/token_set.js"],"sourcesContent":["const base64url = require('./helpers/base64url');\nconst now = require('./helpers/unix_timestamp');\n\nclass TokenSet {\n  /**\n   * @name constructor\n   * @api public\n   */\n  constructor(values) {\n    Object.assign(this, values);\n  }\n\n  /**\n   * @name expires_in=\n   * @api public\n   */\n  set expires_in(value) { // eslint-disable-line camelcase\n    this.expires_at = now() + Number(value);\n  }\n\n  /**\n   * @name expires_in\n   * @api public\n   */\n  get expires_in() { // eslint-disable-line camelcase\n    return Math.max.apply(null, [this.expires_at - now(), 0]);\n  }\n\n  /**\n   * @name expired\n   * @api public\n   */\n  expired() {\n    return this.expires_in === 0;\n  }\n\n  /**\n   * @name claims\n   * @api public\n   */\n  claims() {\n    if (!this.id_token) {\n      throw new TypeError('id_token not present in TokenSet');\n    }\n\n    return JSON.parse(base64url.decode(this.id_token.split('.')[1]));\n  }\n}\n\nmodule.exports = TokenSet;\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM;AAEN,MAAM;IACJ;;;GAGC,GACD,YAAY,MAAM,CAAE;QAClB,OAAO,MAAM,CAAC,IAAI,EAAE;IACtB;IAEA;;;GAGC,GACD,IAAI,WAAW,KAAK,EAAE;QACpB,IAAI,CAAC,UAAU,GAAG,QAAQ,OAAO;IACnC;IAEA;;;GAGC,GACD,IAAI,aAAa;QACf,OAAO,KAAK,GAAG,CAAC,KAAK,CAAC,MAAM;YAAC,IAAI,CAAC,UAAU,GAAG;YAAO;SAAE;IAC1D;IAEA;;;GAGC,GACD,UAAU;QACR,OAAO,IAAI,CAAC,UAAU,KAAK;IAC7B;IAEA;;;GAGC,GACD,SAAS;QACP,IAAI,CAAC,IAAI,CAAC,QAAQ,EAAE;YAClB,MAAM,IAAI,UAAU;QACtB;QAEA,OAAO,KAAK,KAAK,CAAC,UAAU,MAAM,CAAC,IAAI,CAAC,QAAQ,CAAC,KAAK,CAAC,IAAI,CAAC,EAAE;IAChE;AACF;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 251, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/generators.js"],"sourcesContent":["const { createHash, randomBytes } = require('crypto');\n\nconst base64url = require('./base64url');\n\nconst random = (bytes = 32) => base64url.encode(randomBytes(bytes));\n\nmodule.exports = {\n  random,\n  state: random,\n  nonce: random,\n  codeVerifier: random,\n  codeChallenge: (codeVerifier) => base64url.encode(createHash('sha256').update(codeVerifier).digest()),\n};\n"],"names":[],"mappings":"AAAA,MAAM,EAAE,UAAU,EAAE,WAAW,EAAE;AAEjC,MAAM;AAEN,MAAM,SAAS,CAAC,QAAQ,EAAE,GAAK,UAAU,MAAM,CAAC,YAAY;AAE5D,OAAO,OAAO,GAAG;IACf;IACA,OAAO;IACP,OAAO;IACP,cAAc;IACd,eAAe,CAAC,eAAiB,UAAU,MAAM,CAAC,WAAW,UAAU,MAAM,CAAC,cAAc,MAAM;AACpG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 269, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/is_absolute_url.js"],"sourcesContent":["const url = require('url');\nconst { strict: assert } = require('assert');\n\nmodule.exports = (target) => {\n  try {\n    const { protocol } = new url.URL(target);\n    assert(protocol.match(/^(https?:)$/));\n    return true;\n  } catch (err) {\n    throw new TypeError('only valid absolute URLs can be requested');\n  }\n};\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM,EAAE,QAAQ,MAAM,EAAE;AAExB,OAAO,OAAO,GAAG,CAAC;IAChB,IAAI;QACF,MAAM,EAAE,QAAQ,EAAE,GAAG,IAAI,IAAI,GAAG,CAAC;QACjC,OAAO,SAAS,KAAK,CAAC;QACtB,OAAO;IACT,EAAE,OAAO,KAAK;QACZ,MAAM,IAAI,UAAU;IACtB;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 285, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/consts.js"],"sourcesContent":["const OIDC_DISCOVERY = '/.well-known/openid-configuration';\nconst OAUTH2_DISCOVERY = '/.well-known/oauth-authorization-server';\nconst WEBFINGER = '/.well-known/webfinger';\nconst REL = 'http://openid.net/specs/connect/1.0/issuer';\nconst AAD_MULTITENANT_DISCOVERY = [\n  `https://login.microsoftonline.com/common${OIDC_DISCOVERY}`,\n  `https://login.microsoftonline.com/common/v2.0${OIDC_DISCOVERY}`,\n  `https://login.microsoftonline.com/organizations/v2.0${OIDC_DISCOVERY}`,\n  `https://login.microsoftonline.com/consumers/v2.0${OIDC_DISCOVERY}`,\n];\n\nconst CLIENT_DEFAULTS = {\n  grant_types: ['authorization_code'],\n  id_token_signed_response_alg: 'RS256',\n  authorization_signed_response_alg: 'RS256',\n  response_types: ['code'],\n  token_endpoint_auth_method: 'client_secret_basic',\n};\n\nconst ISSUER_DEFAULTS = {\n  claim_types_supported: ['normal'],\n  claims_parameter_supported: false,\n  grant_types_supported: ['authorization_code', 'implicit'],\n  request_parameter_supported: false,\n  request_uri_parameter_supported: true,\n  require_request_uri_registration: false,\n  response_modes_supported: ['query', 'fragment'],\n  token_endpoint_auth_methods_supported: ['client_secret_basic'],\n};\n\nconst CALLBACK_PROPERTIES = [\n  'access_token', // 6749\n  'code', // 6749\n  'error', // 6749\n  'error_description', // 6749\n  'error_uri', // 6749\n  'expires_in', // 6749\n  'id_token', // Core 1.0\n  'state', // 6749\n  'token_type', // 6749\n  'session_state', // Session Management\n  'response', // JARM\n];\n\nconst JWT_CONTENT = /^application\\/jwt/;\n\nconst HTTP_OPTIONS = Symbol('openid-client.custom.http-options');\nconst CLOCK_TOLERANCE = Symbol('openid-client.custom.clock-tolerance');\n\nmodule.exports = {\n  AAD_MULTITENANT_DISCOVERY,\n  CALLBACK_PROPERTIES,\n  CLIENT_DEFAULTS,\n  CLOCK_TOLERANCE,\n  HTTP_OPTIONS,\n  ISSUER_DEFAULTS,\n  JWT_CONTENT,\n  OAUTH2_DISCOVERY,\n  OIDC_DISCOVERY,\n  REL,\n  WEBFINGER,\n};\n"],"names":[],"mappings":"AAAA,MAAM,iBAAiB;AACvB,MAAM,mBAAmB;AACzB,MAAM,YAAY;AAClB,MAAM,MAAM;AACZ,MAAM,4BAA4B;IAChC,CAAC,wCAAwC,EAAE,gBAAgB;IAC3D,CAAC,6CAA6C,EAAE,gBAAgB;IAChE,CAAC,oDAAoD,EAAE,gBAAgB;IACvE,CAAC,gDAAgD,EAAE,gBAAgB;CACpE;AAED,MAAM,kBAAkB;IACtB,aAAa;QAAC;KAAqB;IACnC,8BAA8B;IAC9B,mCAAmC;IACnC,gBAAgB;QAAC;KAAO;IACxB,4BAA4B;AAC9B;AAEA,MAAM,kBAAkB;IACtB,uBAAuB;QAAC;KAAS;IACjC,4BAA4B;IAC5B,uBAAuB;QAAC;QAAsB;KAAW;IACzD,6BAA6B;IAC7B,iCAAiC;IACjC,kCAAkC;IAClC,0BAA0B;QAAC;QAAS;KAAW;IAC/C,uCAAuC;QAAC;KAAsB;AAChE;AAEA,MAAM,sBAAsB;IAC1B;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;CACD;AAED,MAAM,cAAc;AAEpB,MAAM,eAAe,OAAO;AAC5B,MAAM,kBAAkB,OAAO;AAE/B,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;IACA;AACF","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 360, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/request.js"],"sourcesContent":["const Got = require('got');\n\nconst pkg = require('../../package.json');\n\nconst { deep: defaultsDeep } = require('./defaults');\nconst isAbsoluteUrl = require('./is_absolute_url');\nconst { HTTP_OPTIONS } = require('./consts');\n\nlet DEFAULT_HTTP_OPTIONS;\nlet got;\n\nconst setDefaults = (options) => {\n  DEFAULT_HTTP_OPTIONS = defaultsDeep({}, options, DEFAULT_HTTP_OPTIONS);\n  got = Got.extend(DEFAULT_HTTP_OPTIONS);\n};\n\nsetDefaults({\n  followRedirect: false,\n  headers: { 'User-Agent': `${pkg.name}/${pkg.version} (${pkg.homepage})` },\n  retry: 0,\n  timeout: 3500,\n  throwHttpErrors: false,\n});\n\nmodule.exports = async function request(options, { accessToken, mTLS = false, DPoP } = {}) {\n  const { url } = options;\n  isAbsoluteUrl(url);\n  const optsFn = this[HTTP_OPTIONS];\n  let opts = options;\n\n  if (DPoP && 'dpopProof' in this) {\n    opts.headers = opts.headers || {};\n    opts.headers.DPoP = this.dpopProof({\n      htu: url,\n      htm: options.method,\n    }, DPoP, accessToken);\n  }\n\n  if (optsFn) {\n    opts = optsFn.call(this, defaultsDeep({}, opts, DEFAULT_HTTP_OPTIONS));\n  }\n\n  if (\n    mTLS\n    && (\n      (!opts.key || !opts.cert)\n      && (!opts.https || !((opts.https.key && opts.https.certificate) || opts.https.pfx))\n    )\n  ) {\n    throw new TypeError('mutual-TLS certificate and key not set');\n  }\n\n  return got(opts);\n};\n\nmodule.exports.setDefaults = setDefaults;\n"],"names":[],"mappings":"AAAA,MAAM;AAEN,MAAM;AAEN,MAAM,EAAE,MAAM,YAAY,EAAE;AAC5B,MAAM;AACN,MAAM,EAAE,YAAY,EAAE;AAEtB,IAAI;AACJ,IAAI;AAEJ,MAAM,cAAc,CAAC;IACnB,uBAAuB,aAAa,CAAC,GAAG,SAAS;IACjD,MAAM,IAAI,MAAM,CAAC;AACnB;AAEA,YAAY;IACV,gBAAgB;IAChB,SAAS;QAAE,cAAc,GAAG,IAAI,IAAI,CAAC,CAAC,EAAE,IAAI,OAAO,CAAC,EAAE,EAAE,IAAI,QAAQ,CAAC,CAAC,CAAC;IAAC;IACxE,OAAO;IACP,SAAS;IACT,iBAAiB;AACnB;AAEA,OAAO,OAAO,GAAG,eAAe,QAAQ,OAAO,EAAE,EAAE,WAAW,EAAE,OAAO,KAAK,EAAE,IAAI,EAAE,GAAG,CAAC,CAAC;IACvF,MAAM,EAAE,GAAG,EAAE,GAAG;IAChB,cAAc;IACd,MAAM,SAAS,IAAI,CAAC,aAAa;IACjC,IAAI,OAAO;IAEX,IAAI,QAAQ,eAAe,IAAI,EAAE;QAC/B,KAAK,OAAO,GAAG,KAAK,OAAO,IAAI,CAAC;QAChC,KAAK,OAAO,CAAC,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC;YACjC,KAAK;YACL,KAAK,QAAQ,MAAM;QACrB,GAAG,MAAM;IACX;IAEA,IAAI,QAAQ;QACV,OAAO,OAAO,IAAI,CAAC,IAAI,EAAE,aAAa,CAAC,GAAG,MAAM;IAClD;IAEA,IACE,QAEE,CAAC,CAAC,KAAK,GAAG,IAAI,CAAC,KAAK,IAAI,KACrB,CAAC,CAAC,KAAK,KAAK,IAAI,CAAC,CAAC,AAAC,KAAK,KAAK,CAAC,GAAG,IAAI,KAAK,KAAK,CAAC,WAAW,IAAK,KAAK,KAAK,CAAC,GAAG,CAAC,GAEpF;QACA,MAAM,IAAI,UAAU;IACtB;IAEA,OAAO,IAAI;AACb;AAEA,OAAO,OAAO,CAAC,WAAW,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 406, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/issuer_registry.js"],"sourcesContent":["const REGISTRY = new Map();\n\nmodule.exports = REGISTRY;\n"],"names":[],"mappings":"AAAA,MAAM,WAAW,IAAI;AAErB,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 413, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/weak_cache.js"],"sourcesContent":["const privateProps = new WeakMap();\n\nmodule.exports = (ctx) => {\n  if (!privateProps.has(ctx)) {\n    privateProps.set(ctx, new Map([['metadata', new Map()]]));\n  }\n  return privateProps.get(ctx);\n};\n"],"names":[],"mappings":"AAAA,MAAM,eAAe,IAAI;AAEzB,OAAO,OAAO,GAAG,CAAC;IAChB,IAAI,CAAC,aAAa,GAAG,CAAC,MAAM;QAC1B,aAAa,GAAG,CAAC,KAAK,IAAI,IAAI;YAAC;gBAAC;gBAAY,IAAI;aAAM;SAAC;IACzD;IACA,OAAO,aAAa,GAAG,CAAC;AAC1B","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 430, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/merge.js"],"sourcesContent":["/* eslint-disable no-restricted-syntax, no-param-reassign, no-continue */\n\nconst isPlainObject = require('./is_plain_object');\n\nfunction merge(target, ...sources) {\n  for (const source of sources) {\n    if (!isPlainObject(source)) {\n      continue;\n    }\n    for (const [key, value] of Object.entries(source)) {\n      /* istanbul ignore if */\n      if (key === '__proto__' || key === 'constructor') {\n        continue;\n      }\n      if (isPlainObject(target[key]) && isPlainObject(value)) {\n        target[key] = merge(target[key], value);\n      } else if (typeof value !== 'undefined') {\n        target[key] = value;\n      }\n    }\n  }\n\n  return target;\n}\n\nmodule.exports = merge;\n"],"names":[],"mappings":"AAAA,uEAAuE,GAEvE,MAAM;AAEN,SAAS,MAAM,MAAM,EAAE,GAAG,OAAO;IAC/B,KAAK,MAAM,UAAU,QAAS;QAC5B,IAAI,CAAC,cAAc,SAAS;YAC1B;QACF;QACA,KAAK,MAAM,CAAC,KAAK,MAAM,IAAI,OAAO,OAAO,CAAC,QAAS;YACjD,sBAAsB,GACtB,IAAI,QAAQ,eAAe,QAAQ,eAAe;gBAChD;YACF;YACA,IAAI,cAAc,MAAM,CAAC,IAAI,KAAK,cAAc,QAAQ;gBACtD,MAAM,CAAC,IAAI,GAAG,MAAM,MAAM,CAAC,IAAI,EAAE;YACnC,OAAO,IAAI,OAAO,UAAU,aAAa;gBACvC,MAAM,CAAC,IAAI,GAAG;YAChB;QACF;IACF;IAEA,OAAO;AACT;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 455, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/client.js"],"sourcesContent":["const jose = require('jose');\n\nconst { assertIssuerConfiguration } = require('./assert');\nconst { random } = require('./generators');\nconst now = require('./unix_timestamp');\nconst request = require('./request');\nconst instance = require('./weak_cache');\nconst merge = require('./merge');\n\nconst formUrlEncode = (value) => encodeURIComponent(value).replace(/%20/g, '+');\n\nasync function clientAssertion(endpoint, payload) {\n  let alg = this[`${endpoint}_endpoint_auth_signing_alg`];\n  if (!alg) {\n    assertIssuerConfiguration(this.issuer, `${endpoint}_endpoint_auth_signing_alg_values_supported`);\n  }\n\n  if (this[`${endpoint}_endpoint_auth_method`] === 'client_secret_jwt') {\n    const key = await this.joseSecret();\n\n    if (!alg) {\n      const supported = this.issuer[`${endpoint}_endpoint_auth_signing_alg_values_supported`];\n      alg = Array.isArray(supported) && supported.find((signAlg) => key.algorithms('sign').has(signAlg));\n    }\n\n    return jose.JWS.sign(payload, key, { alg, typ: 'JWT' });\n  }\n\n  const keystore = instance(this).get('keystore');\n\n  if (!keystore) {\n    throw new TypeError('no client jwks provided for signing a client assertion with');\n  }\n\n  if (!alg) {\n    const algs = new Set();\n\n    keystore.all().forEach((key) => {\n      key.algorithms('sign').forEach(Set.prototype.add.bind(algs));\n    });\n\n    const supported = this.issuer[`${endpoint}_endpoint_auth_signing_alg_values_supported`];\n    alg = Array.isArray(supported) && supported.find((signAlg) => algs.has(signAlg));\n  }\n\n  const key = keystore.get({ alg, use: 'sig' });\n  if (!key) {\n    throw new TypeError(`no key found in client jwks to sign a client assertion with using alg ${alg}`);\n  }\n  return jose.JWS.sign(payload, key, { alg, typ: 'JWT', kid: key.kid.startsWith('DONOTUSE.') ? undefined : key.kid });\n}\n\nasync function authFor(endpoint, { clientAssertionPayload } = {}) {\n  const authMethod = this[`${endpoint}_endpoint_auth_method`];\n  switch (authMethod) {\n    case 'self_signed_tls_client_auth':\n    case 'tls_client_auth':\n    case 'none':\n      return { form: { client_id: this.client_id } };\n    case 'client_secret_post':\n      if (!this.client_secret) {\n        throw new TypeError('client_secret_post client authentication method requires a client_secret');\n      }\n      return { form: { client_id: this.client_id, client_secret: this.client_secret } };\n    case 'private_key_jwt':\n    case 'client_secret_jwt': {\n      const timestamp = now();\n\n      const mTLS = endpoint === 'token' && this.tls_client_certificate_bound_access_tokens;\n      const audience = [...new Set([\n        this.issuer.issuer,\n        this.issuer.token_endpoint,\n        this.issuer[`${endpoint}_endpoint`],\n        mTLS && this.issuer.mtls_endpoint_aliases\n          ? this.issuer.mtls_endpoint_aliases.token_endpoint : undefined,\n      ].filter(Boolean))];\n\n      const assertion = await clientAssertion.call(this, endpoint, {\n        iat: timestamp,\n        exp: timestamp + 60,\n        jti: random(),\n        iss: this.client_id,\n        sub: this.client_id,\n        aud: audience,\n        ...clientAssertionPayload,\n      });\n\n      return {\n        form: {\n          client_id: this.client_id,\n          client_assertion: assertion,\n          client_assertion_type: 'urn:ietf:params:oauth:client-assertion-type:jwt-bearer',\n        },\n      };\n    }\n    default: { // client_secret_basic\n      // This is correct behaviour, see https://tools.ietf.org/html/rfc6749#section-2.3.1 and the\n      // related appendix. (also https://github.com/panva/node-openid-client/pull/91)\n      // > The client identifier is encoded using the\n      // > \"application/x-www-form-urlencoded\" encoding algorithm per\n      // > Appendix B, and the encoded value is used as the username; the client\n      // > password is encoded using the same algorithm and used as the\n      // > password.\n      if (!this.client_secret) {\n        throw new TypeError('client_secret_basic client authentication method requires a client_secret');\n      }\n      const encoded = `${formUrlEncode(this.client_id)}:${formUrlEncode(this.client_secret)}`;\n      const value = Buffer.from(encoded).toString('base64');\n      return { headers: { Authorization: `Basic ${value}` } };\n    }\n  }\n}\n\nfunction resolveResponseType() {\n  const { length, 0: value } = this.response_types;\n\n  if (length === 1) {\n    return value;\n  }\n\n  return undefined;\n}\n\nfunction resolveRedirectUri() {\n  const { length, 0: value } = this.redirect_uris || [];\n\n  if (length === 1) {\n    return value;\n  }\n\n  return undefined;\n}\n\nasync function authenticatedPost(endpoint, opts, {\n  clientAssertionPayload, endpointAuthMethod = endpoint, DPoP,\n} = {}) {\n  const auth = await authFor.call(this, endpointAuthMethod, { clientAssertionPayload });\n  const requestOpts = merge(opts, auth);\n\n  const mTLS = this[`${endpointAuthMethod}_endpoint_auth_method`].includes('tls_client_auth')\n    || (endpoint === 'token' && this.tls_client_certificate_bound_access_tokens);\n\n  let targetUrl;\n  if (mTLS && this.issuer.mtls_endpoint_aliases) {\n    targetUrl = this.issuer.mtls_endpoint_aliases[`${endpoint}_endpoint`];\n  }\n\n  targetUrl = targetUrl || this.issuer[`${endpoint}_endpoint`];\n\n  if ('form' in requestOpts) {\n    for (const [key, value] of Object.entries(requestOpts.form)) { // eslint-disable-line no-restricted-syntax, max-len\n      if (typeof value === 'undefined') {\n        delete requestOpts.form[key];\n      }\n    }\n  }\n\n  return request.call(this, {\n    ...requestOpts,\n    method: 'POST',\n    url: targetUrl,\n  }, { mTLS, DPoP });\n}\n\nmodule.exports = {\n  resolveResponseType,\n  resolveRedirectUri,\n  authFor,\n  authenticatedPost,\n};\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 629, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/device_flow_handle.js"],"sourcesContent":["/* eslint-disable camelcase */\nconst { inspect } = require('util');\n\nconst { RPError, OPError } = require('./errors');\nconst instance = require('./helpers/weak_cache');\nconst now = require('./helpers/unix_timestamp');\nconst { authenticatedPost } = require('./helpers/client');\nconst processResponse = require('./helpers/process_response');\nconst TokenSet = require('./token_set');\n\nclass DeviceFlowHandle {\n  constructor({\n    client, exchangeBody, clientAssertionPayload, response, maxAge, DPoP,\n  }) {\n    ['verification_uri', 'user_code', 'device_code'].forEach((prop) => {\n      if (typeof response[prop] !== 'string' || !response[prop]) {\n        throw new RPError(`expected ${prop} string to be returned by Device Authorization Response, got %j`, response[prop]);\n      }\n    });\n\n    if (!Number.isSafeInteger(response.expires_in)) {\n      throw new RPError('expected expires_in number to be returned by Device Authorization Response, got %j', response.expires_in);\n    }\n\n    instance(this).expires_at = now() + response.expires_in;\n    instance(this).client = client;\n    instance(this).DPoP = DPoP;\n    instance(this).maxAge = maxAge;\n    instance(this).exchangeBody = exchangeBody;\n    instance(this).clientAssertionPayload = clientAssertionPayload;\n    instance(this).response = response;\n    instance(this).interval = response.interval * 1000 || 5000;\n  }\n\n  abort() {\n    instance(this).aborted = true;\n  }\n\n  async poll({ signal } = {}) {\n    if ((signal && signal.aborted) || instance(this).aborted) {\n      throw new RPError('polling aborted');\n    }\n\n    if (this.expired()) {\n      throw new RPError('the device code %j has expired and the device authorization session has concluded', this.device_code);\n    }\n\n    await new Promise((resolve) => setTimeout(resolve, instance(this).interval));\n\n    const response = await authenticatedPost.call(\n      instance(this).client,\n      'token',\n      {\n        form: {\n          ...instance(this).exchangeBody,\n          grant_type: 'urn:ietf:params:oauth:grant-type:device_code',\n          device_code: this.device_code,\n        },\n        responseType: 'json',\n      },\n      { clientAssertionPayload: instance(this).clientAssertionPayload, DPoP: instance(this).DPoP },\n    );\n\n    let responseBody;\n    try {\n      responseBody = processResponse(response);\n    } catch (err) {\n      switch (err instanceof OPError && err.error) {\n        case 'slow_down':\n          instance(this).interval += 5000;\n        case 'authorization_pending': // eslint-disable-line no-fallthrough\n          return this.poll({ signal });\n        default:\n          throw err;\n      }\n    }\n\n    const tokenset = new TokenSet(responseBody);\n\n    if ('id_token' in tokenset) {\n      await instance(this).client.decryptIdToken(tokenset);\n      await instance(this).client.validateIdToken(tokenset, undefined, 'token', instance(this).maxAge);\n    }\n\n    return tokenset;\n  }\n\n  get device_code() {\n    return instance(this).response.device_code;\n  }\n\n  get user_code() {\n    return instance(this).response.user_code;\n  }\n\n  get verification_uri() {\n    return instance(this).response.verification_uri;\n  }\n\n  get verification_uri_complete() {\n    return instance(this).response.verification_uri_complete;\n  }\n\n  get expires_in() {\n    return Math.max.apply(null, [instance(this).expires_at - now(), 0]);\n  }\n\n  expired() {\n    return this.expires_in === 0;\n  }\n\n  /* istanbul ignore next */\n  [inspect.custom]() {\n    return `${this.constructor.name} ${inspect(instance(this).response, {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true,\n    })}`;\n  }\n}\n\nmodule.exports = DeviceFlowHandle;\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 739, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/client.js"],"sourcesContent":["/* eslint-disable max-classes-per-file */\n\nconst { inspect } = require('util');\nconst stdhttp = require('http');\nconst crypto = require('crypto');\nconst { strict: assert } = require('assert');\nconst querystring = require('querystring');\nconst url = require('url');\n\nconst { ParseError } = require('got');\nconst jose = require('jose');\nconst tokenHash = require('oidc-token-hash');\n\nconst base64url = require('./helpers/base64url');\nconst defaults = require('./helpers/defaults');\nconst { assertSigningAlgValuesSupport, assertIssuerConfiguration } = require('./helpers/assert');\nconst pick = require('./helpers/pick');\nconst isPlainObject = require('./helpers/is_plain_object');\nconst processResponse = require('./helpers/process_response');\nconst TokenSet = require('./token_set');\nconst { OPError, RPError } = require('./errors');\nconst now = require('./helpers/unix_timestamp');\nconst { random } = require('./helpers/generators');\nconst request = require('./helpers/request');\nconst {\n  CALLBACK_PROPERTIES, CLIENT_DEFAULTS, JWT_CONTENT, CLOCK_TOLERANCE,\n} = require('./helpers/consts');\nconst issuerRegistry = require('./issuer_registry');\nconst instance = require('./helpers/weak_cache');\nconst { authenticatedPost, resolveResponseType, resolveRedirectUri } = require('./helpers/client');\nconst DeviceFlowHandle = require('./device_flow_handle');\n\nfunction pickCb(input) {\n  return pick(input, ...CALLBACK_PROPERTIES);\n}\n\nfunction authorizationHeaderValue(token, tokenType = 'Bearer') {\n  return `${tokenType} ${token}`;\n}\n\nfunction cleanUpClaims(claims) {\n  if (Object.keys(claims._claim_names).length === 0) {\n    delete claims._claim_names;\n  }\n  if (Object.keys(claims._claim_sources).length === 0) {\n    delete claims._claim_sources;\n  }\n}\n\nfunction assignClaim(target, source, sourceName, throwOnMissing = true) {\n  return ([claim, inSource]) => {\n    if (inSource === sourceName) {\n      if (throwOnMissing && source[claim] === undefined) {\n        throw new RPError(`expected claim \"${claim}\" in \"${sourceName}\"`);\n      } else if (source[claim] !== undefined) {\n        target[claim] = source[claim];\n      }\n      delete target._claim_names[claim];\n    }\n  };\n}\n\nfunction verifyPresence(payload, jwt, prop) {\n  if (payload[prop] === undefined) {\n    throw new RPError({\n      message: `missing required JWT property ${prop}`,\n      jwt,\n    });\n  }\n}\n\nfunction authorizationParams(params) {\n  const authParams = {\n    client_id: this.client_id,\n    scope: 'openid',\n    response_type: resolveResponseType.call(this),\n    redirect_uri: resolveRedirectUri.call(this),\n    ...params,\n  };\n\n  Object.entries(authParams).forEach(([key, value]) => {\n    if (value === null || value === undefined) {\n      delete authParams[key];\n    } else if (key === 'claims' && typeof value === 'object') {\n      authParams[key] = JSON.stringify(value);\n    } else if (key === 'resource' && Array.isArray(value)) {\n      authParams[key] = value;\n    } else if (typeof value !== 'string') {\n      authParams[key] = String(value);\n    }\n  });\n\n  return authParams;\n}\n\nasync function claimJWT(label, jwt) {\n  try {\n    const { header, payload } = jose.JWT.decode(jwt, { complete: true });\n    const { iss } = payload;\n\n    if (header.alg === 'none') {\n      return payload;\n    }\n\n    let key;\n    if (!iss || iss === this.issuer.issuer) {\n      key = await this.issuer.queryKeyStore(header);\n    } else if (issuerRegistry.has(iss)) {\n      key = await issuerRegistry.get(iss).queryKeyStore(header);\n    } else {\n      const discovered = await this.issuer.constructor.discover(iss);\n      key = await discovered.queryKeyStore(header);\n    }\n    return jose.JWT.verify(jwt, key);\n  } catch (err) {\n    if (err instanceof RPError || err instanceof OPError || err.name === 'AggregateError') {\n      throw err;\n    } else {\n      throw new RPError({\n        printf: ['failed to validate the %s JWT (%s: %s)', label, err.name, err.message],\n        jwt,\n      });\n    }\n  }\n}\n\nfunction getKeystore(jwks) {\n  if (!isPlainObject(jwks) || !Array.isArray(jwks.keys) || jwks.keys.some((k) => !isPlainObject(k) || !('kty' in k))) {\n    throw new TypeError('jwks must be a JSON Web Key Set formatted object');\n  }\n\n  // eslint-disable-next-line no-restricted-syntax\n  for (const jwk of jwks.keys) {\n    if (jwk.kid === undefined) {\n      jwk.kid = `DONOTUSE.${random()}`;\n    }\n  }\n\n  const keystore = jose.JWKS.asKeyStore(jwks);\n  if (keystore.all().some((key) => key.type !== 'private')) {\n    throw new TypeError('jwks must only contain private keys');\n  }\n  return keystore;\n}\n\n// if an OP doesnt support client_secret_basic but supports client_secret_post, use it instead\n// this is in place to take care of most common pitfalls when first using discovered Issuers without\n// the support for default values defined by Discovery 1.0\nfunction checkBasicSupport(client, metadata, properties) {\n  try {\n    const supported = client.issuer.token_endpoint_auth_methods_supported;\n    if (!supported.includes(properties.token_endpoint_auth_method)) {\n      if (supported.includes('client_secret_post')) {\n        properties.token_endpoint_auth_method = 'client_secret_post';\n      }\n    }\n  } catch (err) {}\n}\n\nfunction handleCommonMistakes(client, metadata, properties) {\n  if (!metadata.token_endpoint_auth_method) { // if no explicit value was provided\n    checkBasicSupport(client, metadata, properties);\n  }\n\n  // :fp: c'mon people... RTFM\n  if (metadata.redirect_uri) {\n    if (metadata.redirect_uris) {\n      throw new TypeError('provide a redirect_uri or redirect_uris, not both');\n    }\n    properties.redirect_uris = [metadata.redirect_uri];\n    delete properties.redirect_uri;\n  }\n\n  if (metadata.response_type) {\n    if (metadata.response_types) {\n      throw new TypeError('provide a response_type or response_types, not both');\n    }\n    properties.response_types = [metadata.response_type];\n    delete properties.response_type;\n  }\n}\n\nfunction getDefaultsForEndpoint(endpoint, issuer, properties) {\n  if (!issuer[`${endpoint}_endpoint`]) return;\n\n  const tokenEndpointAuthMethod = properties.token_endpoint_auth_method;\n  const tokenEndpointAuthSigningAlg = properties.token_endpoint_auth_signing_alg;\n\n  const eam = `${endpoint}_endpoint_auth_method`;\n  const easa = `${endpoint}_endpoint_auth_signing_alg`;\n\n  if (properties[eam] === undefined && properties[easa] === undefined) {\n    if (tokenEndpointAuthMethod !== undefined) {\n      properties[eam] = tokenEndpointAuthMethod;\n    }\n    if (tokenEndpointAuthSigningAlg !== undefined) {\n      properties[easa] = tokenEndpointAuthSigningAlg;\n    }\n  }\n}\n\nclass BaseClient {}\n\nmodule.exports = (issuer, aadIssValidation = false) => class Client extends BaseClient {\n  /**\n   * @name constructor\n   * @api public\n   */\n  constructor(metadata = {}, jwks, options) {\n    super();\n\n    if (typeof metadata.client_id !== 'string' || !metadata.client_id) {\n      throw new TypeError('client_id is required');\n    }\n\n    const properties = { ...CLIENT_DEFAULTS, ...metadata };\n\n    handleCommonMistakes(this, metadata, properties);\n\n    assertSigningAlgValuesSupport('token', this.issuer, properties);\n\n    ['introspection', 'revocation'].forEach((endpoint) => {\n      getDefaultsForEndpoint(endpoint, this.issuer, properties);\n      assertSigningAlgValuesSupport(endpoint, this.issuer, properties);\n    });\n\n    Object.entries(properties).forEach(([key, value]) => {\n      instance(this).get('metadata').set(key, value);\n      if (!this[key]) {\n        Object.defineProperty(this, key, {\n          get() { return instance(this).get('metadata').get(key); },\n          enumerable: true,\n        });\n      }\n    });\n\n    if (jwks !== undefined) {\n      const keystore = getKeystore.call(this, jwks);\n      instance(this).set('keystore', keystore);\n    }\n\n    if (options !== undefined) {\n      instance(this).set('options', options);\n    }\n\n    this[CLOCK_TOLERANCE] = 0;\n  }\n\n  /**\n   * @name authorizationUrl\n   * @api public\n   */\n  authorizationUrl(params = {}) {\n    if (!isPlainObject(params)) {\n      throw new TypeError('params must be a plain object');\n    }\n    assertIssuerConfiguration(this.issuer, 'authorization_endpoint');\n    const target = url.parse(this.issuer.authorization_endpoint, true);\n    target.search = null;\n    target.query = {\n      ...target.query,\n      ...authorizationParams.call(this, params),\n    };\n    return url.format(target);\n  }\n\n  /**\n   * @name authorizationPost\n   * @api public\n   */\n  authorizationPost(params = {}) {\n    if (!isPlainObject(params)) {\n      throw new TypeError('params must be a plain object');\n    }\n    const inputs = authorizationParams.call(this, params);\n    const formInputs = Object.keys(inputs)\n      .map((name) => `<input type=\"hidden\" name=\"${name}\" value=\"${inputs[name]}\"/>`).join('\\n');\n\n    return `<!DOCTYPE html>\n<head>\n  <title>Requesting Authorization</title>\n</head>\n<body onload=\"javascript:document.forms[0].submit()\">\n  <form method=\"post\" action=\"${this.issuer.authorization_endpoint}\">\n    ${formInputs}\n  </form>\n</body>\n</html>`;\n  }\n\n  /**\n   * @name endSessionUrl\n   * @api public\n   */\n  endSessionUrl(params = {}) {\n    assertIssuerConfiguration(this.issuer, 'end_session_endpoint');\n\n    const {\n      0: postLogout,\n      length,\n    } = this.post_logout_redirect_uris || [];\n\n    const {\n      post_logout_redirect_uri = length === 1 ? postLogout : undefined,\n    } = params;\n\n    let hint = params.id_token_hint;\n\n    if (hint instanceof TokenSet) {\n      if (!hint.id_token) {\n        throw new TypeError('id_token not present in TokenSet');\n      }\n      hint = hint.id_token;\n    }\n\n    const target = url.parse(this.issuer.end_session_endpoint, true);\n    target.search = null;\n    target.query = {\n      ...params,\n      ...target.query,\n      ...{\n        post_logout_redirect_uri,\n        id_token_hint: hint,\n      },\n    };\n\n    Object.entries(target.query).forEach(([key, value]) => {\n      if (value === null || value === undefined) {\n        delete target.query[key];\n      }\n    });\n\n    return url.format(target);\n  }\n\n  /**\n   * @name callbackParams\n   * @api public\n   */\n  callbackParams(input) { // eslint-disable-line class-methods-use-this\n    const isIncomingMessage = input instanceof stdhttp.IncomingMessage\n      || (input && input.method && input.url);\n    const isString = typeof input === 'string';\n\n    if (!isString && !isIncomingMessage) {\n      throw new TypeError('#callbackParams only accepts string urls, http.IncomingMessage or a lookalike');\n    }\n\n    if (isIncomingMessage) {\n      switch (input.method) {\n        case 'GET':\n          return pickCb(url.parse(input.url, true).query);\n        case 'POST':\n          if (input.body === undefined) {\n            throw new TypeError('incoming message body missing, include a body parser prior to this method call');\n          }\n          switch (typeof input.body) {\n            case 'object':\n            case 'string':\n              if (Buffer.isBuffer(input.body)) {\n                return pickCb(querystring.parse(input.body.toString('utf-8')));\n              }\n              if (typeof input.body === 'string') {\n                return pickCb(querystring.parse(input.body));\n              }\n\n              return pickCb(input.body);\n            default:\n              throw new TypeError('invalid IncomingMessage body object');\n          }\n        default:\n          throw new TypeError('invalid IncomingMessage method');\n      }\n    } else {\n      return pickCb(url.parse(input, true).query);\n    }\n  }\n\n  /**\n   * @name callback\n   * @api public\n   */\n  async callback(\n    redirectUri,\n    parameters,\n    checks = {},\n    { exchangeBody, clientAssertionPayload, DPoP } = {},\n  ) {\n    let params = pickCb(parameters);\n\n    if (checks.jarm && !('response' in parameters)) {\n      throw new RPError({\n        message: 'expected a JARM response',\n        checks,\n        params,\n      });\n    } else if ('response' in parameters) {\n      const decrypted = await this.decryptJARM(params.response);\n      params = await this.validateJARM(decrypted);\n    }\n\n    if (this.default_max_age && !checks.max_age) {\n      checks.max_age = this.default_max_age;\n    }\n\n    if (params.state && !checks.state) {\n      throw new TypeError('checks.state argument is missing');\n    }\n\n    if (!params.state && checks.state) {\n      throw new RPError({\n        message: 'state missing from the response',\n        checks,\n        params,\n      });\n    }\n\n    if (checks.state !== params.state) {\n      throw new RPError({\n        printf: ['state mismatch, expected %s, got: %s', checks.state, params.state],\n        checks,\n        params,\n      });\n    }\n\n    if (params.error) {\n      throw new OPError(params);\n    }\n\n    const RESPONSE_TYPE_REQUIRED_PARAMS = {\n      code: ['code'],\n      id_token: ['id_token'],\n      token: ['access_token', 'token_type'],\n    };\n\n    if (checks.response_type) {\n      for (const type of checks.response_type.split(' ')) { // eslint-disable-line no-restricted-syntax\n        if (type === 'none') {\n          if (params.code || params.id_token || params.access_token) {\n            throw new RPError({\n              message: 'unexpected params encountered for \"none\" response',\n              checks,\n              params,\n            });\n          }\n        } else {\n          for (const param of RESPONSE_TYPE_REQUIRED_PARAMS[type]) { // eslint-disable-line no-restricted-syntax, max-len\n            if (!params[param]) {\n              throw new RPError({\n                message: `${param} missing from response`,\n                checks,\n                params,\n              });\n            }\n          }\n        }\n      }\n    }\n\n    if (params.id_token) {\n      const tokenset = new TokenSet(params);\n      await this.decryptIdToken(tokenset);\n      await this.validateIdToken(tokenset, checks.nonce, 'authorization', checks.max_age, checks.state);\n\n      if (!params.code) {\n        return tokenset;\n      }\n    }\n\n    if (params.code) {\n      const tokenset = await this.grant({\n        ...exchangeBody,\n        grant_type: 'authorization_code',\n        code: params.code,\n        redirect_uri: redirectUri,\n        code_verifier: checks.code_verifier,\n      }, { clientAssertionPayload, DPoP });\n\n      await this.decryptIdToken(tokenset);\n      await this.validateIdToken(tokenset, checks.nonce, 'token', checks.max_age);\n\n      if (params.session_state) {\n        tokenset.session_state = params.session_state;\n      }\n\n      return tokenset;\n    }\n\n    return new TokenSet(params);\n  }\n\n  /**\n   * @name oauthCallback\n   * @api public\n   */\n  async oauthCallback(\n    redirectUri,\n    parameters,\n    checks = {},\n    { exchangeBody, clientAssertionPayload, DPoP } = {},\n  ) {\n    let params = pickCb(parameters);\n\n    if (checks.jarm && !('response' in parameters)) {\n      throw new RPError({\n        message: 'expected a JARM response',\n        checks,\n        params,\n      });\n    } else if ('response' in parameters) {\n      const decrypted = await this.decryptJARM(params.response);\n      params = await this.validateJARM(decrypted);\n    }\n\n    if (params.state && !checks.state) {\n      throw new TypeError('checks.state argument is missing');\n    }\n\n    if (!params.state && checks.state) {\n      throw new RPError({\n        message: 'state missing from the response',\n        checks,\n        params,\n      });\n    }\n\n    if (checks.state !== params.state) {\n      throw new RPError({\n        printf: ['state mismatch, expected %s, got: %s', checks.state, params.state],\n        checks,\n        params,\n      });\n    }\n\n    if (params.error) {\n      throw new OPError(params);\n    }\n\n    const RESPONSE_TYPE_REQUIRED_PARAMS = {\n      code: ['code'],\n      token: ['access_token', 'token_type'],\n    };\n\n    if (checks.response_type) {\n      for (const type of checks.response_type.split(' ')) { // eslint-disable-line no-restricted-syntax\n        if (type === 'none') {\n          if (params.code || params.id_token || params.access_token) {\n            throw new RPError({\n              message: 'unexpected params encountered for \"none\" response',\n              checks,\n              params,\n            });\n          }\n        }\n\n        if (RESPONSE_TYPE_REQUIRED_PARAMS[type]) {\n          for (const param of RESPONSE_TYPE_REQUIRED_PARAMS[type]) { // eslint-disable-line no-restricted-syntax, max-len\n            if (!params[param]) {\n              throw new RPError({\n                message: `${param} missing from response`,\n                checks,\n                params,\n              });\n            }\n          }\n        }\n      }\n    }\n\n    if (params.code) {\n      return this.grant({\n        ...exchangeBody,\n        grant_type: 'authorization_code',\n        code: params.code,\n        redirect_uri: redirectUri,\n        code_verifier: checks.code_verifier,\n      }, { clientAssertionPayload, DPoP });\n    }\n\n    return new TokenSet(params);\n  }\n\n  /**\n   * @name decryptIdToken\n   * @api private\n   */\n  async decryptIdToken(token) {\n    if (!this.id_token_encrypted_response_alg) {\n      return token;\n    }\n\n    let idToken = token;\n\n    if (idToken instanceof TokenSet) {\n      if (!idToken.id_token) {\n        throw new TypeError('id_token not present in TokenSet');\n      }\n      idToken = idToken.id_token;\n    }\n\n    const expectedAlg = this.id_token_encrypted_response_alg;\n    const expectedEnc = this.id_token_encrypted_response_enc;\n\n    const result = await this.decryptJWE(idToken, expectedAlg, expectedEnc);\n\n    if (token instanceof TokenSet) {\n      token.id_token = result;\n      return token;\n    }\n\n    return result;\n  }\n\n  async validateJWTUserinfo(body) {\n    const expectedAlg = this.userinfo_signed_response_alg;\n\n    return this.validateJWT(body, expectedAlg, []);\n  }\n\n  /**\n   * @name decryptJARM\n   * @api private\n   */\n  async decryptJARM(response) {\n    if (!this.authorization_encrypted_response_alg) {\n      return response;\n    }\n\n    const expectedAlg = this.authorization_encrypted_response_alg;\n    const expectedEnc = this.authorization_encrypted_response_enc;\n\n    return this.decryptJWE(response, expectedAlg, expectedEnc);\n  }\n\n  /**\n   * @name decryptJWTUserinfo\n   * @api private\n   */\n  async decryptJWTUserinfo(body) {\n    if (!this.userinfo_encrypted_response_alg) {\n      return body;\n    }\n\n    const expectedAlg = this.userinfo_encrypted_response_alg;\n    const expectedEnc = this.userinfo_encrypted_response_enc;\n\n    return this.decryptJWE(body, expectedAlg, expectedEnc);\n  }\n\n  /**\n   * @name decryptJWE\n   * @api private\n   */\n  async decryptJWE(jwe, expectedAlg, expectedEnc = 'A128CBC-HS256') {\n    const header = JSON.parse(base64url.decode(jwe.split('.')[0]));\n\n    if (header.alg !== expectedAlg) {\n      throw new RPError({\n        printf: ['unexpected JWE alg received, expected %s, got: %s', expectedAlg, header.alg],\n        jwt: jwe,\n      });\n    }\n\n    if (header.enc !== expectedEnc) {\n      throw new RPError({\n        printf: ['unexpected JWE enc received, expected %s, got: %s', expectedEnc, header.enc],\n        jwt: jwe,\n      });\n    }\n\n    let keyOrStore;\n\n    if (expectedAlg.match(/^(?:RSA|ECDH)/)) {\n      keyOrStore = instance(this).get('keystore');\n    } else {\n      keyOrStore = await this.joseSecret(expectedAlg === 'dir' ? expectedEnc : expectedAlg);\n    }\n\n    const payload = jose.JWE.decrypt(jwe, keyOrStore);\n    return payload.toString('utf8');\n  }\n\n  /**\n   * @name validateIdToken\n   * @api private\n   */\n  async validateIdToken(tokenSet, nonce, returnedBy, maxAge, state) {\n    let idToken = tokenSet;\n\n    const expectedAlg = this.id_token_signed_response_alg;\n\n    const isTokenSet = idToken instanceof TokenSet;\n\n    if (isTokenSet) {\n      if (!idToken.id_token) {\n        throw new TypeError('id_token not present in TokenSet');\n      }\n      idToken = idToken.id_token;\n    }\n\n    idToken = String(idToken);\n\n    const timestamp = now();\n    const { protected: header, payload, key } = await this.validateJWT(idToken, expectedAlg);\n\n    if (maxAge || (maxAge !== null && this.require_auth_time)) {\n      if (!payload.auth_time) {\n        throw new RPError({\n          message: 'missing required JWT property auth_time',\n          jwt: idToken,\n        });\n      }\n      if (typeof payload.auth_time !== 'number') {\n        throw new RPError({\n          message: 'JWT auth_time claim must be a JSON numeric value',\n          jwt: idToken,\n        });\n      }\n    }\n\n    if (maxAge && (payload.auth_time + maxAge < timestamp - this[CLOCK_TOLERANCE])) {\n      throw new RPError({\n        printf: ['too much time has elapsed since the last End-User authentication, max_age %i, auth_time: %i, now %i', maxAge, payload.auth_time, timestamp - this[CLOCK_TOLERANCE]],\n        now: timestamp,\n        tolerance: this[CLOCK_TOLERANCE],\n        auth_time: payload.auth_time,\n        jwt: idToken,\n      });\n    }\n\n    if (nonce !== null && (payload.nonce || nonce !== undefined) && payload.nonce !== nonce) {\n      throw new RPError({\n        printf: ['nonce mismatch, expected %s, got: %s', nonce, payload.nonce],\n        jwt: idToken,\n      });\n    }\n\n    const fapi = this.constructor.name === 'FAPIClient';\n\n    if (returnedBy === 'authorization') {\n      if (!payload.at_hash && tokenSet.access_token) {\n        throw new RPError({\n          message: 'missing required property at_hash',\n          jwt: idToken,\n        });\n      }\n\n      if (!payload.c_hash && tokenSet.code) {\n        throw new RPError({\n          message: 'missing required property c_hash',\n          jwt: idToken,\n        });\n      }\n\n      if (fapi) {\n        if (!payload.s_hash && (tokenSet.state || state)) {\n          throw new RPError({\n            message: 'missing required property s_hash',\n            jwt: idToken,\n          });\n        }\n      }\n\n      if (payload.s_hash) {\n        if (!state) {\n          throw new TypeError('cannot verify s_hash, \"checks.state\" property not provided');\n        }\n\n        try {\n          tokenHash.validate({ claim: 's_hash', source: 'state' }, payload.s_hash, state, header.alg, key && key.crv);\n        } catch (err) {\n          throw new RPError({ message: err.message, jwt: idToken });\n        }\n      }\n    }\n\n    if (fapi && payload.iat < timestamp - 3600) {\n      throw new RPError({\n        printf: ['JWT issued too far in the past, now %i, iat %i', timestamp, payload.iat],\n        now: timestamp,\n        tolerance: this[CLOCK_TOLERANCE],\n        iat: payload.iat,\n        jwt: idToken,\n      });\n    }\n\n    if (tokenSet.access_token && payload.at_hash !== undefined) {\n      try {\n        tokenHash.validate({ claim: 'at_hash', source: 'access_token' }, payload.at_hash, tokenSet.access_token, header.alg, key && key.crv);\n      } catch (err) {\n        throw new RPError({ message: err.message, jwt: idToken });\n      }\n    }\n\n    if (tokenSet.code && payload.c_hash !== undefined) {\n      try {\n        tokenHash.validate({ claim: 'c_hash', source: 'code' }, payload.c_hash, tokenSet.code, header.alg, key && key.crv);\n      } catch (err) {\n        throw new RPError({ message: err.message, jwt: idToken });\n      }\n    }\n\n    return tokenSet;\n  }\n\n  /**\n   * @name validateJWT\n   * @api private\n   */\n  async validateJWT(jwt, expectedAlg, required = ['iss', 'sub', 'aud', 'exp', 'iat']) {\n    const isSelfIssued = this.issuer.issuer === 'https://self-issued.me';\n    const timestamp = now();\n    let header;\n    let payload;\n    try {\n      ({ header, payload } = jose.JWT.decode(jwt, { complete: true }));\n    } catch (err) {\n      throw new RPError({\n        printf: ['failed to decode JWT (%s: %s)', err.name, err.message],\n        jwt,\n      });\n    }\n\n    if (header.alg !== expectedAlg) {\n      throw new RPError({\n        printf: ['unexpected JWT alg received, expected %s, got: %s', expectedAlg, header.alg],\n        jwt,\n      });\n    }\n\n    if (isSelfIssued) {\n      required = [...required, 'sub_jwk']; // eslint-disable-line no-param-reassign\n    }\n\n    required.forEach(verifyPresence.bind(undefined, payload, jwt));\n\n    if (payload.iss !== undefined) {\n      let expectedIss = this.issuer.issuer;\n\n      if (aadIssValidation) {\n        expectedIss = this.issuer.issuer.replace('{tenantid}', payload.tid);\n      }\n\n      if (payload.iss !== expectedIss) {\n        throw new RPError({\n          printf: ['unexpected iss value, expected %s, got: %s', expectedIss, payload.iss],\n          jwt,\n        });\n      }\n    }\n\n    if (payload.iat !== undefined) {\n      if (typeof payload.iat !== 'number') {\n        throw new RPError({\n          message: 'JWT iat claim must be a JSON numeric value',\n          jwt,\n        });\n      }\n    }\n\n    if (payload.nbf !== undefined) {\n      if (typeof payload.nbf !== 'number') {\n        throw new RPError({\n          message: 'JWT nbf claim must be a JSON numeric value',\n          jwt,\n        });\n      }\n      if (payload.nbf > timestamp + this[CLOCK_TOLERANCE]) {\n        throw new RPError({\n          printf: ['JWT not active yet, now %i, nbf %i', timestamp + this[CLOCK_TOLERANCE], payload.nbf],\n          now: timestamp,\n          tolerance: this[CLOCK_TOLERANCE],\n          nbf: payload.nbf,\n          jwt,\n        });\n      }\n    }\n\n    if (payload.exp !== undefined) {\n      if (typeof payload.exp !== 'number') {\n        throw new RPError({\n          message: 'JWT exp claim must be a JSON numeric value',\n          jwt,\n        });\n      }\n      if (timestamp - this[CLOCK_TOLERANCE] >= payload.exp) {\n        throw new RPError({\n          printf: ['JWT expired, now %i, exp %i', timestamp - this[CLOCK_TOLERANCE], payload.exp],\n          now: timestamp,\n          tolerance: this[CLOCK_TOLERANCE],\n          exp: payload.exp,\n          jwt,\n        });\n      }\n    }\n\n    if (payload.aud !== undefined) {\n      if (Array.isArray(payload.aud)) {\n        if (payload.aud.length > 1 && !payload.azp) {\n          throw new RPError({\n            message: 'missing required JWT property azp',\n            jwt,\n          });\n        }\n\n        if (!payload.aud.includes(this.client_id)) {\n          throw new RPError({\n            printf: ['aud is missing the client_id, expected %s to be included in %j', this.client_id, payload.aud],\n            jwt,\n          });\n        }\n      } else if (payload.aud !== this.client_id) {\n        throw new RPError({\n          printf: ['aud mismatch, expected %s, got: %s', this.client_id, payload.aud],\n          jwt,\n        });\n      }\n    }\n\n    if (payload.azp !== undefined) {\n      let { additionalAuthorizedParties } = instance(this).get('options') || {};\n\n      if (typeof additionalAuthorizedParties === 'string') {\n        additionalAuthorizedParties = [this.client_id, additionalAuthorizedParties];\n      } else if (Array.isArray(additionalAuthorizedParties)) {\n        additionalAuthorizedParties = [this.client_id, ...additionalAuthorizedParties];\n      } else {\n        additionalAuthorizedParties = [this.client_id];\n      }\n\n      if (!additionalAuthorizedParties.includes(payload.azp)) {\n        throw new RPError({\n          printf: ['azp mismatch, got: %s', payload.azp],\n          jwt,\n        });\n      }\n    }\n\n    let key;\n\n    if (isSelfIssued) {\n      try {\n        assert(isPlainObject(payload.sub_jwk));\n        key = jose.JWK.asKey(payload.sub_jwk);\n        assert.equal(key.type, 'public');\n      } catch (err) {\n        throw new RPError({\n          message: 'failed to use sub_jwk claim as an asymmetric JSON Web Key',\n          jwt,\n        });\n      }\n      if (key.thumbprint !== payload.sub) {\n        throw new RPError({\n          message: 'failed to match the subject with sub_jwk',\n          jwt,\n        });\n      }\n    } else if (header.alg.startsWith('HS')) {\n      key = await this.joseSecret();\n    } else if (header.alg !== 'none') {\n      key = await this.issuer.queryKeyStore(header);\n    }\n\n    if (!key && header.alg === 'none') {\n      return { protected: header, payload };\n    }\n\n    try {\n      return {\n        ...jose.JWS.verify(jwt, key, { complete: true }),\n        payload,\n      };\n    } catch (err) {\n      throw new RPError({\n        message: 'failed to validate JWT signature',\n        jwt,\n      });\n    }\n  }\n\n  /**\n   * @name refresh\n   * @api public\n   */\n  async refresh(refreshToken, { exchangeBody, clientAssertionPayload, DPoP } = {}) {\n    let token = refreshToken;\n\n    if (token instanceof TokenSet) {\n      if (!token.refresh_token) {\n        throw new TypeError('refresh_token not present in TokenSet');\n      }\n      token = token.refresh_token;\n    }\n\n    const tokenset = await this.grant({\n      ...exchangeBody,\n      grant_type: 'refresh_token',\n      refresh_token: String(token),\n    }, { clientAssertionPayload, DPoP });\n\n    if (tokenset.id_token) {\n      await this.decryptIdToken(tokenset);\n      await this.validateIdToken(tokenset, null, 'token', null);\n\n      if (refreshToken instanceof TokenSet && refreshToken.id_token) {\n        const expectedSub = refreshToken.claims().sub;\n        const actualSub = tokenset.claims().sub;\n        if (actualSub !== expectedSub) {\n          throw new RPError({\n            printf: ['sub mismatch, expected %s, got: %s', expectedSub, actualSub],\n            jwt: tokenset.id_token,\n          });\n        }\n      }\n    }\n\n    return tokenset;\n  }\n\n  async requestResource(\n    resourceUrl,\n    accessToken,\n    {\n      method,\n      headers,\n      body,\n      DPoP,\n      // eslint-disable-next-line no-nested-ternary\n      tokenType = DPoP ? 'DPoP' : accessToken instanceof TokenSet ? accessToken.token_type : 'Bearer',\n    } = {},\n  ) {\n    if (accessToken instanceof TokenSet) {\n      if (!accessToken.access_token) {\n        throw new TypeError('access_token not present in TokenSet');\n      }\n      accessToken = accessToken.access_token; // eslint-disable-line no-param-reassign\n    }\n\n    const requestOpts = {\n      headers: {\n        Authorization: authorizationHeaderValue(accessToken, tokenType),\n        ...headers,\n      },\n      body,\n    };\n\n    const mTLS = !!this.tls_client_certificate_bound_access_tokens;\n\n    return request.call(this, {\n      ...requestOpts,\n      responseType: 'buffer',\n      method,\n      url: resourceUrl,\n    }, { accessToken, mTLS, DPoP });\n  }\n\n  /**\n   * @name userinfo\n   * @api public\n   */\n  async userinfo(accessToken, {\n    method = 'GET', via = 'header', tokenType, params, DPoP,\n  } = {}) {\n    assertIssuerConfiguration(this.issuer, 'userinfo_endpoint');\n    const options = {\n      tokenType,\n      method: String(method).toUpperCase(),\n      DPoP,\n    };\n\n    if (options.method !== 'GET' && options.method !== 'POST') {\n      throw new TypeError('#userinfo() method can only be POST or a GET');\n    }\n\n    if (via === 'query' && options.method !== 'GET') {\n      throw new TypeError('userinfo endpoints will only parse query strings for GET requests');\n    } else if (via === 'body' && options.method !== 'POST') {\n      throw new TypeError('can only send body on POST');\n    }\n\n    const jwt = !!(this.userinfo_signed_response_alg || this.userinfo_encrypted_response_alg);\n\n    if (jwt) {\n      options.headers = { Accept: 'application/jwt' };\n    } else {\n      options.headers = { Accept: 'application/json' };\n    }\n\n    const mTLS = !!this.tls_client_certificate_bound_access_tokens;\n\n    let targetUrl;\n    if (mTLS && this.issuer.mtls_endpoint_aliases) {\n      targetUrl = this.issuer.mtls_endpoint_aliases.userinfo_endpoint;\n    }\n\n    targetUrl = new url.URL(targetUrl || this.issuer.userinfo_endpoint);\n\n    // when via is not header we clear the Authorization header and add either\n    // query string parameters or urlencoded body access_token parameter\n    if (via === 'query') {\n      options.headers.Authorization = undefined;\n      targetUrl.searchParams.append('access_token', accessToken instanceof TokenSet ? accessToken.access_token : accessToken);\n    } else if (via === 'body') {\n      options.headers.Authorization = undefined;\n      options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n      options.body = new url.URLSearchParams();\n      options.body.append('access_token', accessToken instanceof TokenSet ? accessToken.access_token : accessToken);\n    }\n\n    // handle additional parameters, GET via querystring, POST via urlencoded body\n    if (params) {\n      if (options.method === 'GET') {\n        Object.entries(params).forEach(([key, value]) => {\n          targetUrl.searchParams.append(key, value);\n        });\n      } else if (options.body) { // POST && via body\n        Object.entries(params).forEach(([key, value]) => {\n          options.body.append(key, value);\n        });\n      } else { // POST && via header\n        options.body = new url.URLSearchParams();\n        options.headers['Content-Type'] = 'application/x-www-form-urlencoded';\n        Object.entries(params).forEach(([key, value]) => {\n          options.body.append(key, value);\n        });\n      }\n    }\n\n    if (options.body) {\n      options.body = options.body.toString();\n    }\n\n    const response = await this.requestResource(targetUrl, accessToken, options);\n\n    let parsed = processResponse(response, { bearer: true });\n\n    if (jwt) {\n      if (!JWT_CONTENT.test(response.headers['content-type'])) {\n        throw new RPError({\n          message: 'expected application/jwt response from the userinfo_endpoint',\n          response,\n        });\n      }\n\n      const body = response.body.toString();\n      const userinfo = await this.decryptJWTUserinfo(body);\n      if (!this.userinfo_signed_response_alg) {\n        try {\n          parsed = JSON.parse(userinfo);\n          assert(isPlainObject(parsed));\n        } catch (err) {\n          throw new RPError({\n            message: 'failed to parse userinfo JWE payload as JSON',\n            jwt: userinfo,\n          });\n        }\n      } else {\n        ({ payload: parsed } = await this.validateJWTUserinfo(userinfo));\n      }\n    } else {\n      try {\n        parsed = JSON.parse(response.body);\n      } catch (error) {\n        throw new ParseError(error, response);\n      }\n    }\n\n    if (accessToken instanceof TokenSet && accessToken.id_token) {\n      const expectedSub = accessToken.claims().sub;\n      if (parsed.sub !== expectedSub) {\n        throw new RPError({\n          printf: ['userinfo sub mismatch, expected %s, got: %s', expectedSub, parsed.sub],\n          body: parsed,\n          jwt: accessToken.id_token,\n        });\n      }\n    }\n\n    return parsed;\n  }\n\n  /**\n   * @name derivedKey\n   * @api private\n   */\n  async derivedKey(len) {\n    const cacheKey = `${len}_key`;\n    if (instance(this).has(cacheKey)) {\n      return instance(this).get(cacheKey);\n    }\n\n    const hash = len <= 256 ? 'sha256' : len <= 384 ? 'sha384' : len <= 512 ? 'sha512' : false; // eslint-disable-line no-nested-ternary\n    if (!hash) {\n      throw new Error('unsupported symmetric encryption key derivation');\n    }\n\n    const derivedBuffer = crypto.createHash(hash)\n      .update(this.client_secret)\n      .digest()\n      .slice(0, len / 8);\n\n    const key = jose.JWK.asKey({ k: base64url.encode(derivedBuffer), kty: 'oct' });\n    instance(this).set(cacheKey, key);\n\n    return key;\n  }\n\n  /**\n   * @name joseSecret\n   * @api private\n   */\n  async joseSecret(alg) {\n    if (!this.client_secret) {\n      throw new TypeError('client_secret is required');\n    }\n    if (/^A(\\d{3})(?:GCM)?KW$/.test(alg)) {\n      return this.derivedKey(parseInt(RegExp.$1, 10));\n    }\n\n    if (/^A(\\d{3})(?:GCM|CBC-HS(\\d{3}))$/.test(alg)) {\n      return this.derivedKey(parseInt(RegExp.$2 || RegExp.$1, 10));\n    }\n\n    if (instance(this).has('jose_secret')) {\n      return instance(this).get('jose_secret');\n    }\n\n    const key = jose.JWK.asKey({ k: base64url.encode(this.client_secret), kty: 'oct' });\n    instance(this).set('jose_secret', key);\n\n    return key;\n  }\n\n  /**\n   * @name grant\n   * @api public\n   */\n  async grant(body, { clientAssertionPayload, DPoP } = {}) {\n    assertIssuerConfiguration(this.issuer, 'token_endpoint');\n    const response = await authenticatedPost.call(\n      this,\n      'token',\n      {\n        form: body,\n        responseType: 'json',\n      },\n      { clientAssertionPayload, DPoP },\n    );\n    const responseBody = processResponse(response);\n\n    return new TokenSet(responseBody);\n  }\n\n  /**\n   * @name deviceAuthorization\n   * @api public\n   */\n  async deviceAuthorization(params = {}, { exchangeBody, clientAssertionPayload, DPoP } = {}) {\n    assertIssuerConfiguration(this.issuer, 'device_authorization_endpoint');\n    assertIssuerConfiguration(this.issuer, 'token_endpoint');\n\n    const body = authorizationParams.call(this, {\n      client_id: this.client_id,\n      redirect_uri: null,\n      response_type: null,\n      ...params,\n    });\n\n    const response = await authenticatedPost.call(\n      this,\n      'device_authorization',\n      {\n        responseType: 'json',\n        form: body,\n      },\n      { clientAssertionPayload, endpointAuthMethod: 'token' },\n    );\n    const responseBody = processResponse(response);\n\n    return new DeviceFlowHandle({\n      client: this,\n      exchangeBody,\n      clientAssertionPayload,\n      response: responseBody,\n      maxAge: params.max_age,\n      DPoP,\n    });\n  }\n\n  /**\n   * @name revoke\n   * @api public\n   */\n  async revoke(token, hint, { revokeBody, clientAssertionPayload } = {}) {\n    assertIssuerConfiguration(this.issuer, 'revocation_endpoint');\n    if (hint !== undefined && typeof hint !== 'string') {\n      throw new TypeError('hint must be a string');\n    }\n\n    const form = { ...revokeBody, token };\n\n    if (hint) {\n      form.token_type_hint = hint;\n    }\n\n    const response = await authenticatedPost.call(\n      this,\n      'revocation', {\n        form,\n      }, { clientAssertionPayload },\n    );\n    processResponse(response, { body: false });\n  }\n\n  /**\n   * @name introspect\n   * @api public\n   */\n  async introspect(token, hint, { introspectBody, clientAssertionPayload } = {}) {\n    assertIssuerConfiguration(this.issuer, 'introspection_endpoint');\n    if (hint !== undefined && typeof hint !== 'string') {\n      throw new TypeError('hint must be a string');\n    }\n\n    const form = { ...introspectBody, token };\n    if (hint) {\n      form.token_type_hint = hint;\n    }\n\n    const response = await authenticatedPost.call(\n      this,\n      'introspection',\n      { form, responseType: 'json' },\n      { clientAssertionPayload },\n    );\n\n    const responseBody = processResponse(response);\n\n    return responseBody;\n  }\n\n  /**\n   * @name fetchDistributedClaims\n   * @api public\n   */\n  async fetchDistributedClaims(claims, tokens = {}) {\n    if (!isPlainObject(claims)) {\n      throw new TypeError('claims argument must be a plain object');\n    }\n\n    if (!isPlainObject(claims._claim_sources)) {\n      return claims;\n    }\n\n    if (!isPlainObject(claims._claim_names)) {\n      return claims;\n    }\n\n    const distributedSources = Object.entries(claims._claim_sources)\n      .filter(([, value]) => value && value.endpoint);\n\n    await Promise.all(distributedSources.map(async ([sourceName, def]) => {\n      try {\n        const requestOpts = {\n          headers: {\n            Accept: 'application/jwt',\n            Authorization: authorizationHeaderValue(def.access_token || tokens[sourceName]),\n          },\n        };\n\n        const response = await request.call(this, {\n          ...requestOpts,\n          method: 'GET',\n          url: def.endpoint,\n        });\n        const body = processResponse(response, { bearer: true });\n\n        const decoded = await claimJWT.call(this, 'distributed', body);\n        delete claims._claim_sources[sourceName];\n        Object.entries(claims._claim_names).forEach(\n          assignClaim(claims, decoded, sourceName, false),\n        );\n      } catch (err) {\n        err.src = sourceName;\n        throw err;\n      }\n    }));\n\n    cleanUpClaims(claims);\n    return claims;\n  }\n\n  /**\n   * @name unpackAggregatedClaims\n   * @api public\n   */\n  async unpackAggregatedClaims(claims) {\n    if (!isPlainObject(claims)) {\n      throw new TypeError('claims argument must be a plain object');\n    }\n\n    if (!isPlainObject(claims._claim_sources)) {\n      return claims;\n    }\n\n    if (!isPlainObject(claims._claim_names)) {\n      return claims;\n    }\n\n    const aggregatedSources = Object.entries(claims._claim_sources)\n      .filter(([, value]) => value && value.JWT);\n\n    await Promise.all(aggregatedSources.map(async ([sourceName, def]) => {\n      try {\n        const decoded = await claimJWT.call(this, 'aggregated', def.JWT);\n        delete claims._claim_sources[sourceName];\n        Object.entries(claims._claim_names).forEach(assignClaim(claims, decoded, sourceName));\n      } catch (err) {\n        err.src = sourceName;\n        throw err;\n      }\n    }));\n\n    cleanUpClaims(claims);\n    return claims;\n  }\n\n  /**\n   * @name register\n   * @api public\n   */\n  static async register(metadata, options = {}) {\n    const { initialAccessToken, jwks, ...clientOptions } = options;\n\n    assertIssuerConfiguration(this.issuer, 'registration_endpoint');\n\n    if (jwks !== undefined && !(metadata.jwks || metadata.jwks_uri)) {\n      const keystore = getKeystore.call(this, jwks);\n      metadata.jwks = keystore.toJWKS(false);\n      // eslint-disable-next-line no-restricted-syntax\n      for (const jwk of metadata.jwks.keys) {\n        if (jwk.kid.startsWith('DONOTUSE.')) {\n          delete jwk.kid;\n        }\n      }\n    }\n\n    const response = await request.call(this, {\n      headers: initialAccessToken ? {\n        Authorization: authorizationHeaderValue(initialAccessToken),\n      } : undefined,\n      responseType: 'json',\n      json: metadata,\n      url: this.issuer.registration_endpoint,\n      method: 'POST',\n    });\n    const responseBody = processResponse(response, { statusCode: 201, bearer: true });\n\n    return new this(responseBody, jwks, clientOptions);\n  }\n\n  /**\n   * @name metadata\n   * @api public\n   */\n  get metadata() {\n    const copy = {};\n    instance(this).get('metadata').forEach((value, key) => {\n      copy[key] = value;\n    });\n    return copy;\n  }\n\n  /**\n   * @name fromUri\n   * @api public\n   */\n  static async fromUri(registrationClientUri, registrationAccessToken, jwks, clientOptions) {\n    const response = await request.call(this, {\n      method: 'GET',\n      url: registrationClientUri,\n      responseType: 'json',\n      headers: { Authorization: authorizationHeaderValue(registrationAccessToken) },\n    });\n    const responseBody = processResponse(response, { bearer: true });\n\n    return new this(responseBody, jwks, clientOptions);\n  }\n\n  /**\n   * @name requestObject\n   * @api public\n   */\n  async requestObject(requestObject = {}, {\n    sign: signingAlgorithm = this.request_object_signing_alg || 'none',\n    encrypt: {\n      alg: eKeyManagement = this.request_object_encryption_alg,\n      enc: eContentEncryption = this.request_object_encryption_enc || 'A128CBC-HS256',\n    } = {},\n  } = {}) {\n    if (!isPlainObject(requestObject)) {\n      throw new TypeError('requestObject must be a plain object');\n    }\n\n    let signed;\n    let key;\n\n    const fapi = this.constructor.name === 'FAPIClient';\n    const unix = now();\n    const header = { alg: signingAlgorithm, typ: 'oauth-authz-req+jwt' };\n    const payload = JSON.stringify(defaults({}, requestObject, {\n      iss: this.client_id,\n      aud: this.issuer.issuer,\n      client_id: this.client_id,\n      jti: random(),\n      iat: unix,\n      exp: unix + 300,\n      ...(fapi ? { nbf: unix } : undefined),\n    }));\n\n    if (signingAlgorithm === 'none') {\n      signed = [\n        base64url.encode(JSON.stringify(header)),\n        base64url.encode(payload),\n        '',\n      ].join('.');\n    } else {\n      const symmetric = signingAlgorithm.startsWith('HS');\n      if (symmetric) {\n        key = await this.joseSecret();\n      } else {\n        const keystore = instance(this).get('keystore');\n\n        if (!keystore) {\n          throw new TypeError(`no keystore present for client, cannot sign using alg ${signingAlgorithm}`);\n        }\n        key = keystore.get({ alg: signingAlgorithm, use: 'sig' });\n        if (!key) {\n          throw new TypeError(`no key to sign with found for alg ${signingAlgorithm}`);\n        }\n      }\n\n      signed = jose.JWS.sign(payload, key, {\n        ...header,\n        kid: symmetric || key.kid.startsWith('DONOTUSE.') ? undefined : key.kid,\n      });\n    }\n\n    if (!eKeyManagement) {\n      return signed;\n    }\n\n    const fields = { alg: eKeyManagement, enc: eContentEncryption, cty: 'oauth-authz-req+jwt' };\n\n    if (fields.alg.match(/^(RSA|ECDH)/)) {\n      [key] = await this.issuer.queryKeyStore({\n        alg: fields.alg,\n        enc: fields.enc,\n        use: 'enc',\n      }, { allowMulti: true });\n    } else {\n      key = await this.joseSecret(fields.alg === 'dir' ? fields.enc : fields.alg);\n    }\n\n    return jose.JWE.encrypt(signed, key, {\n      ...fields,\n      kid: key.kty === 'oct' ? undefined : key.kid,\n    });\n  }\n\n  /**\n   * @name pushedAuthorizationRequest\n   * @api public\n   */\n  async pushedAuthorizationRequest(params = {}, { clientAssertionPayload } = {}) {\n    assertIssuerConfiguration(this.issuer, 'pushed_authorization_request_endpoint');\n\n    const body = {\n      ...('request' in params ? params : authorizationParams.call(this, params)),\n      client_id: this.client_id,\n    };\n\n    const response = await authenticatedPost.call(\n      this,\n      'pushed_authorization_request',\n      {\n        responseType: 'json',\n        form: body,\n      },\n      { clientAssertionPayload, endpointAuthMethod: 'token' },\n    );\n    const responseBody = processResponse(response, { statusCode: 201 });\n\n    if (!('expires_in' in responseBody)) {\n      throw new RPError({\n        message: 'expected expires_in in Pushed Authorization Successful Response',\n        response,\n      });\n    }\n    if (typeof responseBody.expires_in !== 'number') {\n      throw new RPError({\n        message: 'invalid expires_in value in Pushed Authorization Successful Response',\n        response,\n      });\n    }\n    if (!('request_uri' in responseBody)) {\n      throw new RPError({\n        message: 'expected request_uri in Pushed Authorization Successful Response',\n        response,\n      });\n    }\n    if (typeof responseBody.request_uri !== 'string') {\n      throw new RPError({\n        message: 'invalid request_uri value in Pushed Authorization Successful Response',\n        response,\n      });\n    }\n\n    return responseBody;\n  }\n\n  /**\n   * @name issuer\n   * @api public\n   */\n  static get issuer() {\n    return issuer;\n  }\n\n  /**\n   * @name issuer\n   * @api public\n   */\n  get issuer() { // eslint-disable-line class-methods-use-this\n    return issuer;\n  }\n\n  /* istanbul ignore next */\n  [inspect.custom]() {\n    return `${this.constructor.name} ${inspect(this.metadata, {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true,\n    })}`;\n  }\n};\n\n/**\n * @name validateJARM\n * @api private\n */\nasync function validateJARM(response) {\n  const expectedAlg = this.authorization_signed_response_alg;\n  const { payload } = await this.validateJWT(response, expectedAlg, ['iss', 'exp', 'aud']);\n  return pickCb(payload);\n}\n\nObject.defineProperty(BaseClient.prototype, 'validateJARM', {\n  enumerable: true,\n  configurable: true,\n  value(...args) {\n    process.emitWarning(\n      \"The JARM API implements an OIDF implementer's draft. Breaking draft implementations are included as minor versions of the openid-client library, therefore, the ~ semver operator should be used and close attention be payed to library changelog as well as the drafts themselves.\",\n      'DraftWarning',\n    );\n    Object.defineProperty(BaseClient.prototype, 'validateJARM', {\n      enumerable: true,\n      configurable: true,\n      value: validateJARM,\n    });\n    return this.validateJARM(...args);\n  },\n});\n\n/**\n * @name dpopProof\n * @api private\n */\nfunction dpopProof(payload, jwk, accessToken) {\n  if (!isPlainObject(payload)) {\n    throw new TypeError('payload must be a plain object');\n  }\n\n  let key;\n  try {\n    key = jose.JWK.asKey(jwk);\n    assert(key.type === 'private');\n  } catch (err) {\n    throw new TypeError('\"DPoP\" option must be an asymmetric private key to sign the DPoP Proof JWT with');\n  }\n\n  let { alg } = key;\n\n  if (!alg && this.issuer.dpop_signing_alg_values_supported) {\n    const algs = key.algorithms('sign');\n    alg = this.issuer.dpop_signing_alg_values_supported.find((a) => algs.has(a));\n  }\n\n  if (!alg) {\n    [alg] = key.algorithms('sign');\n  }\n\n  return jose.JWS.sign({\n    iat: now(),\n    jti: random(),\n    ath: accessToken ? base64url.encode(crypto.createHash('sha256').update(accessToken).digest()) : undefined,\n    ...payload,\n  }, jwk, {\n    alg,\n    typ: 'dpop+jwt',\n    jwk: pick(key, 'kty', 'crv', 'x', 'y', 'e', 'n'),\n  });\n}\n\nObject.defineProperty(BaseClient.prototype, 'dpopProof', {\n  enumerable: true,\n  configurable: true,\n  value(...args) {\n    process.emitWarning(\n      'The DPoP APIs implements an IETF draft (https://www.ietf.org/archive/id/draft-ietf-oauth-dpop-03.html). Breaking draft implementations are included as minor versions of the openid-client library, therefore, the ~ semver operator should be used and close attention be payed to library changelog as well as the drafts themselves.',\n      'DraftWarning',\n    );\n    Object.defineProperty(BaseClient.prototype, 'dpopProof', {\n      enumerable: true,\n      configurable: true,\n      value: dpopProof,\n    });\n    return this.dpopProof(...args);\n  },\n});\n\nmodule.exports.BaseClient = BaseClient;\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2351, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/webfinger_normalize.js"],"sourcesContent":["// Credit: https://github.com/rohe/pyoidc/blob/master/src/oic/utils/webfinger.py\n\n// -- Normalization --\n// A string of any other type is interpreted as a URI either the form of scheme\n// \"://\" authority path-abempty [ \"?\" query ] [ \"#\" fragment ] or authority\n// path-abempty [ \"?\" query ] [ \"#\" fragment ] per RFC 3986 [RFC3986] and is\n// normalized according to the following rules:\n//\n// If the user input Identifier does not have an RFC 3986 [RFC3986] scheme\n// portion, the string is interpreted as [userinfo \"@\"] host [\":\" port]\n// path-abempty [ \"?\" query ] [ \"#\" fragment ] per RFC 3986 [RFC3986].\n// If the userinfo component is present and all of the path component, query\n// component, and port component are empty, the acct scheme is assumed. In this\n// case, the normalized URI is formed by prefixing acct: to the string as the\n// scheme. Per the 'acct' URI Scheme [ID.ietfappsawgaccturi], if there is an\n// at-sign character ('@') in the userinfo component, it needs to be\n// percent-encoded as described in RFC 3986 [RFC3986].\n// For all other inputs without a scheme portion, the https scheme is assumed,\n// and the normalized URI is formed by prefixing https:// to the string as the\n// scheme.\n// If the resulting URI contains a fragment portion, it MUST be stripped off\n// together with the fragment delimiter character \"#\".\n// The WebFinger [ID.ietfappsawgwebfinger] Resource in this case is the\n// resulting URI, and the WebFinger Host is the authority component.\n//\n// Note: Since the definition of authority in RFC 3986 [RFC3986] is\n// [ userinfo \"@\" ] host [ \":\" port ], it is legal to have a user input\n// identifier like userinfo@host:port, e.g., alice@example.com:8080.\n\nconst PORT = /^\\d+$/;\n\nfunction hasScheme(input) {\n  if (input.includes('://')) return true;\n\n  const authority = input.replace(/(\\/|\\?)/g, '#').split('#')[0];\n  if (authority.includes(':')) {\n    const index = authority.indexOf(':');\n    const hostOrPort = authority.slice(index + 1);\n    if (!PORT.test(hostOrPort)) {\n      return true;\n    }\n  }\n\n  return false;\n}\n\nfunction acctSchemeAssumed(input) {\n  if (!input.includes('@')) return false;\n  const parts = input.split('@');\n  const host = parts[parts.length - 1];\n  return !(host.includes(':') || host.includes('/') || host.includes('?'));\n}\n\nfunction normalize(input) {\n  if (typeof input !== 'string') {\n    throw new TypeError('input must be a string');\n  }\n\n  let output;\n  if (hasScheme(input)) {\n    output = input;\n  } else if (acctSchemeAssumed(input)) {\n    output = `acct:${input}`;\n  } else {\n    output = `https://${input}`;\n  }\n\n  return output.split('#')[0];\n}\n\nmodule.exports = normalize;\n"],"names":[],"mappings":"AAAA,gFAAgF;AAEhF,sBAAsB;AACtB,+EAA+E;AAC/E,2EAA2E;AAC3E,4EAA4E;AAC5E,+CAA+C;AAC/C,EAAE;AACF,0EAA0E;AAC1E,uEAAuE;AACvE,sEAAsE;AACtE,4EAA4E;AAC5E,+EAA+E;AAC/E,6EAA6E;AAC7E,gFAAgF;AAChF,oEAAoE;AACpE,sDAAsD;AACtD,8EAA8E;AAC9E,8EAA8E;AAC9E,UAAU;AACV,4EAA4E;AAC5E,sDAAsD;AACtD,0EAA0E;AAC1E,oEAAoE;AACpE,EAAE;AACF,mEAAmE;AACnE,uEAAuE;AACvE,oEAAoE;AAEpE,MAAM,OAAO;AAEb,SAAS,UAAU,KAAK;IACtB,IAAI,MAAM,QAAQ,CAAC,QAAQ,OAAO;IAElC,MAAM,YAAY,MAAM,OAAO,CAAC,YAAY,KAAK,KAAK,CAAC,IAAI,CAAC,EAAE;IAC9D,IAAI,UAAU,QAAQ,CAAC,MAAM;QAC3B,MAAM,QAAQ,UAAU,OAAO,CAAC;QAChC,MAAM,aAAa,UAAU,KAAK,CAAC,QAAQ;QAC3C,IAAI,CAAC,KAAK,IAAI,CAAC,aAAa;YAC1B,OAAO;QACT;IACF;IAEA,OAAO;AACT;AAEA,SAAS,kBAAkB,KAAK;IAC9B,IAAI,CAAC,MAAM,QAAQ,CAAC,MAAM,OAAO;IACjC,MAAM,QAAQ,MAAM,KAAK,CAAC;IAC1B,MAAM,OAAO,KAAK,CAAC,MAAM,MAAM,GAAG,EAAE;IACpC,OAAO,CAAC,CAAC,KAAK,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAC,QAAQ,KAAK,QAAQ,CAAC,IAAI;AACzE;AAEA,SAAS,UAAU,KAAK;IACtB,IAAI,OAAO,UAAU,UAAU;QAC7B,MAAM,IAAI,UAAU;IACtB;IAEA,IAAI;IACJ,IAAI,UAAU,QAAQ;QACpB,SAAS;IACX,OAAO,IAAI,kBAAkB,QAAQ;QACnC,SAAS,CAAC,KAAK,EAAE,OAAO;IAC1B,OAAO;QACL,SAAS,CAAC,QAAQ,EAAE,OAAO;IAC7B;IAEA,OAAO,OAAO,KAAK,CAAC,IAAI,CAAC,EAAE;AAC7B;AAEA,OAAO,OAAO,GAAG","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2417, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/issuer.js"],"sourcesContent":["/* eslint-disable max-classes-per-file */\n\nconst { inspect } = require('util');\nconst url = require('url');\n\nconst AggregateError = require('aggregate-error');\nconst jose = require('jose');\nconst LRU = require('lru-cache');\nconst objectHash = require('object-hash');\n\nconst { RPError } = require('./errors');\nconst getClient = require('./client');\nconst registry = require('./issuer_registry');\nconst processResponse = require('./helpers/process_response');\nconst webfingerNormalize = require('./helpers/webfinger_normalize');\nconst instance = require('./helpers/weak_cache');\nconst request = require('./helpers/request');\nconst { assertIssuerConfiguration } = require('./helpers/assert');\nconst {\n  ISSUER_DEFAULTS, OIDC_DISCOVERY, OAUTH2_DISCOVERY, WEBFINGER, REL, AAD_MULTITENANT_DISCOVERY,\n} = require('./helpers/consts');\n\nconst AAD_MULTITENANT = Symbol('AAD_MULTITENANT');\n\nclass Issuer {\n  /**\n   * @name constructor\n   * @api public\n   */\n  constructor(meta = {}) {\n    const aadIssValidation = meta[AAD_MULTITENANT];\n    delete meta[AAD_MULTITENANT];\n\n    ['introspection', 'revocation'].forEach((endpoint) => {\n      // if intro/revocation endpoint auth specific meta is missing use the token ones if they\n      // are defined\n      if (\n        meta[`${endpoint}_endpoint`]\n        && meta[`${endpoint}_endpoint_auth_methods_supported`] === undefined\n        && meta[`${endpoint}_endpoint_auth_signing_alg_values_supported`] === undefined\n      ) {\n        if (meta.token_endpoint_auth_methods_supported) {\n          meta[`${endpoint}_endpoint_auth_methods_supported`] = meta.token_endpoint_auth_methods_supported;\n        }\n        if (meta.token_endpoint_auth_signing_alg_values_supported) {\n          meta[`${endpoint}_endpoint_auth_signing_alg_values_supported`] = meta.token_endpoint_auth_signing_alg_values_supported;\n        }\n      }\n    });\n\n    Object.entries(meta).forEach(([key, value]) => {\n      instance(this).get('metadata').set(key, value);\n      if (!this[key]) {\n        Object.defineProperty(this, key, {\n          get() { return instance(this).get('metadata').get(key); },\n          enumerable: true,\n        });\n      }\n    });\n\n    instance(this).set('cache', new LRU({ max: 100 }));\n\n    registry.set(this.issuer, this);\n\n    const Client = getClient(this, aadIssValidation);\n\n    Object.defineProperties(this, {\n      Client: { value: Client },\n      FAPIClient: { value: class FAPIClient extends Client {} },\n    });\n  }\n\n  /**\n   * @name keystore\n   * @api public\n   */\n  async keystore(reload = false) {\n    assertIssuerConfiguration(this, 'jwks_uri');\n\n    const keystore = instance(this).get('keystore');\n    const cache = instance(this).get('cache');\n\n    if (reload || !keystore) {\n      cache.reset();\n      const response = await request.call(this, {\n        method: 'GET',\n        responseType: 'json',\n        url: this.jwks_uri,\n      });\n      const jwks = processResponse(response);\n\n      const joseKeyStore = jose.JWKS.asKeyStore(jwks, { ignoreErrors: true });\n      cache.set('throttle', true, 60 * 1000);\n      instance(this).set('keystore', joseKeyStore);\n      return joseKeyStore;\n    }\n\n    return keystore;\n  }\n\n  /**\n   * @name queryKeyStore\n   * @api private\n   */\n  async queryKeyStore({\n    kid, kty, alg, use, key_ops: ops,\n  }, { allowMulti = false } = {}) {\n    const cache = instance(this).get('cache');\n\n    const def = {\n      kid, kty, alg, use, key_ops: ops,\n    };\n\n    const defHash = objectHash(def, {\n      algorithm: 'sha256',\n      ignoreUnknown: true,\n      unorderedArrays: true,\n      unorderedSets: true,\n    });\n\n    // refresh keystore on every unknown key but also only upto once every minute\n    const freshJwksUri = cache.get(defHash) || cache.get('throttle');\n\n    const keystore = await this.keystore(!freshJwksUri);\n    const keys = keystore.all(def);\n\n    if (keys.length === 0) {\n      throw new RPError({\n        printf: [\"no valid key found in issuer's jwks_uri for key parameters %j\", def],\n        jwks: keystore,\n      });\n    }\n\n    if (!allowMulti && keys.length > 1 && !kid) {\n      throw new RPError({\n        printf: [\"multiple matching keys found in issuer's jwks_uri for key parameters %j, kid must be provided in this case\", def],\n        jwks: keystore,\n      });\n    }\n\n    cache.set(defHash, true);\n\n    return new jose.JWKS.KeyStore(keys);\n  }\n\n  /**\n   * @name metadata\n   * @api public\n   */\n  get metadata() {\n    const copy = {};\n    instance(this).get('metadata').forEach((value, key) => {\n      copy[key] = value;\n    });\n    return copy;\n  }\n\n  /**\n   * @name webfinger\n   * @api public\n   */\n  static async webfinger(input) {\n    const resource = webfingerNormalize(input);\n    const { host } = url.parse(resource);\n    const webfingerUrl = `https://${host}${WEBFINGER}`;\n\n    const response = await request.call(this, {\n      method: 'GET',\n      url: webfingerUrl,\n      responseType: 'json',\n      searchParams: { resource, rel: REL },\n      followRedirect: true,\n    });\n    const body = processResponse(response);\n\n    const location = Array.isArray(body.links) && body.links.find((link) => typeof link === 'object' && link.rel === REL && link.href);\n\n    if (!location) {\n      throw new RPError({\n        message: 'no issuer found in webfinger response',\n        body,\n      });\n    }\n\n    if (typeof location.href !== 'string' || !location.href.startsWith('https://')) {\n      throw new RPError({\n        printf: ['invalid issuer location %s', location.href],\n        body,\n      });\n    }\n\n    const expectedIssuer = location.href;\n    if (registry.has(expectedIssuer)) {\n      return registry.get(expectedIssuer);\n    }\n\n    const issuer = await this.discover(expectedIssuer);\n\n    if (issuer.issuer !== expectedIssuer) {\n      registry.delete(issuer.issuer);\n      throw new RPError('discovered issuer mismatch, expected %s, got: %s', expectedIssuer, issuer.issuer);\n    }\n    return issuer;\n  }\n\n  /**\n   * @name discover\n   * @api public\n   */\n  static async discover(uri) {\n    const parsed = url.parse(uri);\n\n    if (parsed.pathname.includes('/.well-known/')) {\n      const response = await request.call(this, {\n        method: 'GET',\n        responseType: 'json',\n        url: uri,\n      });\n      const body = processResponse(response);\n      return new Issuer({\n        ...ISSUER_DEFAULTS,\n        ...body,\n        [AAD_MULTITENANT]: !!AAD_MULTITENANT_DISCOVERY.find(\n          (discoveryURL) => uri.startsWith(discoveryURL),\n        ),\n      });\n    }\n\n    const pathnames = [];\n    if (parsed.pathname.endsWith('/')) {\n      pathnames.push(`${parsed.pathname}${OIDC_DISCOVERY.substring(1)}`);\n    } else {\n      pathnames.push(`${parsed.pathname}${OIDC_DISCOVERY}`);\n    }\n    if (parsed.pathname === '/') {\n      pathnames.push(`${OAUTH2_DISCOVERY}`);\n    } else {\n      pathnames.push(`${OAUTH2_DISCOVERY}${parsed.pathname}`);\n    }\n\n    const errors = [];\n    // eslint-disable-next-line no-restricted-syntax\n    for (const pathname of pathnames) {\n      try {\n        const wellKnownUri = url.format({ ...parsed, pathname });\n        // eslint-disable-next-line no-await-in-loop\n        const response = await request.call(this, {\n          method: 'GET',\n          responseType: 'json',\n          url: wellKnownUri,\n        });\n        const body = processResponse(response);\n        return new Issuer({\n          ...ISSUER_DEFAULTS,\n          ...body,\n          [AAD_MULTITENANT]: !!AAD_MULTITENANT_DISCOVERY.find(\n            (discoveryURL) => wellKnownUri.startsWith(discoveryURL),\n          ),\n        });\n      } catch (err) {\n        errors.push(err);\n      }\n    }\n\n    const err = new AggregateError(errors);\n    err.message = `Issuer.discover() failed.${err.message.split('\\n')\n      .filter((line) => !line.startsWith('        at')).join('\\n')}`;\n    throw err;\n  }\n\n  /* istanbul ignore next */\n  [inspect.custom]() {\n    return `${this.constructor.name} ${inspect(this.metadata, {\n      depth: Infinity,\n      colors: process.stdout.isTTY,\n      compact: false,\n      sorted: true,\n    })}`;\n  }\n}\n\nmodule.exports = Issuer;\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2675, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/helpers/deep_clone.js"],"sourcesContent":["module.exports = (obj) => JSON.parse(JSON.stringify(obj));\n"],"names":[],"mappings":"AAAA,OAAO,OAAO,GAAG,CAAC,MAAQ,KAAK,KAAK,CAAC,KAAK,SAAS,CAAC","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2681, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/passport_strategy.js"],"sourcesContent":["/* eslint-disable no-underscore-dangle */\n\nconst url = require('url');\nconst { format } = require('util');\n\nconst cloneDeep = require('./helpers/deep_clone');\nconst { RPError, OPError } = require('./errors');\nconst { BaseClient } = require('./client');\nconst { random, codeChallenge } = require('./helpers/generators');\nconst pick = require('./helpers/pick');\nconst { resolveResponseType, resolveRedirectUri } = require('./helpers/client');\n\nfunction verified(err, user, info = {}) {\n  if (err) {\n    this.error(err);\n  } else if (!user) {\n    this.fail(info);\n  } else {\n    this.success(user, info);\n  }\n}\n\n/**\n * @name constructor\n * @api public\n */\nfunction OpenIDConnectStrategy({\n  client,\n  params = {},\n  passReqToCallback = false,\n  sessionKey,\n  usePKCE = true,\n  extras = {},\n} = {}, verify) {\n  if (!(client instanceof BaseClient)) {\n    throw new TypeError('client must be an instance of openid-client Client');\n  }\n\n  if (typeof verify !== 'function') {\n    throw new TypeError('verify callback must be a function');\n  }\n\n  if (!client.issuer || !client.issuer.issuer) {\n    throw new TypeError('client must have an issuer with an identifier');\n  }\n\n  this._client = client;\n  this._issuer = client.issuer;\n  this._verify = verify;\n  this._passReqToCallback = passReqToCallback;\n  this._usePKCE = usePKCE;\n  this._key = sessionKey || `oidc:${url.parse(this._issuer.issuer).hostname}`;\n  this._params = cloneDeep(params);\n  this._extras = cloneDeep(extras);\n\n  if (!this._params.response_type) this._params.response_type = resolveResponseType.call(client);\n  if (!this._params.redirect_uri) this._params.redirect_uri = resolveRedirectUri.call(client);\n  if (!this._params.scope) this._params.scope = 'openid';\n\n  if (this._usePKCE === true) {\n    const supportedMethods = Array.isArray(this._issuer.code_challenge_methods_supported)\n      ? this._issuer.code_challenge_methods_supported : false;\n\n    if (supportedMethods && supportedMethods.includes('S256')) {\n      this._usePKCE = 'S256';\n    } else if (supportedMethods && supportedMethods.includes('plain')) {\n      this._usePKCE = 'plain';\n    } else if (supportedMethods) {\n      throw new TypeError('neither code_challenge_method supported by the client is supported by the issuer');\n    } else {\n      this._usePKCE = 'S256';\n    }\n  } else if (typeof this._usePKCE === 'string' && !['plain', 'S256'].includes(this._usePKCE)) {\n    throw new TypeError(`${this._usePKCE} is not valid/implemented PKCE code_challenge_method`);\n  }\n\n  this.name = url.parse(client.issuer.issuer).hostname;\n}\n\nOpenIDConnectStrategy.prototype.authenticate = function authenticate(req, options) {\n  (async () => {\n    const client = this._client;\n    if (!req.session) {\n      throw new TypeError('authentication requires session support');\n    }\n    const reqParams = client.callbackParams(req);\n    const sessionKey = this._key;\n\n    /* start authentication request */\n    if (Object.keys(reqParams).length === 0) {\n      // provide options object with extra authentication parameters\n      const params = {\n        state: random(),\n        ...this._params,\n        ...options,\n      };\n\n      if (!params.nonce && params.response_type.includes('id_token')) {\n        params.nonce = random();\n      }\n\n      req.session[sessionKey] = pick(params, 'nonce', 'state', 'max_age', 'response_type');\n\n      if (this._usePKCE && params.response_type.includes('code')) {\n        const verifier = random();\n        req.session[sessionKey].code_verifier = verifier;\n\n        switch (this._usePKCE) { // eslint-disable-line default-case\n          case 'S256':\n            params.code_challenge = codeChallenge(verifier);\n            params.code_challenge_method = 'S256';\n            break;\n          case 'plain':\n            params.code_challenge = verifier;\n            break;\n        }\n      }\n\n      this.redirect(client.authorizationUrl(params));\n      return;\n    }\n    /* end authentication request */\n\n    /* start authentication response */\n\n    const session = req.session[sessionKey];\n    if (Object.keys(session || {}).length === 0) {\n      throw new Error(format('did not find expected authorization request details in session, req.session[\"%s\"] is %j', sessionKey, session));\n    }\n\n    const {\n      state, nonce, max_age: maxAge, code_verifier: codeVerifier, response_type: responseType,\n    } = session;\n\n    try {\n      delete req.session[sessionKey];\n    } catch (err) {}\n\n    const opts = {\n      redirect_uri: this._params.redirect_uri,\n      ...options,\n    };\n\n    const checks = {\n      state,\n      nonce,\n      max_age: maxAge,\n      code_verifier: codeVerifier,\n      response_type: responseType,\n    };\n\n    const tokenset = await client.callback(opts.redirect_uri, reqParams, checks, this._extras);\n\n    const passReq = this._passReqToCallback;\n    const loadUserinfo = this._verify.length > (passReq ? 3 : 2) && client.issuer.userinfo_endpoint;\n\n    const args = [tokenset, verified.bind(this)];\n\n    if (loadUserinfo) {\n      if (!tokenset.access_token) {\n        throw new RPError({\n          message: 'expected access_token to be returned when asking for userinfo in verify callback',\n          tokenset,\n        });\n      }\n      const userinfo = await client.userinfo(tokenset);\n      args.splice(1, 0, userinfo);\n    }\n\n    if (passReq) {\n      args.unshift(req);\n    }\n\n    this._verify(...args);\n    /* end authentication response */\n  })().catch((error) => {\n    if (\n      (error instanceof OPError && error.error !== 'server_error' && !error.error.startsWith('invalid'))\n      || error instanceof RPError\n    ) {\n      this.fail(error);\n    } else {\n      this.error(error);\n    }\n  });\n};\n\nmodule.exports = OpenIDConnectStrategy;\n"],"names":[],"mappings":"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","ignoreList":[0],"debugId":null}},
    {"offset": {"line": 2830, "column": 0}, "map": {"version":3,"sources":["file:///Volumes/extdisk/WORK/audittrial/backend/node_modules/openid-client/lib/index.js"],"sourcesContent":["const Issuer = require('./issuer');\nconst { OPError, RPError } = require('./errors');\nconst Registry = require('./issuer_registry');\nconst Strategy = require('./passport_strategy');\nconst TokenSet = require('./token_set');\nconst { CLOCK_TOLERANCE, HTTP_OPTIONS } = require('./helpers/consts');\nconst generators = require('./helpers/generators');\nconst { setDefaults } = require('./helpers/request');\n\nmodule.exports = {\n  Issuer,\n  Registry,\n  Strategy,\n  TokenSet,\n  errors: {\n    OPError,\n    RPError,\n  },\n  custom: {\n    setHttpOptionsDefaults: setDefaults,\n    http_options: HTTP_OPTIONS,\n    clock_tolerance: CLOCK_TOLERANCE,\n  },\n  generators,\n};\n"],"names":[],"mappings":"AAAA,MAAM;AACN,MAAM,EAAE,OAAO,EAAE,OAAO,EAAE;AAC1B,MAAM;AACN,MAAM;AACN,MAAM;AACN,MAAM,EAAE,eAAe,EAAE,YAAY,EAAE;AACvC,MAAM;AACN,MAAM,EAAE,WAAW,EAAE;AAErB,OAAO,OAAO,GAAG;IACf;IACA;IACA;IACA;IACA,QAAQ;QACN;QACA;IACF;IACA,QAAQ;QACN,wBAAwB;QACxB,cAAc;QACd,iBAAiB;IACnB;IACA;AACF","ignoreList":[0],"debugId":null}}]
}